/**
 * @preserve
 * LIGHTSTREAMER - www.lightstreamer.com
 * Lightstreamer Web Client
 * Version 9.0.0+20230711
 * Copyright (c) Lightstreamer Srl. All Rights Reserved.
 * Contains: LightstreamerClient, Subscription, ConsoleLogLevel,
 * ConsoleLoggerProvider, MpnDevice, MpnSubscription, SafariMpnBuilder,
 * FirebaseMpnBuilder, Chart, DynaGrid, SimpleChartListener,
 * StaticGrid, StatusWidget, Logger, LoggerProvider,
 * ClientListener, ClientMessageListener, ItemUpdate, SubscriptionListener,
 * MpnDeviceListener, MpnSubscriptionListener, ChartListener, DynaGridListener,
 * StaticGridListener
 * UMD
 */
!function(t,e){var i,s=(i=function(t){"use strict";"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var e,i={exports:{}};
/* @preserve
	 * JSONPatch.js
	 *
	 * A Dharmafly project written by Thomas Parslow
	 * <tom@almostobsolete.net> and released with the kind permission of
	 * NetDev.
	 *
	 * Copyright 2011-2013 Thomas Parslow. All rights reserved.
	 * Permission is hereby granted,y free of charge, to any person obtaining a copy
	 * of this software and associated documentation files (the "Software"), to
	 * deal in the Software without restriction, including without limitation the
	 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
	 * sell copies of the Software, and to permit persons to whom the Software is
	 * furnished to do so, subject to the following conditions:
	 *
	 * The above copyright notice and this permission notice shall be included in
	 * all copies or substantial portions of the Software.
	 *
	 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
	 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
	 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
	 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
	 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
	 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
	 * IN THE SOFTWARE.
	 *
	 * Implements the JSON Patch IETF RFC 6902 as specified at:
	 *
	 *   http://tools.ietf.org/html/rfc6902
	 *
	 * Also implements the JSON Pointer IETF RFC 6901 as specified at:
	 *
	 *   http://tools.ietf.org/html/rfc6901
	 *
	 */
e=i,function(t,i){i(e.exports)}(0,(function(t){var e,i,s,n;function r(t){Error.call(this,t),this.message=t}function a(t){Error.call(this,t),this.message=t}function o(t){var e,i;if(n(t))return t.slice();if(null===t)return t;if("object"==typeof t){for(i in e={},t)Object.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}return t}function h(t,e){var i;if(t===e)return!0;if(typeof t!=typeof e)return!1;if("object"==typeof t){var s=n(t);if(s!==n(e))return!1;if(s){if(t.length!=e.length)return!1;for(var r=0;r<t.length;r++)if(!h(t[r],e[r]))return!1;return!0}for(i in t)if(Object.hasOwnProperty(t,i)&&(!Object.hasOwnProperty(e,i)||!h(t[i],e[i])))return!1;for(i in e)if(Object.hasOwnProperty(e,i)&&!Object.hasOwnProperty(t,i))return!1;return!0}return!1}function l(t){var e,i;if(!t.op)throw new r("Operation missing!");if(!s.hasOwnProperty(t.op))throw new r("Invalid operation!");if(!("path"in t))throw new r("Path missing!");for(i=s[t.op],e=0;e<i.length;e++)if(!(i[e]in t))throw new r(t.op+" must have key "+i[e])}function u(t,e){l(t);var s=t.op,n=new i(t.path),o=t.value,u=t.from?new i(t.from):null;switch(s){case"add":return function(t){return n.add(t,o,e)};case"remove":return function(t){return n.remove(t,e)};case"replace":return function(t){return n.replace(t,o,e)};case"move":if(n.subsetOf(u))throw new r("destination must not be a child of source");return function(t){var i=u.get(t),s=u.remove(t,e);return n.add(s,i,e)};case"copy":return function(t){var i=u.get(t);return n.add(t,i,e)};case"test":return function(t){if(!h(n.get(t),o))throw new a("Test operation failed. Value did not match.");return t}}}n=Array.isArray||function(t){return"[object Array]"==Object.prototype.toString.call(t)},t.apply_patch=function(t,i){return new e(i).apply(t)},t.InvalidPatch=r,r.prototype=new Error,t.PatchApplyError=a,a.prototype=new Error,t.JSONPointer=i=function(t){var e,i,s=[];if(""!==(i=t.split("/"))[0])throw new r("JSONPointer must start with a slash (or be an empty string)!");for(e=1;e<i.length;e++)s[e-1]=i[e].replace(/~1/g,"/").replace(/~0/g,"~");this.path=s,this.length=s.length},i.prototype._get_segment=function(t,e){var i=this.path[t];if(n(e))if("-"===i)i=e.length;else{if(!i.match(/^0$|^[1-9][0-9]*$/))throw new a("Expected a number to segment an array");i=parseInt(i,10)}return i},i.prototype._action=function(t,e,i){var s=this;function r(t,h){var l,u;if(i||(t=o(t)),l=s._get_segment(h,t),h==s.path.length-1)t=e(t,l);else{if(n(t)){if(t.length<=l)throw new a("Path not found in document")}else{if("object"!=typeof t)throw new a("Path not found in document");if(!Object.hasOwnProperty.call(t,l))throw new a("Path not found in document")}u=r(t[l],h+1),i||(t[l]=u)}return t}return r(t,0)},i.prototype.add=function(t,e,i){return 0===this.length?e:this._action(t,(function(t,i){if(n(t)){if(i>t.length)throw new a("Add operation must not attempt to create a sparse array!");t.splice(i,0,e)}else t[i]=e;return t}),i)},i.prototype.remove=function(t,e){if(0!==this.length)return this._action(t,(function(t,e){if(!Object.hasOwnProperty.call(t,e))throw new a("Remove operation must point to an existing value!");return n(t)?t.splice(e,1):delete t[e],t}),e)},i.prototype.replace=function(t,e,i){return 0===this.length?e:this._action(t,(function(t,i){if(!Object.hasOwnProperty.call(t,i))throw new a("Replace operation must point to an existing value!");return n(t)?t.splice(i,1,e):t[i]=e,t}),i)},i.prototype.get=function(t){var e;return 0===this.length?t:(this._action(t,(function(t,i){if(!Object.hasOwnProperty.call(t,i))throw new a("Path not found in document");return e=t[i],t}),!0),e)},i.prototype.subsetOf=function(t){if(this.length<=t.length)return!1;for(var e=0;e<t.length;e++)if(t.path[e]!==this.path[e])return!1;return!0},s={add:["value"],replace:["value"],test:["value"],remove:[],move:["from"],copy:["from"]},t.JSONPatch=e=function(t,e){this._compile(t,e)},e.prototype._compile=function(t,e){var i,s=this;if(this.compiledOps=[],"string"==typeof t&&(t=JSON.parse(t)),!n(t))throw new r("Patch must be an array of operations");for(i=0;i<t.length;i++){var a=u(t[i],e);s.compiledOps.push(a)}},t.JSONPatch.prototype.apply=function(t){var e;for(e=0;e<this.compiledOps.length;e++)t=this.compiledOps[e](t);return t}}));var s=function(){};s.prototype={fatal:function(t,e){},isFatalEnabled:function(){},error:function(t,e){},isErrorEnabled:function(){},warn:function(t,e){},isWarnEnabled:function(){},info:function(t,e){},isInfoEnabled:function(){},debug:function(t,e){},isDebugEnabled:function(){},trace:function(t,e){},isTraceEnabled:function(){}};var n=function(){};function r(){}function a(){}n.prototype={getLogger:function(t){}},r.prototype={onServerError:function(t,e){},onStatusChange:function(t){},onPropertyChange:function(t){},onListenStart:function(){},onListenEnd:function(){},onServerKeepalive:function(){}},a.prototype={onAbort:function(t,e){},onError:function(t){},onDiscarded:function(t){},onDeny:function(t,e,i){},onProcessed:function(t,e){}};var o=function(){};o.prototype={getItemName:function(){},getItemPos:function(){},getValue:function(t){},getValueAsJSONPatchIfAvailable:function(t){return null},isValueChanged:function(t){},isSnapshot:function(){},forEachChangedField:function(t){},forEachField:function(t){}};var h=function(){};h.prototype={onItemUpdate:function(t){},onItemLostUpdates:function(t,e,i){},onCommandSecondLevelItemLostUpdates:function(t,e){},onEndOfSnapshot:function(t,e){},onClearSnapshot:function(t,e){},onSubscription:function(){},onUnsubscription:function(){},onSubscriptionError:function(t,e){},onCommandSecondLevelSubscriptionError:function(t,e,i){},onListenStart:function(){},onListenEnd:function(){},onRealMaxFrequency:function(t){}};var l=function(){};l.prototype={onListenStart:function(){},onListenEnd:function(){},onRegistered:function(){},onSuspended:function(){},onResumed:function(){},onStatusChanged:function(t,e){},onRegistrationFailed:function(t,e){},onSubscriptionsUpdated:function(){}};var u=function(){};u.prototype={onListenStart:function(){},onListenEnd:function(){},onSubscription:function(){},onUnsubscription:function(){},onSubscriptionError:function(t,e){},onUnsubscriptionError:function(t,e){},onTriggered:function(){},onStatusChanged:function(t,e){},onPropertyChanged:function(t){},onModificationError:function(t,e,i){}};var c={};!function(t){var e,r=function(){return ns.__string_rec(this,"")},a=a||{};function l(t,e){var i=Object.create(t);for(var s in e)i[s]=e[s];return e.toString!==Object.prototype.toString&&(i.toString=e.toString),i}var u=function(t,e){this.r=new RegExp(t,e.split("u").join(""))};u.__name__="EReg",u.prototype={match:function(t){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(t),this.r.s=t,null!=this.r.m},__class__:u};var d=function(){};d.__name__="HxOverrides",d.dateStr=function(t){var e=t.getMonth()+1,i=t.getDate(),s=t.getHours(),n=t.getMinutes(),r=t.getSeconds();return t.getFullYear()+"-"+(e<10?"0"+e:""+e)+"-"+(i<10?"0"+i:""+i)+" "+(s<10?"0"+s:""+s)+":"+(n<10?"0"+n:""+n)+":"+(r<10?"0"+r:""+r)},d.cca=function(t,e){var i=t.charCodeAt(e);if(i==i)return i},d.substr=function(t,e,i){if(null==i)i=t.length;else if(i<0){if(0!=e)return"";i=t.length+i}return t.substr(e,i)},d.remove=function(t,e){var i=t.indexOf(e);return-1!=i&&(t.splice(i,1),!0)},d.now=function(){return Date.now()};var _=function(t,e){this.min=t,this.max=e};_.__name__="IntIterator",_.prototype={hasNext:function(){return this.min<this.max},next:function(){return this.min++},__class__:_};var p=function(){};p.__name__="Lambda",p.has=function(t,e){for(var i=as(t);i.hasNext();)if(i.next()==e)return!0;return!1},p.exists=function(t,e){for(var i=as(t);i.hasNext();)if(e(i.next()))return!0;return!1},p.count=function(t,e){var i=0;if(null==e)for(var s=as(t);s.hasNext();)s.next(),++i;else for(var n=as(t);n.hasNext();)e(n.next())&&++i;return i},p.empty=function(t){return!as(t).hasNext()},p.find=function(t,e){for(var i=as(t);i.hasNext();){var s=i.next();if(e(s))return s}return null},Math.__name__="Math";var f=function(){};f.__name__="Reflect",f.field=function(t,e){try{return t[e]}catch(t){return Ci.lastError=t,null}},f.fields=function(t){var e=[];if(null!=t){var i=Object.prototype.hasOwnProperty;for(var s in t)"__id__"!=s&&"hx__closures__"!=s&&i.call(t,s)&&e.push(s)}return e},f.deleteField=function(t,e){return!!Object.prototype.hasOwnProperty.call(t,e)&&(delete t[e],!0)},f.copy=function(t){if(null==t)return null;for(var e={},i=0,s=f.fields(t);i<s.length;){var n=s[i];++i,e[n]=f.field(t,n)}return e};var m=function(){};m.__name__="Std",m.string=function(t){return ns.__string_rec(t,"")},m.parseInt=function(t){var e=parseInt(t);return isNaN(e)?null:e},m.random=function(t){return t<=0?0:Math.floor(Math.random()*t)};var g=function(){this.b=""};g.__name__="StringBuf",g.prototype={__class__:g};var v=function(){};v.__name__="StringTools",v.startsWith=function(t,e){return t.length>=e.length&&0==t.lastIndexOf(e,0)},v.endsWith=function(t,e){var i=e.length,s=t.length;return s>=i&&t.indexOf(e,s-i)==s-i},v.isSpace=function(t,e){var i=d.cca(t,e);return i>8&&i<14||32==i},v.ltrim=function(t){for(var e=t.length,i=0;i<e&&v.isSpace(t,i);)++i;return i>0?d.substr(t,i,e-i):t},v.rtrim=function(t){for(var e=t.length,i=0;i<e&&v.isSpace(t,e-i-1);)++i;return i>0?d.substr(t,0,e-i):t},v.trim=function(t){return v.ltrim(v.rtrim(t))},v.replace=function(t,e,i){return t.split(e).join(i)};var S=function(){};S.__name__="Type",S.enumEq=function(t,e){if(t==e)return!0;try{var i=t.__enum__;if(null==i||i!=e.__enum__)return!1;if(t._hx_index!=e._hx_index)return!1;for(var s=a[i].__constructs__[t._hx_index].__params__,n=0;n<s.length;){var r=s[n];if(++n,!S.enumEq(t[r],e[r]))return!1}}catch(n){return Ci.lastError=n,!1}return!0};var b=c.LSConnectionDetails=function(t){this.serverAddress=fs,this.client=t,this.lock=t.lock};b.__name__="LSConnectionDetails",b.prototype={getServerAddress:function(){return this.serverAddress},setServerAddress:function(t){var e=E.fromString(t);Ps.isInfoEnabled()&&Ps.info("serverAddress changed: "+e);var i=this.serverAddress;this.serverAddress=e,this.client.eventDispatcher.onPropertyChange("serverAddress"),i!=e&&this.client.machine.evtServerAddressChanged()},getAdapterSet:function(){return this.adapterSet},setAdapterSet:function(t){Ps.isInfoEnabled()&&Ps.info("adapterSet changed: "+t),this.adapterSet=t,this.client.eventDispatcher.onPropertyChange("adapterSet")},getUser:function(){return this.user},setUser:function(t){Ps.isInfoEnabled()&&Ps.info("user changed: "+t),this.user=t,this.client.eventDispatcher.onPropertyChange("user")},setPassword:function(t){Ps.isInfoEnabled()&&Ps.info("password changed"),this.password=t,this.client.eventDispatcher.onPropertyChange("password")},getSessionId:function(){return this.sessionId},setSessionId:function(t){this.sessionId=t,this.client.eventDispatcher.onPropertyChange("sessionId")},getServerInstanceAddress:function(){return this.serverInstanceAddress},setServerInstanceAddress:function(t){this.serverInstanceAddress=t,this.client.eventDispatcher.onPropertyChange("serverInstanceAddress")},getServerSocketName:function(){return this.serverSocketName},setServerSocketName:function(t){this.serverSocketName=t,this.client.eventDispatcher.onPropertyChange("serverSocketName")},getClientIp:function(){return this.clientIp},setClientIp:function(t){this.clientIp=t,this.client.eventDispatcher.onPropertyChange("clientIp")},toString:function(){var t=ge._new();return ge.set(t,"serverAddress",this.serverAddress),ge.set(t,"adapterSet",this.adapterSet),ge.set(t,"user",this.user),ge.set(t,"sessionId",this.sessionId),ge.set(t,"serverInstanceAddress",this.serverInstanceAddress),ge.set(t,"serverSocketName",this.serverSocketName),ge.set(t,"clientIp",this.clientIp),ge.set(t,"libVersion",C.LIB_NAME+" "+C.LIB_VERSION),ki.stringify(t.h)},__class__:b};var y=function(){};y.__name__="js.Browser",y.get_supported=function(){return"undefined"!=typeof window&&void 0!==window.location&&"string"==typeof window.location.protocol},y.getLocalStorage=function(){try{var t=window.localStorage;if(t.getItem(""),0==t.length){var e="_hx_"+Math.random();t.setItem(e,e),t.removeItem(e)}return t}catch(t){return Ci.lastError=t,null}};var E={_new:function(t){return t},fromString:function(t){if(null==t)return null;if(v.startsWith(t,"http://")||v.startsWith(t,"https://"))return t;throw new T("address is malformed")}},w=function(t,e,i){Error.call(this,t),this.message=t,this.__previousException=e,this.__nativeException=null!=i?i:this,this.__skipStack=0;var s=Error.prepareStackTrace;if(Error.prepareStackTrace=function(t){return t.stack},i instanceof Error)this.stack=i.stack;else{var n=null;if(Error.captureStackTrace)Error.captureStackTrace(this,w),n=this;else if(void 0===(n=new Error).stack){try{throw n}catch(t){}this.__skipStack++}this.stack=n.stack}Error.prepareStackTrace=s};w.__name__="haxe.Exception",w.caught=function(t){return t instanceof w?t:t instanceof Error?new w(t.message,null,t):new Mi(t,null,t)},w.thrown=function(t){if(t instanceof w)return t.get_native();if(t instanceof Error)return t;var e=new Mi(t);return e.__skipStack++,e},w.__super__=Error,w.prototype=l(Error.prototype,{toString:function(){return this.get_message()},details:function(){if(null==this.get_previous()){var t="Exception: "+this.toString(),e=this.get_stack();return t+(null==e?"null":xi.toString(e))}for(var i="",s=this,n=null;null!=s;){if(null==n)i="Exception: "+s.get_message()+(null==(t=s.get_stack())?"null":xi.toString(t))+i;else{var r=xi.subtract(s.get_stack(),n.get_stack());i="Exception: "+s.get_message()+(null==r?"null":xi.toString(r))+"\n\nNext "+i}n=s,s=s.get_previous()}return i},__shiftStack:function(){this.__skipStack++},get_message:function(){return this.message},get_previous:function(){return this.__previousException},get_native:function(){return this.__nativeException},get_stack:function(){var t=this.__exceptionStack;if(null==t){var e=Ci.toHaxe(Ci.normalize(this.stack),this.__skipStack);return this.setProperty("__exceptionStack",e),e}return t},setProperty:function(t,e){try{Object.defineProperty(this,t,{value:e})}catch(i){this[t]=e}},__class__:w});var T=function(t,e,i){w.call(this,t,e,i),this.__skipStack++};T.__name__="com.lightstreamer.internal.IllegalArgumentException",T.__super__=w,T.prototype=l(w.prototype,{__class__:T});var R=c.LSConnectionOptions=function(t){this.cookieHandlingRequired=!1,this.slowingEnabled=!1,this.serverInstanceAddressIgnored=!1,this.httpExtraHeadersOnSessionCreationOnly=!1,this.stalledTimeout=2e3,this.sessionRecoveryTimeout=15e3,this.reverseHeartbeatInterval=0,this.retryDelay=4e3,this.reconnectTimeout=3e3,this.pollingInterval=0,this.realMaxBandwidth=null,this.requestedMaxBandwidth=ze.BWUnlimited,this.keepaliveInterval=0,this.idleTimeout=19e3,this.httpExtraHeaders=null,this.forcedTransport=null,this.firstRetryMaxDelay=100,this.contentLength=5e7,this.client=t,this.lock=t.lock};R.__name__="LSConnectionOptions",R.prototype={getContentLength:function(){return this.contentLength},setContentLength:function(t){var e=Ge.fromIntGt0(t);Ps.isInfoEnabled()&&Ps.info("contentLength changed: "+e),this.contentLength=e,this.client.eventDispatcher.onPropertyChange("contentLength")},getFirstRetryMaxDelay:function(){return this.firstRetryMaxDelay},setFirstRetryMaxDelay:function(t){var e=Ye.fromIntGt0(t);Ps.isInfoEnabled()&&Ps.info("firstRetryMaxDelay changed: "+e),this.firstRetryMaxDelay=e,this.client.eventDispatcher.onPropertyChange("firstRetryMaxDelay")},getForcedTransport:function(){return this.forcedTransport},setForcedTransport:function(t){var e=Ke.fromString(t);Ps.isInfoEnabled()&&Ps.info("forcedTransport changed: "+e),this.forcedTransport=e,this.client.eventDispatcher.onPropertyChange("forcedTransport"),this.client.machine.evtExtSetForcedTransport()},getHttpExtraHeaders:function(){return null==this.httpExtraHeaders?null:ye.fromMapToDynamicAccess(this.httpExtraHeaders)},setHttpExtraHeaders:function(t){Ps.isInfoEnabled()&&Ps.info("httpExtraHeaders changed: "+m.string(t)),this.httpExtraHeaders=null==t?null:ye.toHaxe(t),this.client.eventDispatcher.onPropertyChange("httpExtraHeaders")},getIdleTimeout:function(){return this.idleTimeout},setIdleTimeout:function(t){var e=Ye.fromIntGtEq0(t);Ps.isInfoEnabled()&&Ps.info("idleTimeout changed: "+e),this.idleTimeout=e,this.client.eventDispatcher.onPropertyChange("idleTimeout")},getKeepaliveInterval:function(){return this.keepaliveInterval},setKeepaliveInterval:function(t){var e=Ye.fromIntGtEq0(t);Ps.isInfoEnabled()&&Ps.info("keepaliveInterval changed: "+e),this.keepaliveInterval=e,this.client.eventDispatcher.onPropertyChange("keepaliveInterval")},getRequestedMaxBandwidth:function(){return je.toString(this.requestedMaxBandwidth)},setRequestedMaxBandwidth:function(t){null!=t&&(t=null==t?"null":""+t);var e=je.fromString(t);Ps.isInfoEnabled()&&Ps.info("requestedMaxBandwidth changed: "+je.toString(e)),this.requestedMaxBandwidth=e,this.client.eventDispatcher.onPropertyChange("requestedMaxBandwidth"),this.client.machine.evtExtSetRequestedMaxBandwidth()},getRealMaxBandwidth:function(){return si.toString(this.realMaxBandwidth)},setRealMaxBandwidth:function(t){this.realMaxBandwidth=t,this.client.eventDispatcher.onPropertyChange("realMaxBandwidth")},getPollingInterval:function(){return this.pollingInterval},setPollingInterval:function(t){var e=Ye.fromIntGtEq0(t);Ps.isInfoEnabled()&&Ps.info("pollingInterval changed: "+e),this.pollingInterval=e,this.client.eventDispatcher.onPropertyChange("pollingInterval")},getReconnectTimeout:function(){return this.reconnectTimeout},setReconnectTimeout:function(t){var e=Ye.fromIntGt0(t);Ps.isInfoEnabled()&&Ps.info("reconnectTimeout changed: "+e),this.reconnectTimeout=e,this.client.eventDispatcher.onPropertyChange("reconnectTimeout")},getRetryDelay:function(){return this.retryDelay},setRetryDelay:function(t){var e=Ye.fromIntGt0(t);Ps.isInfoEnabled()&&Ps.info("retryDelay changed: "+e),this.retryDelay=e,this.client.eventDispatcher.onPropertyChange("retryDelay")},getReverseHeartbeatInterval:function(){return this.reverseHeartbeatInterval},setReverseHeartbeatInterval:function(t){var e=Ye.fromIntGtEq0(t);Ps.isInfoEnabled()&&Ps.info("reverseHeartbeatInterval changed: "+e),this.reverseHeartbeatInterval=e,this.client.eventDispatcher.onPropertyChange("reverseHeartbeatInterval"),this.client.machine.evtExtSetReverseHeartbeatInterval()},getSessionRecoveryTimeout:function(){return this.sessionRecoveryTimeout},setSessionRecoveryTimeout:function(t){var e=Ye.fromIntGtEq0(t);Ps.isInfoEnabled()&&Ps.info("sessionRecoveryTimeout changed: "+e),this.sessionRecoveryTimeout=e,this.client.eventDispatcher.onPropertyChange("sessionRecoveryTimeout")},getStalledTimeout:function(){return this.stalledTimeout},setStalledTimeout:function(t){var e=Ye.fromIntGt0(t);Ps.isInfoEnabled()&&Ps.info("stalledTimeout changed: "+e),this.stalledTimeout=e,this.client.eventDispatcher.onPropertyChange("stalledTimeout")},isHttpExtraHeadersOnSessionCreationOnly:function(){return this.httpExtraHeadersOnSessionCreationOnly},setHttpExtraHeadersOnSessionCreationOnly:function(t){Ps.isInfoEnabled()&&Ps.info("httpExtraHeadersOnSessionCreationOnly changed: "+(null==t?"null":""+t)),this.httpExtraHeadersOnSessionCreationOnly=t,this.client.eventDispatcher.onPropertyChange("httpExtraHeadersOnSessionCreationOnly")},isServerInstanceAddressIgnored:function(){return this.serverInstanceAddressIgnored},setServerInstanceAddressIgnored:function(t){Ps.isInfoEnabled()&&Ps.info("serverInstanceAddressIgnored changed: "+(null==t?"null":""+t)),this.serverInstanceAddressIgnored=t,this.client.eventDispatcher.onPropertyChange("serverInstanceAddressIgnored")},setCookieHandlingRequired:function(t){Ps.isInfoEnabled()&&Ps.info("cookieHandlingRequired changed: "+(null==t?"null":""+t)),this.cookieHandlingRequired=t,this.client.eventDispatcher.onPropertyChange("cookieHandlingRequired")},isCookieHandlingRequired:function(){return this.cookieHandlingRequired},isSlowingEnabled:function(){return this.slowingEnabled},setSlowingEnabled:function(t){Ps.isInfoEnabled()&&Ps.info("slowingEnabled changed: "+(null==t?"null":""+t)),this.slowingEnabled=t,this.client.eventDispatcher.onPropertyChange("slowingEnabled")},toString:function(){var t=ge._new();return ge.set(t,"forcedTransport",this.forcedTransport),ge.set(t,"requestedMaxBandwidth",this.requestedMaxBandwidth),ge.set(t,"realMaxBandwidth",this.realMaxBandwidth),ge.set(t,"retryDelay",this.retryDelay),ge.set(t,"firstRetryMaxDelay",this.firstRetryMaxDelay),ge.set(t,"sessionRecoveryTimeout",this.sessionRecoveryTimeout),ge.set(t,"reverseHeartbeatInterval",this.reverseHeartbeatInterval),ge.set(t,"stalledTimeout",this.stalledTimeout),ge.set(t,"reconnectTimeout",this.reconnectTimeout),ge.set(t,"keepaliveInterval",this.keepaliveInterval),ge.set(t,"pollingInterval",this.pollingInterval),ge.set(t,"idleTimeout",this.idleTimeout),ge.set(t,"contentLength",this.contentLength),ge.set(t,"slowingEnabled",this.slowingEnabled),ge.set(t,"serverInstanceAddressIgnored",this.serverInstanceAddressIgnored),ge.set(t,"HTTPExtraHeadersOnSessionCreationOnly",this.httpExtraHeadersOnSessionCreationOnly),ge.set(t,"HTTPExtraHeaders",this.httpExtraHeaders),ge.set(t,"cookieHandlingRequired",this.cookieHandlingRequired),ki.stringify(t.h)},__class__:R};var x=function(){this.listeners=[]};x.__name__="com.lightstreamer.internal.EventDispatcher",x.prototype={addListener:function(t){return-1==this.listeners.indexOf(t)&&(this.listeners.push(t),!0)},removeListener:function(t){return d.remove(this.listeners,t)},getListeners:function(){return this.listeners},dispatchToAll:function(t){for(var e=0,i=this.listeners;e<i.length;)this.dispatchToOne(i[e++],t)},dispatchToOne:function(t,e){Cs.submit(es.a((function(){try{e(t)}catch(t){var i=w.caught(t);Ps.isErrorEnabled()&&Ps.error("Uncaught exception\n"+i.details())}})))},__class__:x};var I=function(){x.call(this)};I.__name__="com.lightstreamer.client.ClientEventDispatcher",I.__super__=x,I.prototype=l(x.prototype,{removeListenerAndFireOnListenEnd:function(t,e){this.removeListener(t)&&this.dispatchToOne(t,(function(t){null!=t.onListenEnd&&t.onListenEnd(e)}))},addListenerAndFireOnListenStart:function(t,e){this.addListener(t)&&this.dispatchToOne(t,(function(t){null!=t.onListenStart&&t.onListenStart(e)}))},onServerError:function(t,e){this.dispatchToAll((function(i){null!=i.onServerError&&i.onServerError(t,e)}))},onStatusChange:function(t){this.dispatchToAll((function(e){null!=e.onStatusChange&&e.onStatusChange(t)}))},onPropertyChange:function(t){this.dispatchToAll((function(e){null!=e.onPropertyChange&&e.onPropertyChange(t)}))},onServerKeepalive:function(){this.dispatchToAll((function(t){null!=t.onServerKeepalive&&t.onServerKeepalive()}))},__class__:I});var C=c.LSLightstreamerClient=function(t,e){this.lock=new Ei,this.eventDispatcher=new I,this.connectionDetails=new b(this),this.connectionOptions=new R(this),this.machine=new nt(this,os(this,this.createWsClient),os(this,this.createHttpClient),os(this,this.createHttpClient),os(this,this.createTimer),os(this,this.randomMillis),os(this,this.createReachabilityManager)),null!=t&&this.connectionDetails.setServerAddress(t),null!=e&&this.connectionDetails.setAdapterSet(e)};C.__name__="LSLightstreamerClient",C.setLoggerProvider=function(t){wi.setLoggerProvider(t)},C.prototype={addListener:function(t){this.eventDispatcher.addListenerAndFireOnListenStart(t,this)},removeListener:function(t){this.eventDispatcher.removeListenerAndFireOnListenEnd(t,this)},getListeners:function(){return this.eventDispatcher.getListeners().slice()},connect:function(){this.machine.connect()},disconnect:function(){this.machine.disconnect()},getStatus:function(){return this.machine.getStatus()},sendMessage:function(t,e,i,s,n){null==n&&(n=!1),null==i&&(i=-1),this.machine.sendMessage(t,e,null!=i?i:-1,s,null!=n&&n)},subscribe:function(t){this.machine.subscribeExt(t)},unsubscribe:function(t){this.machine.unsubscribe(t)},getSubscriptions:function(){return this.machine.getSubscriptions().slice()},getSubscriptionWrappers:function(){for(var t=[],e=0,i=this.machine.getSubscriptions();e<i.length;){var s=i[e];++e,null!=s.wrapper&&t.push(s.wrapper)}return t.slice()},registerForMpn:function(t){ns.__cast(this.machine,nt).registerForMpn(t)},subscribeMpn:function(t,e){ns.__cast(this.machine,nt).subscribeMpn(t,e)},unsubscribeMpn:function(t){ns.__cast(this.machine,nt).unsubscribeMpn(t)},unsubscribeMpnSubscriptions:function(t){ns.__cast(this.machine,nt).unsubscribeMpnSubscriptions(t)},getMpnSubscriptions:function(t){return ns.__cast(this.machine,nt).getMpnSubscriptions(t).slice()},getMpnSubscriptionWrappers:function(t){for(var e=[],i=0,s=ns.__cast(this.machine,nt).getMpnSubscriptions(t);i<s.length;){var n=s[i];++i,null!=n.wrapper&&e.push(n.wrapper)}return e.slice()},findMpnSubscription:function(t){return ns.__cast(this.machine,nt).findMpnSubscription(t)},findMpnSubscriptionWrapper:function(t){var e=this.findMpnSubscription(t);return null!=e?e.wrapper:null},createWsClient:function(t,e,i,s,n){return new ci(t,i,s,n)},createHttpClient:function(t,e,i,s,n,r){return new me(t,e,i,this.connectionOptions.isCookieHandlingRequired(),s,n,r)},createReachabilityManager:function(t){return new Ce},createTimer:function(t,e,i){return new He(t,e,i)},randomMillis:function(t){return m.random(t)},__class__:C};var L=a["com.lightstreamer.client._Subscription.SubscriptionState"]={__ename__:!0,__constructs__:null,Inactive:{_hx_name:"Inactive",_hx_index:0,__enum__:"com.lightstreamer.client._Subscription.SubscriptionState",toString:r},Active:{_hx_name:"Active",_hx_index:1,__enum__:"com.lightstreamer.client._Subscription.SubscriptionState",toString:r},Subscribed:{_hx_name:"Subscribed",_hx_index:2,__enum__:"com.lightstreamer.client._Subscription.SubscriptionState",toString:r}};L.__constructs__=[L.Inactive,L.Active,L.Subscribed];var M=function(){x.call(this)};M.__name__="com.lightstreamer.client._Subscription.SubscriptionEventDispatcher",M.__super__=x,M.prototype=l(x.prototype,{onClearSnapshot:function(t,e){this.dispatchToAll((function(i){null!=i.onClearSnapshot&&i.onClearSnapshot(t,e)}))},onCommandSecondLevelItemLostUpdates:function(t,e){this.dispatchToAll((function(i){null!=i.onCommandSecondLevelItemLostUpdates&&i.onCommandSecondLevelItemLostUpdates(t,e)}))},onCommandSecondLevelSubscriptionError:function(t,e,i){this.dispatchToAll((function(s){null!=s.onCommandSecondLevelSubscriptionError&&s.onCommandSecondLevelSubscriptionError(t,e,i)}))},onEndOfSnapshot:function(t,e){this.dispatchToAll((function(i){null!=i.onEndOfSnapshot&&i.onEndOfSnapshot(t,e)}))},onItemLostUpdates:function(t,e,i){this.dispatchToAll((function(s){null!=s.onItemLostUpdates&&s.onItemLostUpdates(t,e,i)}))},onItemUpdate:function(t){this.dispatchToAll((function(e){null!=e.onItemUpdate&&e.onItemUpdate(t)}))},removeListenerAndFireOnListenEnd:function(t,e){this.removeListener(t)&&this.dispatchToOne(t,(function(t){null!=t.onListenEnd&&t.onListenEnd(e)}))},addListenerAndFireOnListenStart:function(t,e){this.addListener(t)&&this.dispatchToOne(t,(function(t){null!=t.onListenStart&&t.onListenStart(e)}))},onSubscription:function(){this.dispatchToAll((function(t){null!=t.onSubscription&&t.onSubscription()}))},onSubscriptionError:function(t,e){this.dispatchToAll((function(i){null!=i.onSubscriptionError&&i.onSubscriptionError(t,e)}))},onUnsubscription:function(){this.dispatchToAll((function(t){null!=t.onUnsubscription&&t.onUnsubscription()}))},onRealMaxFrequency:function(t){this.dispatchToAll((function(e){null!=e.onRealMaxFrequency&&e.onRealMaxFrequency(t)}))},__class__:M});var N=c.LSSubscription=function(t,e,i,s){this.lock=new Ei,this.m_internal=!1,this.state=L.Inactive,this.eventDispatcher=new M,this.wrapper=s,this.mode=ni.fromString(t),this.initSnapshot(),this.initItemsAndFields("string"==typeof e?[e].slice():e,i)};N.__name__="LSSubscription",N.prototype={initSnapshot:function(){this.snapshot="RAW"==this.mode?null:Ze.SnpYes},initItemsAndFields:function(t,e){if(null!=t){if(null==e)throw new T("Please specify a valid field list");if(this.items=ri.fromArray(t.slice()),this.fields=ai.fromArray(e.slice()),"COMMAND"==this.mode&&-1==this.fields.indexOf("key"))throw new T("Field 'key' is missing");if("COMMAND"==this.mode&&-1==this.fields.indexOf("command"))throw new T("Field 'command' is missing")}else if(null!=e)throw new T("Please specify a valid item or item list")},addListener:function(t){this.eventDispatcher.addListenerAndFireOnListenStart(t,this)},removeListener:function(t){this.eventDispatcher.removeListenerAndFireOnListenEnd(t,this)},getListeners:function(){return this.eventDispatcher.getListeners().slice()},isActive:function(){return this.state!=L.Inactive},isSubscribed:function(){return this.state==L.Subscribed},getDataAdapter:function(){return this.dataAdapter},setDataAdapter:function(t){this.checkActive(),this.dataAdapter=oi.fromString(t)},getMode:function(){return this.mode},getItems:function(){return null==this.items?null:this.items.slice()},setItems:function(t){this.checkActive(),this.items=ri.fromArray(null==t?null:t.slice()),this.group=null},getItemGroup:function(){return this.group},setItemGroup:function(t){this.checkActive(),this.group=oi.fromString(t),this.items=null},getFields:function(){return null==this.fields?null:this.fields.slice()},setFields:function(t){this.checkActive();var e=ai.fromArray(null==t?null:t.slice());if("COMMAND"==this.mode&&null!=e){if(-1==e.indexOf("command"))throw new T("Field 'command' is missing");if(-1==e.indexOf("key"))throw new T("Field 'key' is missing")}this.fields=e,this.schema=null},getFieldSchema:function(){return this.schema},setFieldSchema:function(t){this.checkActive(),this.schema=oi.fromString(t),this.fields=null},getRequestedBufferSize:function(){return Xe.toString(this.bufferSize)},setRequestedBufferSize:function(t){null!=t&&(t=null==t?"null":""+t),this.checkActive(),this.bufferSize=Xe.fromString(t)},getRequestedSnapshot:function(){return Je.toString(this.snapshot)},setRequestedSnapshot:function(t){null!=t&&(t=null==t?"null":""+t),this.checkActive();var e=Je.fromString(t);switch(this.mode){case"COMMAND":case"MERGE":if(null!=e&&null!=e&&2==e._hx_index)throw new T("Snapshot length is not permitted if MERGE or COMMAND was specified as mode");break;case"RAW":if(null!=e)throw new T("Snapshot is not permitted if RAW was specified as mode")}this.snapshot=e},getRequestedMaxFrequency:function(){return ti.toString(this.requestedMaxFrequency)},setRequestedMaxFrequency:function(t){var e,i=this;null!=t&&(t=null==t?"null":""+t),Ie.synchronized(this.lock,(function(){var s=ti.fromString(t);switch(i.mode){case"COMMAND":case"DISTINCT":case"MERGE":break;default:throw new T("The operation in only available on MERGE, DISTINCT and COMMAND Subscripitons")}if(i.isActive()&&(null==s||s==$e.FreqUnfiltered||i.requestedMaxFrequency==$e.FreqUnfiltered))throw new T("Cannot change the frequency from/to 'unfiltered' or to null while the Subscription is active");return null!=i.subId&&Fs.isInfoEnabled()&&Fs.info("Subscription "+i.subId+" requested max frequency changed: "+t),i.requestedMaxFrequency=s,e=i.manager})),null!=e&&e.evtExtConfigure()},getSelector:function(){return this.selector},setSelector:function(t){this.checkActive(),this.selector=oi.fromString(t)},getCommandPosition:function(){if(this.checkCommand(),null==this.cmdIdx)throw new be("The position of the command field is currently unknown");return this.cmdIdx},getKeyPosition:function(){if(this.checkCommand(),null==this.keyIdx)throw new be("The position of the key field is currently unknown");return this.keyIdx},getCommandSecondLevelDataAdapter:function(){return this.dataAdapter2},setCommandSecondLevelDataAdapter:function(t){this.checkActive(),this.checkCommand(),this.dataAdapter2=oi.fromString(t)},getCommandSecondLevelFields:function(){return null==this.fields2?null:this.fields2.slice()},setCommandSecondLevelFields:function(t){this.checkActive(),this.checkCommand(),this.fields2=ai.fromArray(null==t?null:t.slice()),this.schema2=null},getCommandSecondLevelFieldSchema:function(){return this.schema2},setCommandSecondLevelFieldSchema:function(t){this.checkActive(),this.checkCommand(),this.schema2=oi.fromString(t),this.fields2=null},getValue:function(t,e){var i="number"==typeof t&&(0|t)===t,s="string"==typeof t,n="number"==typeof e&&(0|e)===e,r="string"==typeof e;if(i&&n)return this.getValuePosPos(t,e);if(i&&r)return this.getValuePosName(t,e);if(s&&n)return this.getValueNamePos(t,e);if(s&&r)return this.getValueNameName(t,e);throw new T("Invalid argument type")},getCommandValue:function(t,e,i){var s="number"==typeof t&&(0|t)===t,n="string"==typeof t,r="number"==typeof i&&(0|i)===i,a="string"==typeof i;if(s&&r)return this.getCommandValuePosPos(t,e,i);if(s&&a)return this.getCommandValuePosName(t,e,i);if(n&&r)return this.getCommandValueNamePos(t,e,i);if(n&&a)return this.getCommandValueNameName(t,e,i);throw new T("Invalid argument type")},getValuePosPos:function(t,e){var i,s=this;if(t<1||e<1)throw new T("The specified position is out of bounds");return Ie.synchronized(this.lock,(function(){return i=s.manager})),null!=i?i.getValue(t,e):null},getValuePosName:function(t,e){var i=this;return this.getValuePosPos(t,Ie.synchronized(this.lock,(function(){return i.getFieldPos(e)})))},getValueNamePos:function(t,e){var i=this;return this.getValuePosPos(Ie.synchronized(this.lock,(function(){return i.getItemPos(t)})),e)},getValueNameName:function(t,e){var i=this;return this.getValuePosPos(Ie.synchronized(this.lock,(function(){return i.getItemPos(t)})),Ie.synchronized(this.lock,(function(){return i.getFieldPos(e)})))},getCommandValuePosPos:function(t,e,i){var s,n=this;if(this.checkCommand(),t<1||i<1)throw new T("The specified position is out of bounds");return Ie.synchronized(this.lock,(function(){return s=n.manager})),null!=s?s.getCommandValue(t,e,i):null},getCommandValuePosName:function(t,e,i){var s=this;return this.getCommandValuePosPos(t,e,Ie.synchronized(this.lock,(function(){return s.getFieldPos(i)})))},getCommandValueNamePos:function(t,e,i){var s=this;return this.getCommandValuePosPos(Ie.synchronized(this.lock,(function(){return s.getItemPos(t)})),e,i)},getCommandValueNameName:function(t,e,i){var s=this;return this.getCommandValuePosPos(Ie.synchronized(this.lock,(function(){return s.getItemPos(t)})),e,Ie.synchronized(this.lock,(function(){return s.getFieldPos(i)})))},getItemPos:function(t){var e;if(null==this.items||-1==(e=ri.getPos(this.items,t)))throw new T("Unknown item name");return e},getFieldPos:function(t){var e;if(null==this.fields||-1==(e=ai.getPos(this.fields,t)))throw new T("Unknown field name");return e},checkActive:function(){if(this.isActive())throw new be("Cannot modify an active Subscription. Please unsubscribe before applying any change")},checkCommand:function(){if("COMMAND"!=this.mode)throw new be("This method can only be used on COMMAND subscriptions")},fetch_items:function(){return this.items},fetch_fields:function(){return this.fields},fetch_fields2:function(){return this.fields2},fetch_mode:function(){return this.mode},fetch_requestedBufferSize:function(){return this.bufferSize},fetch_requestedSnapshot:function(){return this.snapshot},fetch_requestedMaxFrequency:function(){return this.requestedMaxFrequency},fetch_nItems:function(){return this.nItems},fetch_subManager:function(){return this.manager},setActive:function(){this.state=L.Active},setInactive:function(){this.state=L.Inactive,this.subId=null,this.cmdIdx=null,this.keyIdx=null,this.nItems=null,this.nFields=null},setSubscribed:function(t,e,i){this.state=L.Subscribed,this.subId=t,this.nItems=e,this.nFields=i},setSubscribedCMD:function(t,e,i,s,n){this.state=L.Subscribed,this.subId=t,this.cmdIdx=s,this.keyIdx=n,this.nItems=e,this.nFields=i},fetch_nFields:function(){return this.nFields},isInternal:function(){return this.m_internal},setInternal:function(){this.m_internal=!0},getItemName:function(t){return null!=this.items?this.items[t-1]:null},relate:function(t){this.manager=t},unrelate:function(t){this.manager==t&&(this.manager=null)},hasSnapshot:function(){return!(null==this.snapshot||this.snapshot==Ze.SnpNo)},getItemNameOrPos:function(t){return null!=this.items?this.items[t-1]:""+t},fireOnSubscription:function(t){Fs.isInfoEnabled()&&Fs.info("Subscription "+t+" added"),this.eventDispatcher.onSubscription()},fireOnUnsubscription:function(t){Fs.isInfoEnabled()&&Fs.info("Subscription "+t+" deleted"),this.eventDispatcher.onUnsubscription()},fireOnSubscriptionError:function(t,e,i){Fs.isWarnEnabled()&&Fs.warn("Subscription "+t+" failed: "+e+" - "+i),this.eventDispatcher.onSubscriptionError(e,i)},fireOnEndOfSnapshot:function(t,e){Fs.isDebugEnabled()&&Fs.debug("Subscription "+e+":"+this.getItemNameOrPos(t)+": snapshot ended"),this.eventDispatcher.onEndOfSnapshot(this.getItemName(t),t)},fireOnClearSnapshot:function(t,e){Fs.isDebugEnabled()&&Fs.debug("Subscription "+e+":"+this.getItemNameOrPos(t)+": snapshot cleared"),this.eventDispatcher.onClearSnapshot(this.getItemName(t),t)},fireOnLostUpdates:function(t,e,i){Fs.isDebugEnabled()&&Fs.debug("Subscription "+i+":"+this.getItemNameOrPos(t)+": lost "+e+" updates"),this.eventDispatcher.onItemLostUpdates(this.getItemName(t),t,e)},fireOnItemUpdate:function(t,e){Fs.isDebugEnabled()&&Fs.debug("Subscription "+e+":"+this.getItemNameOrPos(t.getItemPos())+" update: "+m.string(t)),this.eventDispatcher.onItemUpdate(t)},fireOnRealMaxFrequency:function(t,e){Fs.isDebugEnabled()&&Fs.debug("Subscription "+e+" real max frequency changed: "+m.string(t)),this.eventDispatcher.onRealMaxFrequency(hi(t))},fireOnSubscriptionError2Level:function(t,e,i,s,n){Fs.isWarnEnabled()&&Fs.warn("Subscription "+s+":"+this.getItemNameOrPos(n)+":"+t+" failed: "+e+" - "+i),this.eventDispatcher.onCommandSecondLevelSubscriptionError(e,i,t)},fireOnLostUpdates2Level:function(t,e,i,s){Fs.isDebugEnabled()&&Fs.debug("Subscription "+i+":"+this.getItemNameOrPos(s)+":"+t+": lost "+e+" updates"),this.eventDispatcher.onCommandSecondLevelItemLostUpdates(e,t)},toString:function(){var t=ge._new();return ge.set(t,"mode",this.mode),ge.set(t,"items",null!=this.items?m.string(this.items):this.group),ge.set(t,"fields",null!=this.fields?m.string(this.fields):this.schema),ge.set(t,"dataAdapter",this.dataAdapter),ge.set(t,"requestedBufferSize",this.bufferSize),ge.set(t,"requestedSnapshot",this.snapshot),ge.set(t,"requestedMaxFrequency",this.requestedMaxFrequency),ge.set(t,"selector",this.selector),ge.set(t,"secondLevelFields",null!=this.fields2?m.string(this.fields2):this.schema2),ge.set(t,"secondLevelDataAdapter",this.dataAdapter2),ki.stringify(t.h)},__class__:N};var D=function(t,e,i,s,n,r,a){this.slw_m=.5,this.slw_hugeDelayMs=2e4,this.slw_maxAvgDelayMs=7e3,this.slw_avgDelayMs=0,this.slw_refTime=0,this.rec_clientProg=0,this.rec_serverProg=0,this.subscriptionManagers=pe._new(),this.messageManagers=Se._new(),this.sequenceMap=new ki,this.disabledTransports=new Ne,this.suspendedTransports=new Ne,this.ctrl_connectTs=0,this.recoverTs=0,this.connectTs=0,this.m_nextSubId=0,this.m_nextReqId=0,this.m_status="DISCONNECTED",this.delayCounter=new Ct,this.state=new j,this.client=t,this.lock=t.lock,this.details=t.connectionDetails,this.options=t.connectionOptions,this.wsFactory=e,this.httpFactory=i,this.ctrlFactory=s,this.timerFactory=n,this.randomGenerator=r,this.reachabilityFactory=a,this.clientEventDispatcher=t.eventDispatcher,this.switchRequest=new W(this),this.constrainRequest=new H(this),this.delayCounter.reset(this.options.retryDelay)};D.__name__="com.lightstreamer.client.internal.ClientMachine",D.prototype={disposeSession:function(){this.disposeWS(),this.disposeHTTP(),this.disposeCtrl(),this.details.serverInstanceAddress=null,this.details.serverSocketName=null,this.details.clientIp=null,this.details.sessionId=null,this.options.realMaxBandwidth=null,this.lastKnownClientIp=null,this.resetSequenceMap(),this.rec_serverProg=0,this.rec_clientProg=0,this.bw_lastReqId=null,this.bw_requestedMaxBandwidth=null,this.swt_lastReqId=null},disposeClient:function(){this.sessionId=null,this.enableAllTransports(),this.resetCurrentRetryDelay(),this.resetSequenceMap(),this.cause=null},evtExtConnect:function(){this.traceEvent("connect");var t=!0;100==this.state.s_m&&(this.cause="api",this.resetCurrentRetryDelay(),this.state.s_m=101,this.state.traceState(),t=this.evtExtConnect_NextRegion(),this.evtSelectCreate()),t&&(t=this.evtExtConnect_NextRegion())},evtExtConnect_NextRegion:function(){return this.evtExtConnect_NetworkReachabilityRegion()},evtExtConnect_NetworkReachabilityRegion:function(){var t=this;if(1400==this.state.s_nr){var e=new ui(this.getServerAddress()).get_hostname();this.nr_reachabilityManager=this.reachabilityFactory(e),this.state.s_nr=1410,this.state.traceState(),this.nr_reachabilityManager.startListening((function(i){switch(i._hx_index){case 0:t.evtNetworkReachable(e);break;case 1:t.evtNetworkNotReachable(e)}}))}return!1},evtNetworkNotReachable:function(t){ks.isInfoEnabled()&&ks.info(t+" is NOT reachable"),this.traceEvent("nr:network.not.reachable"),(1410==this.state.s_nr||1412==this.state.s_nr)&&(this.state.s_nr=1411,this.state.traceState())},evtNetworkReachable:function(t){ks.isInfoEnabled()&&ks.info(t+" is reachable"),this.traceEvent("nr:network.reachable"),1410==this.state.s_nr?(this.state.s_nr=1412,this.state.traceState()):1411==this.state.s_nr&&(this.state.s_nr=1412,this.state.traceState(),this.evtOnlineAgain())},evtOnlineAgain:function(){this.traceEvent("online.again"),112==this.state.s_m?(this.state.s_m=116,this.state.traceState(),this.cancel_evtRetryTimeout(),this.evtSelectCreate()):1003==this.state.s_rec&&(this.sendRecovery(),this.state.s_rec=1001,this.state.traceState(),this.cancel_evtRetryTimeout(),this.schedule_evtTransportTimeout(this.options.retryDelay))},evtServerAddressChanged:function(){var t=this;switch(this.traceEvent("nr:serverAddress.changed"),this.state.s_nr){case 1410:case 1411:case 1412:var e=this.nr_reachabilityManager,i=new ui(this.getServerAddress()).get_hostname();this.nr_reachabilityManager=this.reachabilityFactory(i),this.state.s_nr=1410,this.state.traceState(),null!=e&&e.stopListening(),this.nr_reachabilityManager.startListening((function(e){switch(e._hx_index){case 0:t.evtNetworkReachable(i);break;case 1:t.evtNetworkNotReachable(i)}}))}},evtExtDisconnect:function(t){switch(this.traceEvent("disconnect: cause="+m.string(t)),this.state.s_m){case 110:case 111:case 112:case 113:case 114:case 115:case 116:this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.s_m=100,this.state.traceState(),this.cancel_evtRetryTimeout(),this.evtTerminate(t);break;case 120:case 121:case 122:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.s_m=100,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtTerminate(t);break;case 130:case 140:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.s_m=100,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtTerminate(t);break;case 150:var e=this.state.s_tr;if(null!=e)switch(e){case 210:this.sendDestroyWS(),this.closeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.clear_w(),this.state.goto_m_from_session(100),this.exit_w(),this.evtEndSession(),this.evtTerminate(t);break;case 220:case 230:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_session(100),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.evtTerminate(t);break;case 240:var i;if(500==(null!=(n=this.state.s_ws)?n.m:null))this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_ws(100),this.exit_ws_to_m(),this.evtTerminate(t);else(n=!!(s=501==(null!=(i=this.state.s_ws)?i.m:null)||502==(null!=(i=this.state.s_ws)?i.m:null))||503==(null!=(s=this.state.s_ws)?s.m:null))&&(this.sendDestroyWS(),this.closeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_ws(100),this.exit_ws_to_m(),this.evtTerminate(t));break;case 250:var s,n;(n=600==(null!=(s=this.state.s_wp)?s.m:null)||601==(null!=(s=this.state.s_wp)?s.m:null))?(this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_wp(100),this.exit_ws_to_m(),this.evtTerminate(t)):602==(null!=(n=this.state.s_wp)?n.m:null)&&(this.sendDestroyWS(),this.closeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_wp(100),this.exit_wp_to_m(),this.evtTerminate(t));break;case 260:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_rec(100),this.exit_rec_to_m(),this.evtTerminate(t);break;case 270:710==this.state.s_h?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_hs(100),this.exit_hs_to_m(),this.evtTerminate(t)):720==this.state.s_h&&(this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_hp(100),this.exit_hp_to_m(),this.evtTerminate(t))}}},evtSelectCreate:function(){if(this.traceEvent("select.create"),101==this.state.s_m||116==this.state.s_m)switch(this.getBestForCreating()._hx_index){case 0:this.notifyStatus("CONNECTING"),this.openWS_Create(),this.state.s_m=120,this.state.traceState(),this.evtCreate(),this.schedule_evtTransportTimeout(this.delayCounter.get_currentRetryDelay());break;case 1:this.notifyStatus("CONNECTING"),this.sendCreateHTTP(),this.state.s_m=130,this.state.traceState(),this.evtCreate(),this.schedule_evtTransportTimeout(this.delayCounter.get_currentRetryDelay());break;case 2:this.notifyStatus("DISCONNECTED"),this.state.s_m=100,this.state.traceState(),this.evtTerminate(A.TC_otherError("Unable to select a transport"))}},evtWSOpen:function(){var t;this.traceEvent("ws.open"),120==this.state.s_m?(this.sendCreateWS(),this.state.s_m=121,this.state.traceState()):500==(null!=(t=this.state.s_ws)?t.m:null)?(this.sendBindWS_Streaming(),this.state.s_ws.m=501,this.state.traceState()):600==(null!=(t=this.state.s_wp)?t.m:null)&&(Ee.sure(this.ws).send("wsok"),this.state.s_wp.m=601,this.state.traceState())},evtMessage:function(t){var e=!0;if(v.startsWith(t,"U,")){var i=yt(t);this.evtU(i.subId,i.itemIdx,i.values,t)}else if(v.startsWith(t,"REQOK"))"REQOK"==t?this.evtREQOK_withoutReqId():this.evtREQOK(vt(t.split(",")[1]));else if(v.startsWith(t,"PROBE"))this.evtPROBE();else if(v.startsWith(t,"LOOP"))this.evtLOOP(vt(t.split(",")[1]));else if(v.startsWith(t,"CONOK")){var s=t.split(",");this.evtCONOK(s[1],vt(s[2]),vt(s[3]),s[4])}else if(v.startsWith(t,"WSOK"))this.evtWSOK();else if(v.startsWith(t,"SERVNAME"))this.evtSERVNAME(t.split(",")[1]);else if(v.startsWith(t,"CLIENTIP"))this.evtCLIENTIP(t.split(",")[1]);else if(v.startsWith(t,"CONS")){var n=t.split(",")[1];switch(n){case"unlimited":this.evtCONS(ii.BWUnlimited);break;case"unmanaged":this.evtCONS(ii.BWUnmanaged);break;default:this.evtCONS(ii.BWLimited(St(n)))}}else if(v.startsWith(t,"MSGDONE")){"*"==(o=(s=t.split(","))[1])&&(o="UNORDERED_MESSAGES");var r=vt(s[2]),a=s[3];this.evtMSGDONE(o,r,""==a?"":wt(a))}else if(v.startsWith(t,"MSGFAIL")){var o;"*"==(o=(s=t.split(","))[1])&&(o="UNORDERED_MESSAGES"),this.evtMSGFAIL(o,vt(s[2]),vt(s[3]),wt(s[4]))}else if(v.startsWith(t,"REQERR"))s=t.split(","),this.evtREQERR(vt(s[1]),vt(s[2]),wt(s[3]));else if(v.startsWith(t,"PROG"))this.evtPROG(vt(t.split(",")[1]));else if(v.startsWith(t,"SUBOK"))s=t.split(","),this.evtSUBOK(vt(s[1]),vt(s[2]),vt(s[3]));else if(v.startsWith(t,"SUBCMD"))s=t.split(","),this.evtSUBCMD(vt(s[1]),vt(s[2]),vt(s[3]),vt(s[4]),vt(s[5]));else if(v.startsWith(t,"UNSUB"))this.evtUNSUB(vt(t.split(",")[1]));else if(v.startsWith(t,"CONF")){var h=vt((s=t.split(","))[1]);"unlimited"==s[2]?this.evtCONF(h,ei.RFreqUnlimited):this.evtCONF(h,ei.RFreqLimited(St(s[2])))}else v.startsWith(t,"EOS")?(s=t.split(","),this.evtEOS(vt(s[1]),vt(s[2]))):v.startsWith(t,"CS")?(s=t.split(","),this.evtCS(vt(s[1]),vt(s[2]))):v.startsWith(t,"OV")?(s=t.split(","),this.evtOV(vt(s[1]),vt(s[2]),vt(s[3]))):v.startsWith(t,"NOOP")?this.evtNOOP():v.startsWith(t,"CONERR")?(s=t.split(","),this.evtCONERR(vt(s[1]),wt(s[2]))):v.startsWith(t,"END")?(s=t.split(","),this.evtEND(vt(s[1]),wt(s[2]))):v.startsWith(t,"ERROR")?(s=t.split(","),this.evtERROR(vt(s[1]),wt(s[2]))):v.startsWith(t,"SYNC")?this.evtSYNC(vt(t.split(",")[1])):e=!1;return e},evtCtrlMessage:function(t){if(v.startsWith(t,"REQOK"))"REQOK"==t?this.evtREQOK_withoutReqId():this.evtREQOK(vt(t.split(",")[1]));else if(v.startsWith(t,"REQERR")){var e=t.split(",");this.evtREQERR(vt(e[1]),vt(e[2]),wt(e[3]))}else v.startsWith(t,"ERROR")&&(e=t.split(","),this.evtERROR(vt(e[1]),wt(e[2])))},evtTransportTimeout:function(){switch(this.traceEvent("transport.timeout"),this.state.s_m){case 120:case 121:this.suspendWS_Streaming(),this.disposeWS(),this.cause="ws.unavailable",this.state.s_m=115,this.state.traceState(),this.cancel_evtTransportTimeout(),this.entry_m115(F.ws_unavailable);break;case 122:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.timeout",this.state.s_m=112,this.state.traceState(),this.cancel_evtTransportTimeout(),this.entry_m112(F.ws_timeout);break;case 130:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.timeout",this.state.s_m=112,this.state.traceState(),this.cancel_evtTransportTimeout(),this.entry_m112(F.http_timeout);break;case 140:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ttl.timeout";var t=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs);this.state.s_m=111,this.state.traceState(),this.cancel_evtTransportTimeout(),this.entry_m111(F.http_error,t);break;case 150:if(null!=(i=this.state.s_tr))switch(i){case 220:0==this.options.sessionRecoveryTimeout?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.timeout",this.state.goto_m_from_session(112),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.entry_m112(F.http_timeout)):(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.timeout",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec(),this.cancel_evtTransportTimeout(),this.entry_rec(t,F.http_timeout));break;case 230:0==this.options.sessionRecoveryTimeout?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ttl.timeout",this.state.goto_m_from_session(112),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.entry_m112(F.http_timeout)):(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ttl.timeout",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec(),this.cancel_evtTransportTimeout(),this.entry_rec(t,F.http_error));break;case 240:if(null!=(i=null!=(e=this.state.s_ws)?e.m:null))switch(i){case 500:this.disableWS(),this.disposeWS(),this.cause="ws.unavailable",this.state.clear_ws(),this.state.s_tr=200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSwitchTransport();break;case 501:0==this.options.sessionRecoveryTimeout?(this.disableWS(),this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.unavailable",this.state.goto_m_from_ws(112),this.exit_ws_to_m(),this.entry_m112(F.ws_unavailable)):(this.disableWS(),this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.unavailable",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_ws(),this.exit_ws(),this.entry_rec(t,F.ws_unavailable));break;case 502:0==this.options.sessionRecoveryTimeout?(this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.timeout",this.state.goto_m_from_ws(112),this.exit_ws_to_m(),this.entry_m112(F.ws_timeout)):(this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.timeout",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_ws(),this.exit_ws(),this.entry_rec(t,F.ws_timeout))}break;case 250:if(null!=(i=null!=(e=this.state.s_wp)?e.m:null))switch(i){case 600:case 601:this.disableWS(),this.disposeWS(),this.cause="ws.unavailable",this.state.clear_wp(),this.state.s_tr=200,this.state.traceState(),this.exit_wp(),this.evtSwitchTransport()}break;case 260:1001==this.state.s_rec&&(this.disposeHTTP(),this.state.s_rec=1002,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtCheckRecoveryTimeout(q.RRC_transport_timeout));break;case 270:var e,i;if(null!=(i=this.state.s_h)&&710==i&&null!=(i=null!=(e=this.state.s_hs)?e.m:null))switch(i){case 800:this.disableHTTP_Streaming(),this.cause="http.streaming.unavailable",this.state.s_hs.m=801,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtForcePolling(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 801:0==this.options.sessionRecoveryTimeout?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.timeout",this.state.goto_m_from_hs(112),this.exit_hs_to_m(),this.entry_m112(F.http_timeout)):(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.timeout",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_hs(),this.exit_hs_to_rec(),this.entry_rec(t,F.http_timeout))}}}},evtTransportError:function(){switch(this.traceEvent("transport.error"),this.state.s_m){case 120:case 121:this.suspendWS_Streaming(),this.disposeWS(),this.cause="ws.unavailable",this.state.s_m=115,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(F.ws_unavailable),this.evtRetryTimeout();break;case 122:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.error";var t=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs);this.state.s_m=112,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(F.ws_error,t),this.schedule_evtRetryTimeout(t);break;case 130:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.error",t=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs),this.state.s_m=112,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(F.http_error,t),this.schedule_evtRetryTimeout(t);break;case 140:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ttl.error",t=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs),this.state.s_m=111,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(F.http_error,t),this.schedule_evtRetryTimeout(t);break;case 150:var e=this.state.s_tr;if(null!=e)switch(e){case 210:0==this.options.sessionRecoveryTimeout?(this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.error",this.state.clear_w(),this.state.goto_m_from_session(113),this.exit_w(),this.evtEndSession(),this.entry_m113(F.ws_error)):(this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.error",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.clear_w(),this.state.s_tr=260,this.state.s_rec=1e3,this.state.traceState(),this.exit_w(),this.entry_rec(t,F.ws_error));break;case 220:0==this.options.sessionRecoveryTimeout?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.error",t=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs),this.state.goto_m_from_session(112),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.evtRetry(F.http_error,t),this.schedule_evtRetryTimeout(t)):(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.error",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec(),this.cancel_evtTransportTimeout(),this.entry_rec(t,F.http_error));break;case 230:0==this.options.sessionRecoveryTimeout?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ttl.error",t=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs),this.state.goto_m_from_session(112),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.evtRetry(F.http_error,t),this.schedule_evtRetryTimeout(t)):(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ttl.error",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec(),this.cancel_evtTransportTimeout(),this.entry_rec(t,F.http_error));break;case 240:switch(Ee.sure(this.state.s_ws).m){case 500:this.disableWS(),this.disposeWS(),this.cause="ws.unavailable",this.state.clear_ws(),this.state.s_tr=200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSwitchTransport();break;case 501:0==this.options.sessionRecoveryTimeout?(this.disableWS(),this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.unavailable",this.state.goto_m_from_ws(112),this.exit_ws_to_m(),this.entry_m112(F.ws_unavailable)):(this.disableWS(),this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.unavailable",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_ws(),this.exit_ws(),this.entry_rec(t,F.ws_unavailable));break;case 502:0==this.options.sessionRecoveryTimeout?(this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.error",this.state.goto_m_from_ws(112),this.exit_ws_to_m(),this.entry_m112(F.ws_error)):(this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.error",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_ws(),this.cancel_evtTransportTimeout(),this.entry_rec(t,F.ws_error));break;case 503:0==this.options.sessionRecoveryTimeout?(this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.error",this.state.goto_m_from_ws(113),this.exit_ws_to_m(),this.entry_m113(F.ws_error)):(this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.error",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_ws(),this.exit_ws(),this.entry_rec(t,F.ws_error))}break;case 250:switch(Ee.sure(this.state.s_wp).m){case 600:case 601:this.disableWS(),this.disposeWS(),this.cause="ws.unavailable",this.state.clear_wp(),this.state.s_tr=200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSwitchTransport();break;case 602:0==this.options.sessionRecoveryTimeout?(this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.error",this.state.goto_m_from_wp(113),this.exit_wp_to_m(),this.entry_m113(F.ws_error)):(this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.error",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_wp(),this.exit_wp(),this.entry_rec(t,F.ws_error))}break;case 260:1001==this.state.s_rec&&(this.disposeHTTP(),this.state.s_rec=1002,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtCheckRecoveryTimeout(q.RRC_transport_error));break;case 270:switch(Ee.sure(this.state.s_h)){case 710:switch(Ee.sure(this.state.s_hs).m){case 800:case 801:0==this.options.sessionRecoveryTimeout?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.error",this.state.goto_m_from_hs(112),this.exit_hs_to_m(),this.entry_m112(F.http_error)):(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.error",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_hs(),this.exit_hs_to_rec(),this.entry_rec(t,F.http_error));break;case 802:0==this.options.sessionRecoveryTimeout?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.error",this.state.goto_m_from_hs(113),this.exit_hs_to_m(),this.entry_m113(F.http_error)):(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.error",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_hs(),this.exit_hs_to_rec(),this.entry_rec(t,F.http_error))}break;case 720:switch(Ee.sure(this.state.s_hp).m){case 900:case 901:case 902:case 903:case 904:0==this.options.sessionRecoveryTimeout?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.error",this.state.goto_m_from_hp(112),this.exit_hp_to_m(),this.entry_m112(F.http_error)):(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.error",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_hp(),this.exit_hp_to_rec(),this.entry_rec(t,F.http_error))}}}}},evtIdleTimeout:function(){if(this.traceEvent("idle.timeout"),null==(s=null!=(i=this.state.s_wp)?i.p:null))e=!1;else switch(s){case 610:case 611:case 613:e=!0;break;default:e=!1}if(e)if(0==this.options.sessionRecoveryTimeout)this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.idle.timeout",this.state.goto_m_from_wp(113),this.exit_wp_to_m(),this.entry_m113(F.idle_timeout);else{this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.idle.timeout";var t=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec_from_wp(),this.exit_wp(),this.entry_rec(t,F.idle_timeout)}else{var e,i,s;if(null==(s=null!=(i=this.state.s_hp)?i.m:null))e=!1;else switch(s){case 900:case 901:case 903:e=!0;break;default:e=!1}e&&(0==this.options.sessionRecoveryTimeout?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.idle.timeout",this.state.goto_m_from_hp(112),this.exit_hp_to_m(),this.entry_m112(F.idle_timeout)):(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.idle.timeout",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_hp(),this.exit_hp_to_rec(),this.entry_rec(t,F.idle_timeout)))}},evtPollingTimeout:function(){var t;this.traceEvent("polling.timeout"),612==(null!=(t=this.state.s_wp)?t.p:null)?(this.sendBindWS_Polling(),this.state.s_wp.p=613,this.state.traceState(),this.cancel_evtPollingTimeout(),this.schedule_evtIdleTimeout(Ye.plus(Ee.sure(this.idleTimeout),this.options.retryDelay))):902==(null!=(t=this.state.s_hp)?t.m:null)&&(this.sendBindHTTP_Polling(),this.state.s_hp.m=903,this.state.traceState(),this.cancel_evtPollingTimeout(),this.schedule_evtIdleTimeout(Ye.plus(Ee.sure(this.idleTimeout),this.options.retryDelay)))},evtKeepaliveTimeout:function(){var t;this.traceEvent("keepalive.timeout"),310==(null!=(t=this.state.s_w)?t.k:null)?(this.state.s_w.k=311,this.state.traceState(),this.cancel_evtKeepaliveTimeout(),this.schedule_evtStalledTimeout(this.options.stalledTimeout)):520==(null!=(t=this.state.s_ws)?t.k:null)?(this.state.s_ws.k=521,this.state.traceState(),this.cancel_evtKeepaliveTimeout(),this.schedule_evtStalledTimeout(this.options.stalledTimeout)):820==(null!=(t=this.state.s_hs)?t.k:null)&&(this.state.s_hs.k=821,this.state.traceState(),this.cancel_evtKeepaliveTimeout(),this.schedule_evtStalledTimeout(this.options.stalledTimeout))},evtStalledTimeout:function(){var t;this.traceEvent("stalled.timeout"),311==(null!=(t=this.state.s_w)?t.k:null)?(this.state.s_w.k=312,this.state.traceState(),this.cancel_evtStalledTimeout(),this.schedule_evtReconnectTimeout(this.options.reconnectTimeout)):521==(null!=(t=this.state.s_ws)?t.k:null)?(this.state.s_ws.k=522,this.state.traceState(),this.cancel_evtStalledTimeout(),this.schedule_evtReconnectTimeout(this.options.reconnectTimeout)):821==(null!=(t=this.state.s_hs)?t.k:null)&&(this.state.s_hs.k=822,this.state.traceState(),this.cancel_evtStalledTimeout(),this.schedule_evtReconnectTimeout(this.options.reconnectTimeout))},evtReconnectTimeout:function(){var t;if(this.traceEvent("reconnect.timeout"),312==(null!=(t=this.state.s_w)?t.k:null))if(0==this.options.sessionRecoveryTimeout)this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.stalled",this.state.goto_m_from_w(113),this.exit_w_to_m(),this.entry_m113(F.stalled_timeout);else{this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.stalled";var e=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec_from_w(),this.exit_w(),this.entry_rec(e,F.stalled_timeout)}else 522==(null!=(t=this.state.s_ws)?t.k:null)?0==this.options.sessionRecoveryTimeout?(this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.stalled",this.state.goto_m_from_ws(113),this.exit_ws_to_m(),this.entry_m113(F.stalled_timeout)):(this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.stalled",e=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_ws(),this.exit_ws(),this.entry_rec(e,F.stalled_timeout)):822==(null!=(t=this.state.s_hs)?t.k:null)&&(0==this.options.sessionRecoveryTimeout?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.stalled",this.state.goto_m_from_hs(113),this.exit_hs_to_m(),this.entry_m113(F.stalled_timeout)):(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.stalled",e=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_hs(),this.exit_hs_to_rec(),this.entry_rec(e,F.stalled_timeout)))},evtRestartKeepalive:function(){var t;this.traceEvent("restart.keepalive"),null!=(null!=(t=this.state.s_w)?t.k:null)?(this.state.s_w.k=310,this.state.traceState(),this.exit_keepalive_unit(),this.schedule_evtKeepaliveTimeout(Ee.sure(this.keepaliveInterval))):null!=(null!=(t=this.state.s_ws)?t.k:null)?(this.state.s_ws.k=520,this.state.traceState(),this.exit_keepalive_unit(),this.schedule_evtKeepaliveTimeout(Ee.sure(this.keepaliveInterval))):null!=(null!=(t=this.state.s_hs)?t.k:null)&&(this.state.s_hs.k=820,this.state.traceState(),this.exit_keepalive_unit(),this.schedule_evtKeepaliveTimeout(Ee.sure(this.keepaliveInterval)))},evtWSOK:function(){switch(this.traceEvent("WSOK"),Ns.isDebugEnabled()&&Ns.debug("WSOK"),this.state.s_m){case 121:this.state.s_m=122,this.state.traceState();break;case 150:if(null!=(e=this.state.s_tr))switch(e){case 240:null!=(e=null!=(t=this.state.s_ws)?t.m:null)&&501==e&&(this.state.s_ws.m=502,this.state.traceState());break;case 250:var t,e;null!=(e=null!=(t=this.state.s_wp)?t.m:null)&&601==e&&(this.sendBindWS_FirstPolling(),this.state.s_wp.m=602,this.state.s_wp.p=610,this.state.s_wp.c=620,this.state.s_wp.s=630,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSendPendingControls(),this.evtSendPendingMessages(),this.schedule_evtIdleTimeout(Ye.plus(Ee.sure(this.idleTimeout),this.options.retryDelay)))}}},evtCONERR:function(t,e){this.traceEvent("CONERR"),Ns.isDebugEnabled()&&Ns.debug("CONERR "+t+" "+e);var i=F.standardError(t,e),s=A.TC_standardError(t,e);if(122==this.state.s_m)switch(t){case 5:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.conerr."+t,this.state.s_m=110,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(i),this.evtRetryTimeout();break;case 4:case 6:case 20:case 40:case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.conerr."+t;var n=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs);this.state.s_m=112,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(i,n),this.schedule_evtRetryTimeout(n);break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.s_m=100,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtTerminate(s)}else if(130==this.state.s_m)switch(t){case 5:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.conerr."+t,this.state.s_m=110,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(i),this.evtRetryTimeout();break;case 4:case 6:case 20:case 40:case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.conerr."+t,n=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs),this.state.s_m=112,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(i,n),this.schedule_evtRetryTimeout(n);break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.s_m=100,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtTerminate(s)}else if(140==this.state.s_m)switch(t){case 5:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ttl.conerr."+t,this.state.s_m=110,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(i),this.evtRetryTimeout();break;case 4:case 6:case 20:case 40:case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ttl.conerr."+t,n=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs),this.state.s_m=112,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(i,n),this.schedule_evtRetryTimeout(n);break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.s_m=100,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtTerminate(s)}else{var r,a;if(502==(null!=(r=this.state.s_ws)?r.m:null))switch(t){case 4:case 6:case 20:case 40:case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.conerr."+t,this.state.goto_m_from_ws(112),this.exit_ws_to_m(),this.entry_m112(F.standardError(t,e));break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.goto_m_from_ws(100),this.exit_ws_to_m(),this.evtTerminate(s)}else if(r=610==(null!=(a=this.state.s_wp)?a.p:null)||613==(null!=(a=this.state.s_wp)?a.p:null))switch(t){case 4:case 6:case 20:case 40:case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.conerr."+t,this.state.goto_m_from_wp(112),this.exit_wp_to_m(),this.entry_m112(F.standardError(t,e));break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.goto_m_from_wp(100),this.exit_wp_to_m(),this.evtTerminate(s)}else if(r=800==(null!=(a=this.state.s_hs)?a.m:null)||801==(null!=(a=this.state.s_hs)?a.m:null))switch(t){case 4:case 6:case 20:case 40:case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.conerr."+t,this.state.goto_m_from_hs(112),this.exit_hs_to_m(),this.entry_m112(F.standardError(t,e));break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.goto_m_from_hs(100),this.exit_hs_to_m(),this.evtTerminate(s)}else if(r=900==(null!=(a=this.state.s_hp)?a.m:null)||903==(null!=(a=this.state.s_hp)?a.m:null))switch(t){case 4:case 6:case 20:case 40:case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.conerr."+t,this.state.goto_m_from_hp(112),this.exit_hp_to_m(),this.entry_m112(F.standardError(t,e));break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.goto_m_from_hp(100),this.exit_hp_to_m(),this.evtTerminate(s)}else if(1001==this.state.s_rec)switch(t){case 4:case 6:case 20:case 40:case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="recovery.conerr."+t,this.state.goto_m_from_rec(113),this.exit_rec_to_m(),this.entry_m113(i);break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.goto_m_from_rec(100),this.exit_rec_to_m(),this.evtTerminate(s)}}},evtEND:function(t,e){this.traceEvent("END"),Ns.isDebugEnabled()&&Ns.debug("END "+t+" "+e);var i=F.standardError(t,e),s=A.TC_standardError(t,e);if(300==(null!=(a=this.state.s_w)?a.p:null))switch(t){case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.end."+t;var n=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.clear_w(),this.state.goto_m_from_session(113),this.exit_w(),this.evtEndSession(),this.evtRetry(F.standardError(t,e),n),this.schedule_evtRetryTimeout(n);break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.clear_w(),this.state.goto_m_from_session(100),this.exit_w(),this.evtEndSession(),this.evtTerminate(s)}else if(502==(null!=(a=this.state.s_ws)?a.m:null))switch(t){case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.end."+t,this.state.goto_m_from_ws(112),this.exit_ws_to_m(),this.entry_m112(F.standardError(t,e));break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_ws(100),this.exit_ws_to_m(),this.evtTerminate(s)}else if(510==(null!=(a=this.state.s_ws)?a.p:null))switch(t){case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.end."+t,this.state.goto_m_from_ws(113),this.exit_ws_to_m(),this.entry_m113(i);break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_ws(100),this.exit_ws_to_m(),this.evtTerminate(s)}else if(a=610==(null!=(r=this.state.s_wp)?r.p:null)||613==(null!=(r=this.state.s_wp)?r.p:null))switch(t){case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.end."+t,this.state.goto_m_from_wp(112),this.exit_wp_to_m(),this.entry_m112(F.standardError(t,e));break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_wp(100),this.exit_wp_to_m(),this.evtTerminate(s)}else if(611==(null!=(a=this.state.s_wp)?a.p:null))switch(t){case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.end."+t,this.state.goto_m_from_wp(113),this.exit_wp_to_m(),this.entry_m113(i);break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_wp(100),this.exit_wp_to_m(),this.evtTerminate(s)}else if(a=800==(null!=(r=this.state.s_hs)?r.m:null)||801==(null!=(r=this.state.s_hs)?r.m:null))switch(t){case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.end."+t,this.state.goto_m_from_hs(112),this.exit_hs_to_m(),this.entry_m112(F.standardError(t,e));break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_hs(100),this.exit_hs_to_m(),this.evtTerminate(s)}else if(810==(null!=(a=this.state.s_hs)?a.p:null))switch(t){case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.end."+t,this.state.goto_m_from_hs(113),this.exit_hs_to_m(),this.entry_m113(i);break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_hs(100),this.exit_hs_to_m(),this.evtTerminate(s)}else{var r,a;if(a=900==(null!=(r=this.state.s_hp)?r.m:null)||903==(null!=(r=this.state.s_hp)?r.m:null))switch(t){case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.end."+t,this.state.goto_m_from_hp(112),this.exit_hp_to_m(),this.entry_m112(F.standardError(t,e));break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_hp(100),this.exit_hp_to_m(),this.evtTerminate(s)}else if(901==(null!=(a=this.state.s_hp)?a.m:null))switch(t){case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.end."+t,this.state.goto_m_from_hp(113),this.exit_hp_to_m(),this.entry_m113(i);break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_hp(100),this.exit_hp_to_m(),this.evtTerminate(s)}else if(1001==this.state.s_rec)switch(t){case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="recovery.end."+t,this.state.goto_m_from_rec(113),this.exit_rec_to_m(),this.entry_m113(i);break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_rec(100),this.exit_rec_to_m(),this.evtTerminate(s)}}},evtERROR:function(t,e){this.traceEvent("ERROR"),Ns.isDebugEnabled()&&Ns.debug("ERROR "+t+" "+e);var i,s=A.TC_standardError(t,e);300==(null!=(i=this.state.s_w)?i.p:null)?(this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_ERROR(t,e),this.state.clear_w(),this.state.goto_m_from_session(100),this.exit_w(),this.evtEndSession(),this.evtTerminate(s)):510==(null!=(i=this.state.s_ws)?i.p:null)?(this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_ERROR(t,e),this.state.goto_m_from_ws(100),this.exit_ws_to_m(),this.evtTerminate(s)):620==(null!=(i=this.state.s_wp)?i.c:null)?(this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_ERROR(t,e),this.state.goto_m_from_wp(100),this.exit_wp_to_m(),this.evtTerminate(s)):1102==this.state.s_ctrl&&(this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_ERROR(t,e),this.state.goto_m_from_ctrl(100),this.exit_ctrl_to_m(),this.evtTerminate(s))},evtREQOK_withoutReqId:function(){this.traceEvent("REQOK"),Ns.isDebugEnabled()&&Ns.debug("REQOK"),1102==this.state.s_ctrl&&(this.state.s_ctrl=1102,this.state.traceState())},evtREQOK:function(t){this.traceEvent("REQOK"),Ns.isDebugEnabled()&&Ns.debug("REQOK "+t);var e=!0;1302==this.state.s_swt&&t==this.swt_lastReqId?(this.state.s_swt=1303,this.state.traceState(),e=this.evtREQOK_TransportRegion(t)):1202==this.state.s_bw&&t==this.bw_lastReqId?(this.state.s_bw=1200,this.state.traceState(),e=this.evtREQOK_TransportRegion(t),this.evtCheckBW()):e=this.evtREQOK_Forward(t),e&&this.evtREQOK_TransportRegion(t)},evtREQOK_Forward:function(t){return!0},evtREQOK_TransportRegion:function(t){var e;return 300==(null!=(e=this.state.s_w)?e.p:null)?(this.state.s_w.p=300,this.state.traceState(),this.doREQOK(t),this.evtRestartKeepalive()):510==(null!=(e=this.state.s_ws)?e.p:null)?(this.state.s_ws.p=510,this.state.traceState(),this.doREQOK(t),this.evtRestartKeepalive()):620==(null!=(e=this.state.s_wp)?e.c:null)?(this.state.s_wp.c=620,this.state.traceState(),this.doREQOK(t)):1102==this.state.s_ctrl&&(this.state.s_ctrl=1102,this.state.traceState(),this.doREQOK(t)),!1},evtREQERR:function(t,e,i){this.traceEvent("REQERR"),Ns.isDebugEnabled()&&Ns.debug("REQERR "+t+" "+e+" "+i);var s=!0;1302==this.state.s_swt&&t==this.swt_lastReqId?(this.state.s_swt=1301,this.state.traceState(),s=this.evtREQERR_TransportRegion(t,e,i)):1202==this.state.s_bw&&t==this.bw_lastReqId?(this.state.s_bw=1200,this.state.traceState(),s=this.evtREQERR_TransportRegion(t,e,i),this.evtCheckBW()):s=this.evtREQERR_Forward(t,e,i),s&&this.evtREQERR_TransportRegion(t,e,i)},evtREQERR_Forward:function(t,e,i){return!0},evtREQERR_TransportRegion:function(t,e,i){var s,n=F.standardError(e,i),r=A.TC_standardError(e,i);if(300==(null!=(s=this.state.s_w)?s.p:null))switch(e){case 20:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.reqerr."+e;var a=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.clear_w(),this.state.goto_m_from_session(113),this.exit_w(),this.evtEndSession(),this.evtRetry(F.standardError(e,i),a),this.schedule_evtRetryTimeout(a);break;case 11:case 65:case 67:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_REQERR(e,i),this.state.clear_w(),this.state.goto_m_from_session(100),this.exit_w(),this.evtEndSession(),this.evtTerminate(r);break;default:this.state.s_w.p=300,this.state.traceState(),this.doREQERR(t,e,i),this.evtRestartKeepalive()}else if(510==(null!=(s=this.state.s_ws)?s.p:null))switch(e){case 20:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.reqerr."+e+")",this.state.goto_m_from_ws(113),this.exit_ws_to_m(),this.entry_m113(n);break;case 11:case 65:case 67:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_REQERR(e,i),this.state.goto_m_from_ws(100),this.exit_ws_to_m(),this.evtTerminate(r);break;default:this.state.s_ws.p=510,this.state.traceState(),this.doREQERR(t,e,i),this.evtRestartKeepalive()}else if(620==(null!=(s=this.state.s_wp)?s.c:null))switch(e){case 20:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.reqerr."+e,this.state.goto_m_from_wp(113),this.exit_wp_to_m(),this.entry_m113(n);break;case 11:case 65:case 67:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_REQERR(e,i),this.state.goto_m_from_wp(100),this.exit_wp_to_m(),this.evtTerminate(r);break;default:this.state.s_wp.c=620,this.state.traceState(),this.doREQERR(t,e,i)}else if(1102==this.state.s_ctrl)switch(e){case 20:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.reqerr."+e,this.state.goto_m_from_ctrl(113),this.exit_ctrl_to_m(),this.entry_m113(n);break;case 11:case 65:case 67:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_REQERR(e,i),this.state.goto_m_from_ctrl(100),this.exit_ctrl_to_m(),this.evtTerminate(r);break;default:this.state.s_ctrl=1102,this.state.traceState(),this.doREQERR(t,e,i)}return!1},evtPROG:function(t){this.traceEvent("PROG");var e=F.prog_mismatch(this.rec_serverProg,t);if(Ns.isDebugEnabled()&&Ns.debug("PROG "+t),300==(null!=(i=this.state.s_w)?i.p:null))t!=this.rec_serverProg?(this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.clear_w(),this.state.goto_m_from_session(113),this.exit_w(),this.evtEndSession(),this.entry_m113(e)):(this.state.s_w.p=300,this.state.traceState(),this.evtRestartKeepalive());else if(220==this.state.s_tr)t!=this.rec_serverProg?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.goto_m_from_session(113),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.entry_m113(e)):(this.state.s_tr=220,this.state.traceState());else if(230==this.state.s_tr)t!=this.rec_serverProg?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.goto_m_from_session(113),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.entry_m113(e)):(this.state.s_tr=230,this.state.traceState());else{var i;510==(null!=(i=this.state.s_ws)?i.p:null)?t!=this.rec_serverProg?(this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.goto_m_from_ws(113),this.exit_ws_to_m(),this.entry_m113(e)):(this.state.s_ws.p=510,this.state.traceState(),this.evtRestartKeepalive()):611==(null!=(i=this.state.s_wp)?i.p:null)?t!=this.rec_serverProg?(this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.goto_m_from_wp(113),this.exit_wp_to_m(),this.entry_m113(e)):(this.state.s_wp.p=611,this.state.traceState()):810==(null!=(i=this.state.s_hs)?i.p:null)?t!=this.rec_serverProg?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.goto_m_from_hs(113),this.exit_hs_to_m(),this.entry_m113(e)):(this.state.s_hs.p=810,this.state.traceState(),this.evtRestartKeepalive()):901==(null!=(i=this.state.s_hp)?i.m:null)?t!=this.rec_serverProg?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.goto_m_from_hp(113),this.exit_hp_to_m(),this.entry_m113(e)):(this.state.s_hp.m=901,this.state.traceState()):1001==this.state.s_rec&&(t>this.rec_clientProg?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.goto_m_from_rec(113),this.exit_rec_to_m(),this.entry_m113(e)):(this.state.s_rec=1001,this.state.traceState(),this.doPROG(t)))}},evtLOOP:function(t){if(this.traceEvent("LOOP"),Ns.isDebugEnabled()&&Ns.debug("LOOP "+t),300==(null!=(e=this.state.s_w)?e.p:null))this.closeWS(),this.cause="ws.loop",this.state.clear_w(),this.state.s_tr=200,this.state.traceState(),this.exit_w(),this.evtSwitchTransport();else if(220==this.state.s_tr)this.closeHTTP(),this.cause="http.loop",this.state.s_tr=200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSwitchTransport();else if(230==this.state.s_tr)this.closeHTTP(),this.cause="ttl.loop",this.state.s_tr=200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSwitchTransport();else{var e;510==(null!=(e=this.state.s_ws)?e.p:null)?(this.closeWS(),this.cause="ws.loop",this.state.clear_ws(),this.state.s_tr=200,this.state.traceState(),this.exit_ws(),this.evtSwitchTransport()):611==(null!=(e=this.state.s_wp)?e.p:null)?this.isSwitching()?(this.closeWS(),this.cause="ws.loop",this.state.clear_wp(),this.state.s_tr=200,this.state.traceState(),this.exit_wp(),this.evtSwitchTransport()):(this.doLOOP(t),this.state.s_wp.p=612,this.state.traceState(),this.cancel_evtIdleTimeout(),this.schedule_evtPollingTimeout(this.options.pollingInterval)):810==(null!=(e=this.state.s_hs)?e.p:null)?(this.closeHTTP(),this.cause="http.loop",this.state.s_hs.p=811,this.state.traceState(),this.evtSwitchTransport()):901==(null!=(e=this.state.s_hp)?e.m:null)?this.isSwitching()?(this.closeHTTP(),this.state.s_hp.m=904,this.state.traceState(),this.cancel_evtIdleTimeout(),this.evtSwitchTransport()):(this.doLOOP(t),this.closeHTTP(),this.state.s_hp.m=902,this.state.traceState(),this.cancel_evtIdleTimeout(),this.schedule_evtPollingTimeout(this.options.pollingInterval)):1001==this.state.s_rec&&(this.closeHTTP(),this.cause="recovery.loop",this.state.goto_200_from_rec(),this.exit_rec(),this.evtSwitchTransport())}},evtCONOK:function(t,e,i,s){if(this.traceEvent("CONOK"),Ns.isDebugEnabled()&&Ns.debug("CONOK "+t+" "+e+" "+i+" "+s),122==this.state.s_m)this.doCONOK_CreateWS(t,e,i,s),this.resetCurrentRetryDelay(),this.notifyStatus("CONNECTED:WS-STREAMING"),this.state.s_m=150,this.state.s_tr=210,this.state.s_w=new V(300,310,340),this.state.s_rhb=320,this.state.s_slw=330,this.state.s_swt=1300,this.state.s_bw=1200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSendPendingControls(),this.evtSendPendingMessages(),this.evtStartSession(),this.schedule_evtKeepaliveTimeout(Ee.sure(this.keepaliveInterval)),this.evtSelectRhb(),this.evtCheckTransport(),this.evtCheckBW();else if(130==this.state.s_m)this.doCONOK_CreateHTTP(t,e,i,s),this.resetCurrentRetryDelay(),this.notifyStatus("CONNECTED:STREAM-SENSING"),this.state.s_m=150,this.state.s_tr=220,this.state.s_swt=1300,this.state.s_bw=1200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtStartSession(),this.schedule_evtTransportTimeout(this.options.retryDelay),this.evtCheckTransport(),this.evtCheckBW();else if(140==this.state.s_m)this.doCONOK_CreateHTTP(t,e,i,s),this.resetCurrentRetryDelay(),this.notifyStatus("CONNECTED:STREAM-SENSING"),this.state.s_m=150,this.state.s_tr=230,this.state.s_swt=1300,this.state.s_bw=1200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtStartSession(),this.schedule_evtTransportTimeout(this.options.retryDelay),this.evtCheckTransport(),this.evtCheckBW();else{var n;502==(null!=(n=this.state.s_ws)?n.m:null)?(this.doCONOK_BindWS_Streaming(t,e,i,s),this.notifyStatus("CONNECTED:WS-STREAMING"),this.state.s_ws.m=503,this.state.s_ws.p=510,this.state.s_ws.k=520,this.state.s_ws.s=550,this.state.s_rhb=320,this.state.s_slw=330,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSendPendingControls(),this.evtSendPendingMessages(),this.schedule_evtKeepaliveTimeout(Ee.sure(this.keepaliveInterval)),this.evtSelectRhb()):610==(null!=(n=this.state.s_wp)?n.p:null)?(this.doCONOK_BindWS_Polling(t,e,i,s),this.notifyStatus("CONNECTED:WS-POLLING"),this.state.s_wp.p=611,this.state.traceState()):613==(null!=(n=this.state.s_wp)?n.p:null)?(this.doCONOK_BindWS_Polling(t,e,i,s),this.state.s_wp.p=611,this.state.traceState()):800==(null!=(n=this.state.s_hs)?n.m:null)||801==(null!=(n=this.state.s_hs)?n.m:null)?(this.doCONOK_BindHTTP_Streaming(t,e,i,s),this.notifyStatus("CONNECTED:HTTP-STREAMING"),this.state.s_hs.m=802,this.state.s_hs.p=810,this.state.s_hs.k=820,this.state.s_rhb=320,this.state.s_slw=330,this.state.traceState(),this.cancel_evtTransportTimeout(),this.schedule_evtKeepaliveTimeout(Ee.sure(this.keepaliveInterval)),this.evtSelectRhb()):900==(null!=(n=this.state.s_hp)?n.m:null)?(this.doCONOK_BindHTTP_Polling(t,e,i,s),this.notifyStatus("CONNECTED:HTTP-POLLING"),this.state.s_hp.m=901,this.state.traceState()):903==(null!=(n=this.state.s_hp)?n.m:null)&&(this.doCONOK_BindHTTP_Polling(t,e,i,s),this.state.s_hp.m=901,this.state.traceState())}},evtSERVNAME:function(t){this.traceEvent("SERVNAME"),Ns.isDebugEnabled()&&Ns.debug("SERVNAME "+t),this.state.inPushing()&&(this.doSERVNAME(t),this.state.inStreaming()&&this.evtRestartKeepalive())},evtCLIENTIP:function(t){this.traceEvent("CLIENTIP"),Ns.isDebugEnabled()&&Ns.debug("CLIENTIP "+t),this.state.inPushing()&&(this.doCLIENTIP(t),this.state.inStreaming()&&this.evtRestartKeepalive())},evtCONS:function(t){this.traceEvent("CONS"),Ns.isDebugEnabled()&&Ns.debug("CONS "+m.string(t)),this.state.inPushing()&&(this.doCONS(t),this.state.inStreaming()&&this.evtRestartKeepalive())},evtPROBE:function(){this.traceEvent("PROBE"),Ns.isDebugEnabled()&&Ns.debug("PROBE"),this.clientEventDispatcher.onServerKeepalive(),this.state.inPushing()&&this.state.inStreaming()&&this.evtRestartKeepalive()},evtNOOP:function(){this.traceEvent("NOOP"),this.state.inPushing()&&this.state.inStreaming()&&this.evtRestartKeepalive()},evtSYNC:function(t){this.traceEvent("SYNC"),Ns.isDebugEnabled()&&Ns.debug("SYNC "+t);var e,i,s=!0;(i=300==(null!=(e=this.state.s_w)?e.p:null)||510==(null!=(e=this.state.s_ws)?e.p:null),!i&&810!=(null!=(i=this.state.s_hs)?i.p:null))?(!!(i=220==this.state.s_tr||230==this.state.s_tr||611==(null!=(e=this.state.s_wp)?e.p:null))||901==(null!=(i=this.state.s_hp)?i.m:null)||1001==this.state.s_rec)&&(s=this.evtSYNC_PushingRegion(t)):(s=this.evtSYNC_PushingRegion(t),this.evtRestartKeepalive());s&&this.evtSYNC_PushingRegion(t)},evtSYNC_PushingRegion:function(t){var e=1e3*t;if(null!=this.state.s_slw){var i=this.state.s_slw;if(null!=i)switch(i){case 330:this.doSYNC(e),this.state.s_slw=331,this.state.traceState();break;case 331:var s=this.doSYNC_G(e);this.state.s_slw=332,this.state.traceState(),this.evtCheckAvg(s);break;case 333:s=this.doSYNC_NG(e),this.state.s_slw=332,this.state.traceState(),this.evtCheckAvg(s)}}return!1},evtMSGDONE:function(t,e,i){this.traceEvent("MSGDONE"),Ns.isDebugEnabled()&&Ns.debug("MSGDONE "+t+" "+e+" "+i),this.state.inPushing()&&(this.isFreshData()?(this.doMSGDONE(t,e,i),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtMSGFAIL:function(t,e,i,s){this.traceEvent("MSGFAIL"),Ns.isDebugEnabled()&&Ns.debug("MSGFAIL "+t+" "+e+" "+i+" "+s),this.state.inPushing()&&(this.isFreshData()?(this.doMSGFAIL(t,e,i,s),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtU:function(t,e,i,s){this.traceEvent("U"),Ns.isDebugEnabled()&&Ns.debug(""+s),this.state.inPushing()&&(this.isFreshData()?(this.doU(t,e,i),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtSUBOK:function(t,e,i){this.traceEvent("SUBOK"),Ns.isDebugEnabled()&&Ns.debug("SUBOK "+t+" "+e+" "+i),this.state.inPushing()&&(this.isFreshData()?(this.doSUBOK(t,e,i),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtSUBCMD:function(t,e,i,s,n){this.traceEvent("SUBCMD"),Ns.isDebugEnabled()&&Ns.debug("SUBCMD "+t+" "+e+" "+i+" "+s+" "+n),this.state.inPushing()&&(this.isFreshData()?(this.doSUBCMD(t,e,i,s,n),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtUNSUB:function(t){this.traceEvent("UNSUB"),Ns.isDebugEnabled()&&Ns.debug("UNSUB "+t),this.state.inPushing()&&(this.isFreshData()?(this.doUNSUB(t),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtEOS:function(t,e){this.traceEvent("EOS"),Ns.isDebugEnabled()&&Ns.debug("EOS "+t+" "+e),this.state.inPushing()&&(this.isFreshData()?(this.doEOS(t,e),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtCS:function(t,e){this.traceEvent("CS"),Ns.isDebugEnabled()&&Ns.debug("CS "+t+" "+e),this.state.inPushing()&&(this.isFreshData()?(this.doCS(t,e),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtOV:function(t,e,i){this.traceEvent("OV"),Ns.isDebugEnabled()&&Ns.debug("OV "+t+" "+e+" "+i),this.state.inPushing()&&(this.isFreshData()?(this.doOV(t,e,i),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtCONF:function(t,e){this.traceEvent("CONF"),Ns.isDebugEnabled()&&Ns.debug("CONF "+t+" "+m.string(e)),this.state.inPushing()&&(this.isFreshData()?(this.doCONF(t,e),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtCheckAvg:function(t){if(this.traceEvent("check.avg"),332==this.state.s_slw)switch(t._hx_index){case 0:this.state.s_slw=331,this.state.traceState();break;case 1:this.state.s_slw=333,this.state.traceState();break;case 2:this.disableStreaming(),this.cause="slow",this.state.s_slw=334,this.state.traceState(),this.evtForcePolling()}},evtSendPendingControls:function(){this.traceEvent("send.pending.controls");var t,e=this.getPendingControls();340!=(null!=(t=this.state.s_w)?t.s:null)||p.empty(e)?550!=(null!=(t=this.state.s_ws)?t.s:null)||p.empty(e)?630!=(null!=(t=this.state.s_wp)?t.s:null)||p.empty(e)||(this.sendPengingControlsWS(e),this.state.s_wp.s=630,this.state.traceState()):(this.sendPengingControlsWS(e),this.state.s_ws.s=550,this.state.traceState(),this.evtRestartHeartbeat()):(this.sendPengingControlsWS(e),this.state.s_w.s=340,this.state.traceState(),this.evtRestartHeartbeat())},evtSendPendingMessages:function(){var t;this.traceEvent("send.pending.messages"),340==(null!=(t=this.state.s_w)?t.s:null)&&p.exists(this.messageManagers,(function(t){return t.isPending()}))?(this.sendPendingMessagesWS(),this.state.s_w.s=340,this.state.traceState(),this.genAckMessagesWS(),this.evtRestartHeartbeat()):550==(null!=(t=this.state.s_ws)?t.s:null)&&p.exists(this.messageManagers,(function(t){return t.isPending()}))?(this.sendPendingMessagesWS(),this.state.s_ws.s=550,this.state.traceState(),this.genAckMessagesWS(),this.evtRestartHeartbeat()):630==(null!=(t=this.state.s_wp)?t.s:null)&&p.exists(this.messageManagers,(function(t){return t.isPending()}))&&(this.sendPendingMessagesWS(),this.state.s_wp.s=630,this.state.traceState(),this.genAckMessagesWS())},evtSelectRhb:function(){this.traceEvent("select.rhb"),320==this.state.s_rhb&&(0==this.rhb_grantedInterval?0==this.options.reverseHeartbeatInterval?(this.state.s_rhb=321,this.state.traceState()):(this.rhb_currentInterval=this.options.reverseHeartbeatInterval,this.state.s_rhb=322,this.state.traceState(),this.schedule_evtRhbTimeout(this.rhb_currentInterval)):this.options.reverseHeartbeatInterval>0&&this.options.reverseHeartbeatInterval<Ee.sure(this.rhb_grantedInterval)?(this.rhb_currentInterval=this.options.reverseHeartbeatInterval,this.state.s_rhb=323,this.state.traceState(),this.schedule_evtRhbTimeout(this.rhb_currentInterval)):(this.rhb_currentInterval=this.rhb_grantedInterval,this.state.s_rhb=323,this.state.traceState(),this.schedule_evtRhbTimeout(Ee.sure(this.rhb_currentInterval))))},evtExtSetReverseHeartbeatInterval:function(){if(this.traceEvent("setReverseHeartbeatInterval"),null!=this.state.s_rhb){var t=this.state.s_rhb;if(null!=t)switch(t){case 321:0!=this.options.reverseHeartbeatInterval&&(this.rhb_currentInterval=this.options.reverseHeartbeatInterval,this.state.s_rhb=322,this.state.traceState(),this.schedule_evtRhbTimeout(this.rhb_currentInterval));break;case 322:0==this.options.reverseHeartbeatInterval?(this.state.s_rhb=321,this.state.traceState(),this.cancel_evtRhbTimeout()):(this.rhb_currentInterval=this.options.reverseHeartbeatInterval,this.state.s_rhb=322,this.state.traceState());break;case 323:this.options.reverseHeartbeatInterval>0&&this.options.reverseHeartbeatInterval<Ee.sure(this.rhb_grantedInterval)?(this.rhb_currentInterval=this.options.reverseHeartbeatInterval,this.state.s_rhb=323,this.state.traceState()):(this.rhb_currentInterval=this.rhb_grantedInterval,this.state.s_rhb=323,this.state.traceState())}}},evtRestartHeartbeat:function(){if(this.traceEvent("restart.heartbeat"),null!=this.state.s_rhb){var t=this.state.s_rhb;if(null!=t)switch(t){case 322:this.state.s_rhb=322,this.state.traceState(),this.cancel_evtRhbTimeout(),this.schedule_evtRhbTimeout(Ee.sure(this.rhb_currentInterval));break;case 323:this.state.s_rhb=323,this.state.traceState(),this.cancel_evtRhbTimeout(),this.schedule_evtRhbTimeout(Ee.sure(this.rhb_currentInterval));break;case 324:0==this.rhb_grantedInterval?0!=this.options.reverseHeartbeatInterval?(this.rhb_currentInterval=this.options.reverseHeartbeatInterval,this.state.s_rhb=322,this.state.traceState(),this.schedule_evtRhbTimeout(this.rhb_currentInterval)):(this.state.s_rhb=321,this.state.traceState()):this.options.reverseHeartbeatInterval>0&&this.options.reverseHeartbeatInterval<Ee.sure(this.rhb_grantedInterval)?(this.rhb_currentInterval=this.options.reverseHeartbeatInterval,this.state.s_rhb=323,this.state.traceState(),this.schedule_evtRhbTimeout(this.rhb_currentInterval)):(this.rhb_currentInterval=this.rhb_grantedInterval,this.state.s_rhb=323,this.state.traceState(),this.schedule_evtRhbTimeout(Ee.sure(this.rhb_currentInterval)))}}},evtRhbTimeout:function(){this.traceEvent("rhb.timeout"),(322==this.state.s_rhb||323==this.state.s_rhb)&&(this.state.s_rhb=324,this.state.traceState(),this.cancel_evtRhbTimeout(),this.evtSendHeartbeat())},evtDisposeCtrl:function(){this.traceEvent("du:dispose.ctrl"),this.disposeCtrl()},evtStartRecovery:function(){this.traceEvent("start.recovery"),1e3==this.state.s_rec&&(this.recoverTs=d.now()/1e3,this.state.s_rec=1e3,this.state.traceState())},evtRecoveryTimeout:function(){this.traceEvent("recovery.timeout"),1e3==this.state.s_rec&&(this.sendRecovery(),this.state.s_rec=1001,this.state.traceState(),this.cancel_evtRecoveryTimeout(),this.schedule_evtTransportTimeout(this.options.retryDelay))},evtCheckRecoveryTimeout:function(t){if(this.traceEvent("check.recovery.timeout"),1002==this.state.s_rec){var e=this.options.retryDelay;if(We.plus(this.connectTs,e)<We.plus(this.recoverTs,this.options.sessionRecoveryTimeout)){this.cause="recovery.error";var i=We.minus(d.now()/1e3,this.connectTs),s=e>Ue.toMillis(i)?Ye.minus(e,Ue.toMillis(i)):Ye.ZERO;this.state.s_rec=1003,this.state.traceState(),Os.isErrorEnabled()&&(s>0?Os.isErrorEnabled()&&Os.error("Retrying recovery in "+s+"ms. Cause: "+m.string(t)):Os.isErrorEnabled()&&Os.error("Retrying recovery. Cause: "+m.string(t))),this.schedule_evtRetryTimeout(s)}else this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="recovery.timeout",this.state.goto_m_from_rec(113),this.exit_rec_to_m(),this.entry_m113(F.recovery_timeout)}},evtCreate:function(){this.traceEvent("du:create"),(20==this.state.s_du||23==this.state.s_du)&&(this.state.s_du=21,this.state.traceState())},evtCheckTransport:function(){if(this.traceEvent("check.transport"),1300==this.state.s_swt)if(220==this.state.s_tr||230==this.state.s_tr||260==this.state.s_tr)this.state.s_swt=1301,this.state.traceState();else{var t=this.getBestForBinding();t==P.BFB_ws_streaming&&(210==this.state.s_tr||240==this.state.s_tr)||t==P.BFB_http_streaming&&270==this.state.s_tr&&710==this.state.s_h||t==P.BFB_ws_polling&&250==this.state.s_tr||t==P.BFB_http_polling&&270==this.state.s_tr&&720==this.state.s_h?(this.state.s_swt=1301,this.state.traceState()):(this.state.s_swt=1302,this.state.traceState(),this.evtSendControl(Ee.sure(this.switchRequest)))}},evtCheckBW:function(){this.traceEvent("check.bw"),1200==this.state.s_bw&&(this.bw_requestedMaxBandwidth!=this.options.requestedMaxBandwidth&&this.options.realMaxBandwidth!=ii.BWUnmanaged?(this.bw_requestedMaxBandwidth=this.options.requestedMaxBandwidth,this.state.s_bw=1202,this.state.traceState(),this.evtSendControl(Ee.sure(this.constrainRequest))):(this.state.s_bw=1201,this.state.traceState()))},evtCheckCtrlRequests:function(){if(this.traceEvent("check.ctrl.requests"),1100==this.state.s_ctrl){var t=this.getPendingControls();p.empty(t)?p.exists(this.messageManagers,(function(t){return t.isPending()}))?(this.sendPendingMessagesHTTP(),this.state.s_ctrl=1102,this.state.traceState(),this.evtRestartHeartbeat(),this.schedule_evtCtrlTimeout(this.options.retryDelay)):324==this.state.s_rhb?(this.sendHeartbeatHTTP(),this.state.s_ctrl=1102,this.state.traceState(),this.evtRestartHeartbeat(),this.schedule_evtCtrlTimeout(this.options.retryDelay)):(this.state.s_ctrl=1101,this.state.traceState()):(this.sendPendingControlsHTTP(t),this.state.s_ctrl=1102,this.state.traceState(),this.evtRestartHeartbeat(),this.schedule_evtCtrlTimeout(this.options.retryDelay))}},evtCtrlDone:function(){this.traceEvent("ctrl.done"),1102==this.state.s_ctrl&&(this.closeCtrl(),this.state.s_ctrl=1100,this.state.traceState(),this.cancel_evtCtrlTimeout(),this.evtCheckCtrlRequests())},evtCtrlError:function(){if(this.traceEvent("ctrl.error"),1102==this.state.s_ctrl){this.disposeCtrl();var t=this.waitingInterval(this.options.retryDelay,this.ctrl_connectTs);this.state.s_ctrl=1103,this.state.traceState(),this.cancel_evtCtrlTimeout(),this.schedule_evtCtrlTimeout(t)}},evtCtrlTimeout:function(){if(this.traceEvent("ctrl.timeout"),null!=this.state.s_ctrl)if(1102==this.state.s_ctrl){this.disposeCtrl();var t=this.waitingInterval(this.options.retryDelay,this.ctrl_connectTs);this.state.s_ctrl=1103,this.state.traceState(),this.cancel_evtCtrlTimeout(),this.schedule_evtCtrlTimeout(t)}else 1103==this.state.s_ctrl&&(this.state.s_ctrl=1100,this.state.traceState(),this.cancel_evtCtrlTimeout(),this.evtCheckCtrlRequests())},evtSendControl:function(t){var e;this.traceEvent("send.control"),340==(null!=(e=this.state.s_w)?e.s:null)?(this.sendControlWS(t),this.state.s_w.s=340,this.state.traceState(),this.evtRestartHeartbeat()):550==(null!=(e=this.state.s_ws)?e.s:null)?(this.sendControlWS(t),this.state.s_ws.s=550,this.state.traceState(),this.evtRestartHeartbeat()):630==(null!=(e=this.state.s_wp)?e.s:null)?(this.sendControlWS(t),this.state.s_wp.s=630,this.state.traceState()):1101==this.state.s_ctrl&&(this.state.s_ctrl=1100,this.state.traceState(),this.evtCheckCtrlRequests())},evtSendHeartbeat:function(){var t;this.traceEvent("send.heartbeat"),340==(null!=(t=this.state.s_w)?t.s:null)?(this.sendHeartbeatWS(),this.state.s_w.s=340,this.state.traceState(),this.evtRestartHeartbeat()):550==(null!=(t=this.state.s_ws)?t.s:null)?(this.sendHeartbeatWS(),this.state.s_ws.s=550,this.state.traceState(),this.evtRestartHeartbeat()):1101==this.state.s_ctrl&&(this.state.s_ctrl=1100,this.state.traceState(),this.evtCheckCtrlRequests())},evtStartSession:function(){this.traceEvent("du:start.session"),Os.isInfoEnabled()&&Os.info("Starting new session: "+this.sessionId),21==this.state.s_du&&(this.state.s_du=22,this.state.traceState())},evtEndSession:function(){Os.isInfoEnabled()&&Os.info("Destroying session: "+this.sessionId)},evtRetry:function(t,e){this.traceEvent("du:retry"),Os.isErrorEnabled()&&(null!=e&&e>0?Os.isErrorEnabled()&&Os.error("Retrying connection in "+e+"ms. Cause: "+B(t)):Os.isErrorEnabled()&&Os.error("Retrying connection. Cause: "+B(t)));var i=!0;switch(this.state.s_du){case 21:this.resetSequenceMap(),this.state.s_du=23,this.state.traceState(),i=this.evtRetry_NextRegion(),this.genAbortMessages();break;case 22:this.disposeSession(),this.state.s_du=23,this.state.traceState(),i=this.evtRetry_NextRegion(),this.genAbortSubscriptions(),this.genAbortMessages()}i&&(i=this.evtRetry_NextRegion())},evtRetry_NextRegion:function(){return!1},evtTerminate:function(t){if(this.traceEvent("du:terminate"),Os.isInfoEnabled()&&2==t._hx_index&&Os.isInfoEnabled()&&Os.info("Disconnected. Cause: Requested by user"),Os.isErrorEnabled())switch(t._hx_index){case 0:Os.isErrorEnabled()&&Os.error("Disconnected. Cause: "+t.code+" - "+t.msg);break;case 1:Os.isErrorEnabled()&&Os.error("Disconnected. Cause: "+t.error)}var e=!0;switch(this.state.s_du){case 20:case 21:case 23:this.disposeClient(),this.state.s_du=20,this.state.traceState(),e=this.evtTerminate_NextRegion(),this.genAbortMessages();break;case 22:this.disposeSession(),this.disposeClient(),this.state.s_du=20,this.state.traceState(),e=this.evtTerminate_NextRegion(),this.genAbortSubscriptions(),this.genAbortMessages()}e&&(e=this.evtTerminate_NextRegion())},evtTerminate_NextRegion:function(){return this.evtTerminate_NetworkReachabilityRegion()},evtTerminate_NetworkReachabilityRegion:function(){switch(this.state.s_nr){case 1410:case 1411:case 1412:var t=this.nr_reachabilityManager;this.nr_reachabilityManager=null,this.state.s_nr=1400,this.state.traceState(),null!=t&&t.stopListening()}return!1},evtRetryTimeout:function(){switch(this.traceEvent("retry.timeout"),this.state.s_m){case 110:this.notifyStatus("CONNECTING"),this.sendCreateTTL(),this.state.s_m=140,this.state.traceState(),this.evtCreate(),this.schedule_evtTransportTimeout(6e4);break;case 111:this.notifyStatus("CONNECTING"),this.delayCounter.increase(),this.sendCreateTTL(),this.state.s_m=140,this.state.traceState(),this.cancel_evtRetryTimeout(),this.evtCreate(),this.schedule_evtTransportTimeout(6e4);break;case 112:this.delayCounter.increase(),this.state.s_m=116,this.state.traceState(),this.cancel_evtRetryTimeout(),this.evtSelectCreate();break;case 113:this.state.s_m=116,this.state.traceState(),this.cancel_evtRetryTimeout(),this.evtSelectCreate();break;case 115:this.state.s_m=116,this.state.traceState(),this.evtSelectCreate();break;case 150:1003==this.state.s_rec&&(this.sendRecovery(),this.state.s_rec=1001,this.state.traceState(),this.cancel_evtRetryTimeout(),this.schedule_evtTransportTimeout(this.options.retryDelay))}},evtExtSetForcedTransport:function(){this.traceEvent("setForcedTransport"),1301==this.state.s_swt&&(this.state.s_swt=1300,this.state.traceState(),this.evtCheckTransport())},evtExtSetRequestedMaxBandwidth:function(){this.traceEvent("setRequestedMaxBandwidth"),1201==this.state.s_bw&&(this.state.s_bw=1200,this.state.traceState(),this.evtCheckBW())},evtForceSlowing:function(){this.traceEvent("force.slowing"),1301==this.state.s_swt&&(this.state.s_swt=1300,this.state.traceState(),this.evtCheckTransport())},evtForcePolling:function(){this.traceEvent("force.polling"),1301==this.state.s_swt&&(this.state.s_swt=1300,this.state.traceState(),this.evtCheckTransport())},evtSendMessage:function(t){var e;this.traceEvent("send.message"),340==(null!=(e=this.state.s_w)?e.s:null)?(this.sendMsgWS(t),this.state.s_w.s=340,this.state.traceState(),t.evtWSSent(),this.evtRestartHeartbeat()):550==(null!=(e=this.state.s_ws)?e.s:null)?(this.sendMsgWS(t),this.state.s_ws.s=550,this.state.traceState(),t.evtWSSent(),this.evtRestartHeartbeat()):630==(null!=(e=this.state.s_wp)?e.s:null)?(this.sendMsgWS(t),this.state.s_wp.s=630,this.state.traceState(),t.evtWSSent()):1101==this.state.s_ctrl&&(this.state.s_ctrl=1100,this.state.traceState(),this.evtCheckCtrlRequests())},evtSwitchTransport:function(){this.traceEvent("switch.transport");var t=!0;1302!=this.state.s_swt&&1303!=this.state.s_swt||(this.state.s_swt=1300,this.state.traceState(),t=this.evtSwitchTransport_forwardToTransportRegion(),this.evtCheckTransport()),t&&(t=this.evtSwitchTransport_forwardToTransportRegion())},evtSwitchTransport_forwardToTransportRegion:function(){var t,e=A.TC_otherError("Selected transport "+this.options.forcedTransport+" is not available");if(200==this.state.s_tr)switch(this.getBestForBinding()._hx_index){case 0:this.notifyStatus("DISCONNECTED"),this.state.goto_m_from_session(100),this.evtEndSession(),this.evtTerminate(e);break;case 1:this.openWS_Bind(),this.state.s_tr=240,this.state.s_ws=new Y(500),this.state.traceState(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 2:this.openWS_Bind(),this.state.s_tr=250,this.state.s_wp=new G(600),this.state.traceState(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 3:this.sendBindHTTP_Streaming(),this.state.s_tr=270,this.state.s_h=710,this.state.s_hs=new K(800),this.state.s_ctrl=1100,this.state.traceState(),this.evtCheckCtrlRequests(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 4:this.sendBindHTTP_Polling(),this.state.s_tr=270,this.state.s_h=720,this.state.s_hp=new z(900),this.state.s_rhb=320,this.state.s_ctrl=1100,this.state.traceState(),this.evtCheckCtrlRequests(),this.schedule_evtIdleTimeout(Ye.plus(Ee.sure(this.idleTimeout),this.options.retryDelay)),this.evtSelectRhb()}else if(811==(null!=(t=this.state.s_hs)?t.p:null))switch(this.getBestForBinding()._hx_index){case 0:this.notifyStatus("DISCONNECTED"),this.state.goto_m_from_hs(100),this.exit_hs_to_m(),this.evtTerminate(e);break;case 1:this.openWS_Bind(),this.state.clear_hs(),this.state.s_h=null,this.state.s_ctrl=null,this.state.s_tr=240,this.state.s_ws=new Y(500),this.state.traceState(),this.exit_hs(),this.exit_ctrl(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 2:this.openWS_Bind(),this.state.clear_hs(),this.state.s_h=null,this.state.s_ctrl=null,this.state.s_tr=250,this.state.s_wp=new G(600),this.state.traceState(),this.exit_hs(),this.exit_ctrl(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 3:this.sendBindHTTP_Streaming(),this.state.s_hs=new K(800),this.state.traceState(),this.exit_hs(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 4:this.sendBindHTTP_Polling(),this.state.clear_hs(),this.state.s_h=720,this.state.s_hp=new z(900),this.state.s_rhb=320,this.state.traceState(),this.exit_hs(),this.schedule_evtIdleTimeout(Ye.plus(Ee.sure(this.idleTimeout),this.options.retryDelay)),this.evtSelectRhb()}else if(904==(null!=(t=this.state.s_hp)?t.m:null))switch(this.getBestForBinding()._hx_index){case 0:this.notifyStatus("DISCONNECTED"),this.state.goto_m_from_hp(100),this.exit_hp_to_m(),this.evtTerminate(e);break;case 1:this.openWS_Bind(),this.state.clear_hp(),this.state.s_h=null,this.state.s_ctrl=null,this.state.s_tr=240,this.state.s_ws=new Y(500),this.state.traceState(),this.exit_hp(),this.exit_ctrl(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 2:this.openWS_Bind(),this.state.clear_hp(),this.state.s_h=null,this.state.s_ctrl=null,this.state.s_tr=250,this.state.s_wp=new G(600),this.state.traceState(),this.exit_hp(),this.exit_ctrl(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 3:this.sendBindHTTP_Streaming(),this.state.clear_hp(),this.state.s_h=710,this.state.s_hs=new K(800),this.state.traceState(),this.exit_hp(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 4:this.sendBindHTTP_Polling(),this.state.s_hp=new z(900),this.state.s_rhb=320,this.state.traceState(),this.exit_hp(),this.schedule_evtIdleTimeout(Ye.plus(Ee.sure(this.idleTimeout),this.options.retryDelay)),this.evtSelectRhb()}return!1},onFreshData:function(){if(this.rec_serverProg!=this.rec_clientProg)throw new be("Assertion failure: rec_serverProg == rec_clientProg");this.rec_serverProg+=1,this.rec_clientProg+=1},onStaleData:function(){if(this.rec_serverProg>=this.rec_clientProg)throw new be("Assertion failure: rec_serverProg < rec_clientProg");this.rec_serverProg+=1},isFreshData:function(){return this.rec_serverProg==this.rec_clientProg},openWS:function(t,e){var i=this,s=function(t){Ls.submit(es.a((function(){Ie.synchronized(i.lock,(function(){t.isDisposed()||i.evtWSOpen()}))})))},n=function(t,e){Ls.submit(es.a((function(){Ie.synchronized(i.lock,(function(){if(!t.isDisposed())try{i.evtMessage(e)}catch(t){var s=w.caught(t);Os.isErrorEnabled()&&Os.error(s.get_message()+"\n"+s.details()),i.evtExtDisconnect(A.TC_standardError(61,s.get_message()))}}))})))},r=function(t,e){Ls.submit(es.a((function(){Ie.synchronized(i.lock,(function(){t.isDisposed()||i.evtTransportError()}))})))};return this.wsFactory(t,e,s,n,r)},openWS_Create:function(){this.connectTs=d.now()/1e3,this.serverInstanceAddress=this.getServerAddress(),this.ws=this.openWS(ui.build(this.serverInstanceAddress,"lightstreamer"),this.options.httpExtraHeaders)},openWS_Bind:function(){this.connectTs=d.now()/1e3,this.ws=this.openWS(ui.build(Ee.sure(this.serverInstanceAddress),"lightstreamer"),this.getHeadersForRequestOtherThanCreate())},sendCreateWS:function(){var t=new Me;this.options.keepaliveInterval>0&&t.LS_keepalive_millis(this.options.keepaliveInterval),this.rhb_grantedInterval=this.options.reverseHeartbeatInterval,this.rhb_grantedInterval>0&&t.LS_inactivity_millis(this.rhb_grantedInterval),this.bw_requestedMaxBandwidth=this.options.requestedMaxBandwidth;var e=this.bw_requestedMaxBandwidth;null!=e&&0==e._hx_index&&t.LS_requested_max_bandwidth_Float(e.bw),null!=this.details.adapterSet&&t.LS_adapter_set(this.details.adapterSet),null!=this.details.user&&t.LS_user(this.details.user),t.LS_cid(Ss),null!=this.sessionId&&t.LS_old_session(this.sessionId),this.options.slowingEnabled||t.LS_send_sync(!1),null!=this.cause&&(t.LS_cause(this.cause),this.cause=null),Ns.isInfoEnabled()&&Ns.info("Sending session create: "+m.string(t)),null!=this.details.password&&t.LS_password(this.details.password),Ee.sure(this.ws).send("wsok"),Ee.sure(this.ws).send("create_session\r\n"+t.getEncodedString())},sendBindWS_Streaming:function(){var t=new Me;t.LS_session(Ee.sure(this.sessionId)),this.options.keepaliveInterval>0&&t.LS_keepalive_millis(this.options.keepaliveInterval),this.rhb_grantedInterval=this.options.reverseHeartbeatInterval,this.rhb_grantedInterval>0&&t.LS_inactivity_millis(this.rhb_grantedInterval),this.options.slowingEnabled||t.LS_send_sync(!1),null!=this.cause&&(t.LS_cause(this.cause),this.cause=null),Ns.isInfoEnabled()&&Ns.info("Sending session bind: "+m.string(t)),Ee.sure(this.ws).send("wsok"),Ee.sure(this.ws).send("bind_session\r\n"+t.getEncodedString())},sendBindWS_FirstPolling:function(){var t=new Me;t.LS_session(Ee.sure(this.sessionId)),t.LS_polling(!0),t.LS_polling_millis(this.options.pollingInterval),this.idleTimeout=this.options.idleTimeout,t.LS_idle_millis(this.idleTimeout),null!=this.cause&&(t.LS_cause(this.cause),this.cause=null),Ns.isInfoEnabled()&&Ns.info("Sending session bind: "+m.string(t)),Ee.sure(this.ws).send("bind_session\r\n"+t.getEncodedString())},sendBindWS_Polling:function(){var t=new Me;t.LS_polling(!0),t.LS_polling_millis(this.options.pollingInterval),this.idleTimeout=this.options.idleTimeout,t.LS_idle_millis(this.idleTimeout),null!=this.cause&&(t.LS_cause(this.cause),this.cause=null),Ns.isInfoEnabled()&&Ns.info("Sending session bind: "+m.string(t)),Ee.sure(this.ws).send("bind_session\r\n"+t.getEncodedString())},sendDestroyWS:function(){var t=new Me;t.LS_reqId(this.generateFreshReqId()),t.LS_op("destroy"),t.LS_close_socket(!0),t.LS_cause("api"),Ns.isInfoEnabled()&&Ns.info("Sending session destroy: "+m.string(t)),Ee.sure(this.ws).send("control\r\n"+t.getEncodedString())},sendHttpRequest:function(t,e,i){var s=this,n=function(t,e){Ls.submit(es.a((function(){Ie.synchronized(s.lock,(function(){if(!t.isDisposed())try{s.evtMessage(e)}catch(t){var i=w.caught(t);Os.isErrorEnabled()&&Os.error(i.get_message()+"\n"+i.details()),s.evtExtDisconnect(A.TC_standardError(61,i.get_message()))}}))})))},r=function(t,e){Ls.submit(es.a((function(){Ie.synchronized(s.lock,(function(){t.isDisposed()||s.evtTransportError()}))})))};return this.httpFactory(t,e.getEncodedString(),i,n,r,(function(t){}))},sendCreateHTTP:function(){var t=new Me;t.LS_polling(!0),t.LS_polling_millis(0),t.LS_idle_millis(0),this.bw_requestedMaxBandwidth=this.options.requestedMaxBandwidth;var e=this.bw_requestedMaxBandwidth;null!=e&&0==e._hx_index&&t.LS_requested_max_bandwidth_Float(e.bw),null!=this.details.adapterSet&&t.LS_adapter_set(this.details.adapterSet),null!=this.details.user&&t.LS_user(this.details.user),t.LS_cid(Ss),null!=this.sessionId&&t.LS_old_session(this.sessionId),null!=this.cause&&(t.LS_cause(this.cause),this.cause=null),Ns.isInfoEnabled()&&Ns.info("Sending session create: "+m.string(t)),null!=this.details.password&&t.LS_password(this.details.password),this.connectTs=d.now()/1e3,this.serverInstanceAddress=this.getServerAddress(),this.http=this.sendHttpRequest(ui.build(this.serverInstanceAddress,"/lightstreamer"+ys+"/create_session.txt?LS_protocol="+ms),t,this.options.httpExtraHeaders)},sendBindHTTP_Streaming:function(){var t=new Me;t.LS_session(Ee.sure(this.sessionId)),t.LS_content_length(this.options.contentLength),this.options.keepaliveInterval>0&&t.LS_keepalive_millis(this.options.keepaliveInterval),this.rhb_grantedInterval=this.options.reverseHeartbeatInterval,this.rhb_grantedInterval>0&&t.LS_inactivity_millis(this.rhb_grantedInterval),this.options.slowingEnabled||t.LS_send_sync(!1),null!=this.cause&&(t.LS_cause(this.cause),this.cause=null),Ns.isInfoEnabled()&&Ns.info("Sending session bind: "+m.string(t)),this.connectTs=d.now()/1e3,this.http=this.sendHttpRequest(ui.build(Ee.sure(this.serverInstanceAddress),"/lightstreamer/bind_session.txt?LS_protocol="+ms),t,this.getHeadersForRequestOtherThanCreate())},sendBindHTTP_Polling:function(){var t=new Me;t.LS_session(Ee.sure(this.sessionId)),t.LS_polling(!0),t.LS_polling_millis(this.options.pollingInterval),this.idleTimeout=this.options.idleTimeout,t.LS_idle_millis(this.idleTimeout),null!=this.cause&&(t.LS_cause(this.cause),this.cause=null),this.rhb_grantedInterval=0,Ns.isInfoEnabled()&&Ns.info("Sending session bind: "+m.string(t)),this.connectTs=d.now()/1e3,this.http=this.sendHttpRequest(ui.build(Ee.sure(this.serverInstanceAddress),"/lightstreamer/bind_session.txt?LS_protocol="+ms),t,this.getHeadersForRequestOtherThanCreate())},sendCreateTTL:function(){var t=new Me;t.LS_ttl_millis("unlimited"),t.LS_polling(!0),t.LS_polling_millis(0),t.LS_idle_millis(0),this.bw_requestedMaxBandwidth=this.options.requestedMaxBandwidth;var e=this.bw_requestedMaxBandwidth;null!=e&&0==e._hx_index&&t.LS_requested_max_bandwidth_Float(e.bw),null!=this.details.adapterSet&&t.LS_adapter_set(this.details.adapterSet),null!=this.details.user&&t.LS_user(this.details.user),t.LS_cid(Ss),null!=this.sessionId&&t.LS_old_session(this.sessionId),null!=this.cause&&(t.LS_cause(this.cause),this.cause=null),Ns.isInfoEnabled()&&Ns.info("Sending session create: "+m.string(t)),null!=this.details.password&&t.LS_password(this.details.password),this.connectTs=d.now()/1e3,this.serverInstanceAddress=this.getServerAddress(),this.http=this.sendHttpRequest(ui.build(this.serverInstanceAddress,"/lightstreamer"+ys+"/create_session.txt?LS_protocol="+ms),t,this.options.httpExtraHeaders)},sendRecovery:function(){var t=new Me;t.LS_session(Ee.sure(this.sessionId)),t.LS_recovery_from(this.rec_clientProg),t.LS_polling(!0),t.LS_polling_millis(0),t.LS_idle_millis(0),null!=this.cause&&(t.LS_cause(this.cause),this.cause=null),Ns.isInfoEnabled()&&Ns.info("Sending session recovery: "+m.string(t)),this.connectTs=d.now()/1e3,this.http=this.sendHttpRequest(ui.build(Ee.sure(this.serverInstanceAddress),"/lightstreamer/bind_session.txt?LS_protocol="+ms),t,this.getHeadersForRequestOtherThanCreate())},disposeWS:function(){null!=this.ws&&(this.ws.dispose(),this.ws=null)},closeWS:function(){null!=this.ws&&(this.ws.dispose(),this.ws=null)},suspendWS_Streaming:function(){Os.isWarnEnabled()&&Os.warn("Websocket suspended"),this.suspendedTransports.insert("WS-STREAMING")},disableWS:function(){Os.isWarnEnabled()&&Os.warn("Websocket disabled"),this.disabledTransports=this.disabledTransports.union(["WS-STREAMING","WS-POLLING"])},disableHTTP_Streaming:function(){Os.isWarnEnabled()&&Os.warn("HTTP streaming disabled"),this.disabledTransports=this.disabledTransports.union(["HTTP-STREAMING"])},disableStreaming:function(){Os.isWarnEnabled()&&Os.warn("Streaming disabled"),this.disabledTransports=this.disabledTransports.union(["WS-STREAMING","HTTP-STREAMING"])},enableAllTransports:function(){Os.isInfoEnabled()&&(this.disabledTransports.count()>0||this.suspendedTransports.count()>0)&&Os.isInfoEnabled()&&Os.info("Transports enabled again."),this.disabledTransports=new Ne,this.suspendedTransports=new Ne},disposeHTTP:function(){null!=this.http&&(this.http.dispose(),this.http=null)},closeHTTP:function(){null!=this.http&&(this.http.dispose(),this.http=null)},disposeCtrl:function(){null!=this.ctrl_http&&(this.ctrl_http.dispose(),this.ctrl_http=null)},closeCtrl:function(){null!=this.ctrl_http&&(this.ctrl_http.dispose(),this.ctrl_http=null)},notifyStatus:function(t){var e=this.m_status;this.m_status=t,e!=t&&(Os.isInfoEnabled()&&Os.info("Status: "+t),this.clientEventDispatcher.onStatusChange(t))},getBestForCreating:function(){if(0==this.getBestForBinding()._hx_index)return O.BFC_none;var t=this.options.forcedTransport,e=this.suspendedTransports.union(this.disabledTransports.toArray()),i=this.options.httpExtraHeaders,s=null==i||p.empty(i);if(null==t)return s?e.contains("WS-STREAMING")?O.BFC_http:O.BFC_ws:O.BFC_http;switch(t){case"WS":case"WS-STREAMING":return s?e.contains("WS-STREAMING")?O.BFC_http:O.BFC_ws:O.BFC_http;default:return O.BFC_http}},getBestForBinding:function(){var t=this.options.forcedTransport,e=this.disabledTransports,i=this.options.httpExtraHeaders,s=null==i||p.empty(i),n=this.options.httpExtraHeadersOnSessionCreationOnly;if(null==t)return s||n?e.contains("WS-STREAMING")?e.contains("HTTP-STREAMING")?e.contains("WS-POLLING")?P.BFB_http_polling:P.BFB_ws_polling:P.BFB_http_streaming:P.BFB_ws_streaming:e.contains("HTTP-STREAMING")?P.BFB_http_polling:P.BFB_http_streaming;switch(t){case"HTTP":return e.contains("HTTP-STREAMING")?P.BFB_http_polling:P.BFB_http_streaming;case"HTTP-POLLING":return P.BFB_http_polling;case"HTTP-STREAMING":return e.contains("HTTP-STREAMING")?P.BFB_none:P.BFB_http_streaming;case"WS":return s||n?e.contains("WS-STREAMING")?e.contains("WS-POLLING")?P.BFB_none:P.BFB_ws_polling:P.BFB_ws_streaming:P.BFB_none;case"WS-POLLING":return s||n?e.contains("WS-POLLING")?P.BFB_none:P.BFB_ws_polling:P.BFB_none;case"WS-STREAMING":return s||n?e.contains("WS-STREAMING")?P.BFB_none:P.BFB_ws_streaming:P.BFB_none}},resetCurrentRetryDelay:function(){this.delayCounter.reset(this.options.retryDelay)},notifyServerErrorIfCauseIsError:function(t){switch(t._hx_index){case 0:this.clientEventDispatcher.onServerError(t.code,t.msg);break;case 1:this.clientEventDispatcher.onServerError(61,t.error)}},notifyServerError_CONERR:function(t,e){this.clientEventDispatcher.onServerError(t,e)},notifyServerError_END:function(t,e){0<t&&t<30||t>39?this.clientEventDispatcher.onServerError(39,e):this.clientEventDispatcher.onServerError(t,e)},notifyServerError_ERROR:function(t,e){this.clientEventDispatcher.onServerError(t,e)},notifyServerError_REQERR:function(t,e){11==t?this.clientEventDispatcher.onServerError(21,e):this.clientEventDispatcher.onServerError(t,e)},doCONOK:function(t,e,i,s,n){this.sessionId=t,this.details.setSessionId(t),this.requestLimit=e,null!=i?(this.keepaliveInterval=i,this.options.setKeepaliveInterval(i)):null!=s&&(this.idleTimeout=s,this.options.setIdleTimeout(s)),"*"==n||this.options.serverInstanceAddressIgnored||(n=ui.completeControlLink(n,this.getServerAddress()),this.serverInstanceAddress=n,this.details.setServerInstanceAddress(n))},doCONOK_CreateWS:function(t,e,i,s){this.doCONOK(t,e,i,null,s)},doCONOK_BindWS_Streaming:function(t,e,i,s){this.doCONOK(t,e,i,null,s)},doCONOK_BindWS_Polling:function(t,e,i,s){this.doCONOK(t,e,null,i,s)},doCONOK_CreateHTTP:function(t,e,i,s){this.doCONOK(t,e,null,null,s)},doCONOK_BindHTTP_Streaming:function(t,e,i,s){this.doCONOK(t,e,i,null,s)},doCONOK_BindHTTP_Polling:function(t,e,i,s){this.doCONOK(t,e,null,i,s)},doSERVNAME:function(t){this.details.setServerSocketName(t)},doCLIENTIP:function(t){this.details.setClientIp(t);var e=this.lastKnownClientIp;null!=e&&e!=t&&(Os.isInfoEnabled()&&Os.info("Client IP changed: "+e+" -> "+t),this.enableAllTransports()),this.lastKnownClientIp=t},doCONS:function(t){this.options.setRealMaxBandwidth(t)},doLOOP:function(t){this.options.setPollingInterval(t)},doPROG:function(t){if(t>this.rec_clientProg)throw new be("Assertion failure: prog <= rec_clientProg");this.rec_serverProg=t},doMSGDONE:function(t,e,i){this.onFreshData();var s=this.messageManagers.filter((function(i){return i.sequence==t&&i.prog==e}));if(s.length>1)throw new be("Assertion failure: messages.length <= 1");for(var n=s.h;null!=n;){var r=n.item;n=n.next,r.evtMSGDONE(i)}},doMSGFAIL:function(t,e,i,s){if(this.onFreshData(),39==i){var n=m.parseInt(s);if(null==n)throw new be("Assertion failure: count != null");for(var r=e-n+1,a=e+1;r<a;){if((l=this.messageManagers.filter(function(e){return function(i){return i.sequence==t&&i.prog==e[0]}}([r++]))).length>1)throw new be("Assertion failure: messages.length <= 1");for(var o=l.h;null!=o;){var h=o.item;o=o.next,h.evtMSGFAIL(i,s)}}}else{var l;if((l=this.messageManagers.filter((function(i){return i.sequence==t&&i.prog==e}))).length>1)throw new be("Assertion failure: messages.length <= 1");for(o=l.h;null!=o;)h=o.item,o=o.next,h.evtMSGFAIL(i,s)}},doU:function(t,e,i){this.onFreshData();var s=pe.arrayRead(this.subscriptionManagers,t);null!=s?s.evtU(e,i):new Dt(t,this).evtU(e,i)},doSUBOK:function(t,e,i){this.onFreshData();var s=pe.arrayRead(this.subscriptionManagers,t);null!=s?s.evtSUBOK(e,i):new Dt(t,this).evtSUBOK(e,i)},doSUBCMD:function(t,e,i,s,n){this.onFreshData();var r=pe.arrayRead(this.subscriptionManagers,t);null!=r?r.evtSUBCMD(e,i,s,n):new Dt(t,this).evtSUBCMD(e,i,s,n)},doUNSUB:function(t){this.onFreshData();var e=pe.arrayRead(this.subscriptionManagers,t);null!=e&&e.evtUNSUB()},doEOS:function(t,e){this.onFreshData();var i=pe.arrayRead(this.subscriptionManagers,t);null!=i?i.evtEOS(e):new Dt(t,this).evtEOS(e)},doCS:function(t,e){this.onFreshData();var i=pe.arrayRead(this.subscriptionManagers,t);null!=i?i.evtCS(e):new Dt(t,this).evtCS(e)},doOV:function(t,e,i){this.onFreshData();var s=pe.arrayRead(this.subscriptionManagers,t);null!=s?s.evtOV(e,i):new Dt(t,this).evtOV(e,i)},doCONF:function(t,e){this.onFreshData();var i=pe.arrayRead(this.subscriptionManagers,t);null!=i?i.evtCONF(e):new Dt(t,this).evtCONF(e)},doREQOK:function(t){for(var e=rs(pe)(this.subscriptionManagers);null!=e.head;){var i=e.head.item;e.head=e.head.next,i.value.evtREQOK(t)}for(var s=this.messageManagers.h;null!=s;)i=s.item,s=s.next,i.evtREQOK(t)},doREQERR:function(t,e,i){for(var s=rs(pe)(this.subscriptionManagers);null!=s.head;){var n=s.head.item;s.head=s.head.next,n.value.evtREQERR(t,e,i)}for(var r=this.messageManagers.h;null!=r;)n=r.item,r=r.next,n.evtREQERR(t,e,i)},doSYNC:function(t){this.slw_refTime=d.now()/1e3,this.slw_avgDelayMs=-t},doSYNC_G:function(t){var e=this.diffTimeSync(t);return e>this.slw_hugeDelayMs&&e>2*this.slw_avgDelayMs?this.slw_avgDelayMs>this.slw_maxAvgDelayMs&&this.options.slowingEnabled?k.SCR_bad:k.SCR_not_good:(this.slw_avgDelayMs=this.slowAvg(e),this.slw_avgDelayMs>this.slw_maxAvgDelayMs&&this.options.slowingEnabled?k.SCR_bad:(this.slw_avgDelayMs<60&&(this.slw_avgDelayMs=0),k.SCR_good))},doSYNC_NG:function(t){var e=this.diffTimeSync(t);return e>this.slw_hugeDelayMs&&e>2*this.slw_avgDelayMs?(this.slw_avgDelayMs=this.slowAvg(e),this.slw_avgDelayMs>this.slw_maxAvgDelayMs&&this.options.slowingEnabled?k.SCR_bad:(this.slw_avgDelayMs<60&&(this.slw_avgDelayMs=0),k.SCR_good)):(this.slw_avgDelayMs=this.slowAvg(e),this.slw_avgDelayMs>this.slw_maxAvgDelayMs&&this.options.slowingEnabled?k.SCR_bad:(this.slw_avgDelayMs<60&&(this.slw_avgDelayMs=0),k.SCR_not_good))},diffTimeSync:function(t){return We.minus(d.now()/1e3,this.slw_refTime)-t},slowAvg:function(t){return this.slw_avgDelayMs*this.slw_m+t*(1-this.slw_m)},schedule_evtTransportTimeout:function(t){this.transportTimer=this.createTimer("transport.timeout",t,os(this,this.evtTransportTimeout))},schedule_evtRetryTimeout:function(t){this.retryTimer=this.createTimer("retry.timeout",t,os(this,this.evtRetryTimeout))},schedule_evtRecoveryTimeout:function(t){this.recoveryTimer=this.createTimer("recovery.timeout",t,os(this,this.evtRecoveryTimeout))},schedule_evtIdleTimeout:function(t){this.idleTimer=this.createTimer("idle.timeout",t,os(this,this.evtIdleTimeout))},schedule_evtPollingTimeout:function(t){this.pollingTimer=this.createTimer("polling.timeout",t,os(this,this.evtPollingTimeout))},schedule_evtCtrlTimeout:function(t){this.ctrlTimer=this.createTimer("ctrl.timeout",t,os(this,this.evtCtrlTimeout))},schedule_evtKeepaliveTimeout:function(t){this.keepaliveTimer=this.createTimer("keepalive.timeout",t,os(this,this.evtKeepaliveTimeout))},schedule_evtStalledTimeout:function(t){this.stalledTimer=this.createTimer("stalled.timeout",t,os(this,this.evtStalledTimeout))},schedule_evtReconnectTimeout:function(t){this.reconnectTimer=this.createTimer("reconnect.timeout",t,os(this,this.evtReconnectTimeout))},schedule_evtRhbTimeout:function(t){this.rhbTimer=this.createTimer("rhb.timeout",t,os(this,this.evtRhbTimeout))},createTimer:function(t,e,i){var s=this;return this.timerFactory(t,e,(function(t){Ie.synchronized(s.lock,(function(){t.isCanceled()||i()}))}))},cancel_evtTransportTimeout:function(){null!=this.transportTimer&&(this.transportTimer.cancel(),this.transportTimer=null)},cancel_evtRetryTimeout:function(){null!=this.retryTimer&&(this.retryTimer.cancel(),this.retryTimer=null)},cancel_evtKeepaliveTimeout:function(){null!=this.keepaliveTimer&&(this.keepaliveTimer.cancel(),this.keepaliveTimer=null)},cancel_evtStalledTimeout:function(){null!=this.stalledTimer&&(this.stalledTimer.cancel(),this.stalledTimer=null)},cancel_evtReconnectTimeout:function(){null!=this.reconnectTimer&&(this.reconnectTimer.cancel(),this.reconnectTimer=null)},cancel_evtRhbTimeout:function(){null!=this.rhbTimer&&(this.rhbTimer.cancel(),this.rhbTimer=null)},cancel_evtIdleTimeout:function(){null!=this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)},cancel_evtPollingTimeout:function(){null!=this.pollingTimer&&(this.pollingTimer.cancel(),this.pollingTimer=null)},cancel_evtCtrlTimeout:function(){null!=this.ctrlTimer&&(this.ctrlTimer.cancel(),this.ctrlTimer=null)},cancel_evtRecoveryTimeout:function(){null!=this.recoveryTimer&&(this.recoveryTimer.cancel(),this.recoveryTimer=null)},waitingInterval:function(t,e){var i=We.minus(d.now()/1e3,e);return i<t?t-i:0},exit_tr:function(){this.evtEndSession()},entry_m111:function(t,e){this.evtRetry(t,e),this.schedule_evtRetryTimeout(e)},entry_m112:function(t){var e=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs);this.evtRetry(t,e),this.schedule_evtRetryTimeout(e)},entry_m113:function(t){var e=this.randomPause(this.options.firstRetryMaxDelay);this.evtRetry(t,e),this.schedule_evtRetryTimeout(e)},entry_m115:function(t){this.evtRetry(t),this.evtRetryTimeout()},entry_rec:function(t,e){Os.isErrorEnabled()&&Os.error("Recovering connection in "+t+" ms. Cause: "+B(e)),this.evtStartRecovery(),this.schedule_evtRecoveryTimeout(t)},exit_w:function(){this.cancel_evtKeepaliveTimeout(),this.cancel_evtStalledTimeout(),this.cancel_evtReconnectTimeout(),this.cancel_evtRhbTimeout()},exit_ws:function(){this.cancel_evtTransportTimeout(),this.cancel_evtKeepaliveTimeout(),this.cancel_evtStalledTimeout(),this.cancel_evtReconnectTimeout(),this.cancel_evtRhbTimeout()},exit_wp:function(){this.cancel_evtTransportTimeout(),this.cancel_evtIdleTimeout(),this.cancel_evtPollingTimeout()},exit_hs:function(){this.cancel_evtTransportTimeout(),this.cancel_evtKeepaliveTimeout(),this.cancel_evtStalledTimeout(),this.cancel_evtReconnectTimeout(),this.cancel_evtRhbTimeout()},exit_hp:function(){this.cancel_evtIdleTimeout(),this.cancel_evtPollingTimeout(),this.cancel_evtRhbTimeout()},exit_ctrl:function(){this.cancel_evtCtrlTimeout(),this.evtDisposeCtrl()},exit_rec:function(){this.cancel_evtRecoveryTimeout(),this.cancel_evtTransportTimeout(),this.cancel_evtRetryTimeout()},exit_keepalive_unit:function(){this.cancel_evtKeepaliveTimeout(),this.cancel_evtStalledTimeout(),this.cancel_evtReconnectTimeout()},exit_w_to_m:function(){this.exit_w(),this.exit_tr()},exit_ws_to_m:function(){this.exit_ws(),this.exit_tr()},exit_wp_to_m:function(){this.exit_wp(),this.exit_tr()},exit_hs_to_m:function(){this.exit_ctrl(),this.exit_hs(),this.exit_tr()},exit_hs_to_rec:function(){this.exit_ctrl(),this.exit_hs()},exit_hp_to_m:function(){this.exit_ctrl(),this.exit_hp(),this.exit_tr()},exit_hp_to_rec:function(){this.exit_ctrl(),this.exit_hp()},exit_ctrl_to_m:function(){this.exit_ctrl(),this.exit_hs(),this.exit_hp(),this.exit_tr()},exit_rec_to_m:function(){this.exit_rec(),this.exit_tr()},randomPause:function(t){return this.randomGenerator(t)},generateFreshReqId:function(){return this.m_nextReqId+=1,this.m_nextReqId},generateFreshSubId:function(){return this.m_nextSubId+=1,this.m_nextSubId},genAbortSubscriptions:function(){for(var t=rs(pe)(this.subscriptionManagers);null!=t.head;){var e=t.head.item;t.head=t.head.next,e.value.evtExtAbort()}},genAckMessagesWS:function(){for(var t=this.messageManagers.filter((function(t){return t.isPending()})).h;null!=t;){var e=t.item;t=t.next,e.evtWSSent()}},genAbortMessages:function(){for(var t=this.messageManagers.h;null!=t;){var e=t.item;t=t.next,e.evtAbort()}},resetSequenceMap:function(){this.sequenceMap.h=Object.create(null)},isSwitching:function(){return 150==this.state.s_m&&(1302==this.state.s_swt||1303==this.state.s_swt)},encodeSwitch:function(t){var e=new Me;return this.swt_lastReqId=this.generateFreshReqId(),e.LS_reqId(this.swt_lastReqId),e.LS_op("force_rebind"),t&&e.LS_close_socket(!0),null!=this.cause&&(e.LS_cause(this.cause),this.cause=null),Ns.isInfoEnabled()&&Ns.info("Sending transport switch: "+m.string(e)),e.getEncodedString()},encodeConstrain:function(){var t=new Me;this.bw_lastReqId=this.generateFreshReqId(),t.LS_reqId(this.bw_lastReqId),t.LS_op("constrain");var e=Ee.sure(this.bw_requestedMaxBandwidth);switch(e._hx_index){case 0:t.LS_requested_max_bandwidth_Float(e.bw);break;case 1:t.LS_requested_max_bandwidth("unlimited")}return Ns.isInfoEnabled()&&Ns.info("Sending bandwidth constrain: "+m.string(t)),t.getEncodedString()},getPendingControls:function(){var t=[];Ee.sure(this.switchRequest).isPending()&&t.push(Ee.sure(this.switchRequest)),Ee.sure(this.constrainRequest).isPending()&&t.push(Ee.sure(this.constrainRequest));for(var e=rs(pe)(this.subscriptionManagers);null!=e.head;){var i=e.head.item;e.head=e.head.next;var s=i.value;s.isPending()&&t.push(s)}return t},sendControlWS:function(t){Ee.sure(this.ws).send(t.encodeWS())},sendMsgWS:function(t){Ee.sure(this.ws).send(t.encodeWS())},sendPengingControlsWS:function(t){this.sendBatchWS(this.prepareBatchWS("control",t,Ee.sure(this.requestLimit)))},sendPendingMessagesWS:function(){for(var t=[],e=this.messageManagers.h;null!=e;){var i=e.item;e=e.next,i.isPending()&&t.push(i)}this.sendBatchWS(this.prepareBatchWS("msg",t,Ee.sure(this.requestLimit)))},sendBatchWS:function(t){for(var e=0;e<t.length;){var i=t[e++];Ee.sure(this.ws).send(i)}},sendHeartbeatWS:function(){Ns.isInfoEnabled()&&Ns.info("Heartbeat request"),Ee.sure(this.ws).send("heartbeat\r\n\r\n")},sendPendingControlsHTTP:function(t){this.sendBatchHTTP(this.prepareBatchHTTP(t,Ee.sure(this.requestLimit)),"control")},sendPendingMessagesHTTP:function(){for(var t=[],e=this.messageManagers.h;null!=e;){var i=e.item;e=e.next,i.isPending()&&t.push(i)}this.sendBatchHTTP(this.prepareBatchHTTP(t,Ee.sure(this.requestLimit)),"msg")},sendHeartbeatHTTP:function(){Ns.isInfoEnabled()&&Ns.info("Heartbeat request"),this.sendBatchHTTP("\r\n","heartbeat")},sendBatchHTTP:function(t,e){var i=this;this.ctrl_connectTs=d.now()/1e3;var s=ui.build(Ee.sure(this.serverInstanceAddress),"/lightstreamer/"+e+".txt?LS_protocol="+ms+"&LS_session="+this.sessionId),n=this.getHeadersForRequestOtherThanCreate(),r=function(t,e){Ie.synchronized(i.lock,(function(){t.isDisposed()||i.evtCtrlMessage(e)}))},a=function(t,e){Ie.synchronized(i.lock,(function(){t.isDisposed()||i.evtCtrlError()}))},o=function(t){Ie.synchronized(i.lock,(function(){t.isDisposed()||i.evtCtrlDone()}))};this.ctrl_http=this.ctrlFactory(s,t,n,r,a,o)},prepareBatchWS:function(t,e,i){if(e.length<=0)throw new be("Assertion failure: pendings.length > 0");for(var s=[],n=0,r=e[0].encode(!0);n<e.length;){var a=new It;for(a.addSubRequest(t),a.addSubRequest(r),++n;n<e.length&&(r=e[n].encode(!0),a.addSubRequestOnlyIfBodyIsLessThan(r,i));)++n;s.push(a.getBody())}return s},prepareBatchHTTP:function(t,e){if(t.length<=0)throw new be("Assertion failure: pendings.length > 0");var i=new It,s=0,n=t[0].encode(!1);for(i.addSubRequest(n),s=1;s<t.length&&(n=t[s].encode(!1),i.addSubRequestOnlyIfBodyIsLessThan(n,e));)++s;return i.getBody()},getHeadersForRequestOtherThanCreate:function(){return this.options.httpExtraHeadersOnSessionCreationOnly?null:this.options.httpExtraHeaders},getServerAddress:function(){var t=this.details.serverAddress;return null!=t?t:Ee.sure(this.defaultServerAddress)},relateSubManager:function(t){if(null!=pe.arrayRead(this.subscriptionManagers,t.subId))throw new be("Assertion failure: subscriptionManagers[subManager.subId] == null");pe.arrayWrite(this.subscriptionManagers,t.subId,t)},unrelateSubManager:function(t){pe.remove(this.subscriptionManagers,t.subId)},isRelatedWithSubManager:function(t){return pe.containsValue(this.subscriptionManagers,t)},relateMsgManager:function(t){this.messageManagers.add(t)},unrelateMsgManager:function(t){this.messageManagers.remove(t)},getAndSetNextMsgProg:function(t){var e=this.sequenceMap.h[t];return null==e&&(e=1),this.sequenceMap.h[t]=e+1,e},onPropertyChange:function(t){this.clientEventDispatcher.onPropertyChange(t)},traceEvent:function(t){Ds.isTraceEnabled()&&Ds.trace("event: "+t+" "+this.state.toString())},connect:function(){var t=this.details.getServerAddress();if(null==t)throw new be("Configure the server address before trying to connect");Ps.isInfoEnabled()&&Ps.info("Connection requested: details: "+m.string(this.details)+" options: "+m.string(this.options)),this.defaultServerAddress=t,this.evtExtConnect()},disconnect:function(){Ps.isInfoEnabled()&&Ps.info("Disconnection requested"),this.evtExtDisconnect(A.TC_api)},getStatus:function(){return this.m_status},sendMessage:function(t,e,i,s,n){if(n||!this.state.inDisconnected()&&!this.state.inRetryUnit())if(null!=e){if(!new u("^[a-zA-Z0-9_]*$","").match(e))throw new T("The given sequence name is not valid. Use only alphanumeric characters plus underscore or null");var r=new X(t,e,i,s,n,this);Ps.isInfoEnabled()&&Ps.info("Message sending requested: "+m.string(r)),r.evtExtSendMessage()}else r=new X(t,"UNORDERED_MESSAGES",i,s,n,this),Ps.isInfoEnabled()&&Ps.info("Message sending requested: "+m.string(r)),r.evtExtSendMessage();else{if(Ps.isInfoEnabled()){var a=new ki;a.h.text=t,a.h.sequence=null!=e?e:"UNORDERED_MESSAGES",a.h.timeout=null==i?"null":""+i,a.h.enqueueWhileDisconnected=null==n?"null":""+n,Ps.isInfoEnabled()&&Ps.info("Message sending requested: "+(null==a?"null":ki.stringify(a.h)))}if(As.isWarnEnabled()&&As.warn("Message "+(null!=e?e:"UNORDERED_MESSAGES")+" "+t+" aborted"),null!=s){var o=new Q;o.addListener(s),o.onAbort(t,!1)}}},subscribeExt:function(t,e){if(null==e&&(e=!1),t.isActive())throw new be("Cannot subscribe to an active Subscription");if(null==t.getItems()&&null==t.getItemGroup())throw new T("Specify property 'items' or 'itemGroup'");if(null==t.getFields()&&null==t.getFieldSchema())throw new T("Specify property 'fields' or 'fieldSchema'");var i=new Nt(t,this);Ps.isInfoEnabled()&&Ps.info((e?"Internal subscription":"Subscription")+" requested: subId: "+i.subId+" "+m.string(t)),i.evtExtSubscribe()},unsubscribe:function(t){var e=t.fetch_subManager();if(null!=e){if(!this.isRelatedWithSubManager(e))throw new T("The Subscription is not subscribed to this Client");Ps.isInfoEnabled()&&Ps.info("Unsubscription requested: subId: "+e.subId+" "+m.string(t)),e.evtExtUnsubscribe()}},getSubscriptions:function(){for(var t=[],e=rs(pe)(this.subscriptionManagers);null!=e.head;){var i=e.head.item;e.head=e.head.next;var s=i.value,n=s instanceof Nt?s:null;if(null!=n){var r=n.m_subscription;r.isActive()&&!r.isInternal()&&t.push(r)}}return t},__class__:D};var O=a["com.lightstreamer.client.internal._ClientMachine.BestForCreatingEnum"]={__ename__:!0,__constructs__:null,BFC_ws:{_hx_name:"BFC_ws",_hx_index:0,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForCreatingEnum",toString:r},BFC_http:{_hx_name:"BFC_http",_hx_index:1,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForCreatingEnum",toString:r},BFC_none:{_hx_name:"BFC_none",_hx_index:2,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForCreatingEnum",toString:r}};O.__constructs__=[O.BFC_ws,O.BFC_http,O.BFC_none];var P=a["com.lightstreamer.client.internal._ClientMachine.BestForBindingEnum"]={__ename__:!0,__constructs__:null,BFB_none:{_hx_name:"BFB_none",_hx_index:0,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForBindingEnum",toString:r},BFB_ws_streaming:{_hx_name:"BFB_ws_streaming",_hx_index:1,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForBindingEnum",toString:r},BFB_ws_polling:{_hx_name:"BFB_ws_polling",_hx_index:2,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForBindingEnum",toString:r},BFB_http_streaming:{_hx_name:"BFB_http_streaming",_hx_index:3,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForBindingEnum",toString:r},BFB_http_polling:{_hx_name:"BFB_http_polling",_hx_index:4,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForBindingEnum",toString:r}};P.__constructs__=[P.BFB_none,P.BFB_ws_streaming,P.BFB_ws_polling,P.BFB_http_streaming,P.BFB_http_polling];var k=a["com.lightstreamer.client.internal._ClientMachine.SyncCheckResult"]={__ename__:!0,__constructs__:null,SCR_good:{_hx_name:"SCR_good",_hx_index:0,__enum__:"com.lightstreamer.client.internal._ClientMachine.SyncCheckResult",toString:r},SCR_not_good:{_hx_name:"SCR_not_good",_hx_index:1,__enum__:"com.lightstreamer.client.internal._ClientMachine.SyncCheckResult",toString:r},SCR_bad:{_hx_name:"SCR_bad",_hx_index:2,__enum__:"com.lightstreamer.client.internal._ClientMachine.SyncCheckResult",toString:r}};k.__constructs__=[k.SCR_good,k.SCR_not_good,k.SCR_bad];var F=a["com.lightstreamer.client.internal._ClientMachine.RetryCause"]={__ename__:!0,__constructs__:null,standardError:(e=function(t,e){return{_hx_index:0,code:t,msg:e,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:r}},e._hx_name="standardError",e.__params__=["code","msg"],e),ws_unavailable:{_hx_name:"ws_unavailable",_hx_index:1,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:r},ws_error:{_hx_name:"ws_error",_hx_index:2,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:r},http_error:{_hx_name:"http_error",_hx_index:3,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:r},idle_timeout:{_hx_name:"idle_timeout",_hx_index:4,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:r},stalled_timeout:{_hx_name:"stalled_timeout",_hx_index:5,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:r},ws_timeout:{_hx_name:"ws_timeout",_hx_index:6,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:r},http_timeout:{_hx_name:"http_timeout",_hx_index:7,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:r},recovery_timeout:{_hx_name:"recovery_timeout",_hx_index:8,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:r},prog_mismatch:(e=function(t,e){return{_hx_index:9,expected:t,actual:e,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:r}},e._hx_name="prog_mismatch",e.__params__=["expected","actual"],e)};F.__constructs__=[F.standardError,F.ws_unavailable,F.ws_error,F.http_error,F.idle_timeout,F.stalled_timeout,F.ws_timeout,F.http_timeout,F.recovery_timeout,F.prog_mismatch];var A=a["com.lightstreamer.client.internal._ClientMachine.TerminationCause"]={__ename__:!0,__constructs__:null,TC_standardError:(e=function(t,e){return{_hx_index:0,code:t,msg:e,__enum__:"com.lightstreamer.client.internal._ClientMachine.TerminationCause",toString:r}},e._hx_name="TC_standardError",e.__params__=["code","msg"],e),TC_otherError:(e=function(t){return{_hx_index:1,error:t,__enum__:"com.lightstreamer.client.internal._ClientMachine.TerminationCause",toString:r}},e._hx_name="TC_otherError",e.__params__=["error"],e),TC_api:{_hx_name:"TC_api",_hx_index:2,__enum__:"com.lightstreamer.client.internal._ClientMachine.TerminationCause",toString:r}};A.__constructs__=[A.TC_standardError,A.TC_otherError,A.TC_api];var q=a["com.lightstreamer.client.internal._ClientMachine.RecoveryRetryCause"]={__ename__:!0,__constructs__:null,RRC_transport_timeout:{_hx_name:"RRC_transport_timeout",_hx_index:0,__enum__:"com.lightstreamer.client.internal._ClientMachine.RecoveryRetryCause",toString:r},RRC_transport_error:{_hx_name:"RRC_transport_error",_hx_index:1,__enum__:"com.lightstreamer.client.internal._ClientMachine.RecoveryRetryCause",toString:r}};function B(t){switch(t._hx_index){case 0:return t.code+" - "+t.msg;case 1:return"Websocket transport not available";case 2:return"Websocket error";case 3:return"HTTP error";case 4:return"idleTimeout expired";case 5:return"stalledTimeout expired";case 6:return"Websocket connect timeout expired";case 7:return"HTTP connect timeout expired";case 8:return"sessionRecoveryTimeout expired";case 9:return"Recovery counter mismatch: expected "+t.expected+" but found "+t.actual}}q.__constructs__=[q.RRC_transport_timeout,q.RRC_transport_error];var U=function(){};U.__name__="com.lightstreamer.client.internal.Encodable",U.__isInterface__=!0,U.prototype={__class__:U};var W=function(t){this.client=t};W.__name__="com.lightstreamer.client.internal.SwitchRequest",W.__interfaces__=[U],W.prototype={isPending:function(){return 150==this.client.state.s_m&&1302==this.client.state.s_swt},encode:function(t){return this.client.encodeSwitch(t)},encodeWS:function(){return"control\r\n"+this.encode(!0)},__class__:W};var H=function(t){this.client=t};H.__name__="com.lightstreamer.client.internal.ConstrainRequest",H.__interfaces__=[U],H.prototype={isPending:function(){return 1202==this.client.state.s_bw},encode:function(t){return this.client.encodeConstrain()},encodeWS:function(){return"control\r\n"+this.encode(!0)},__class__:H};var V=function(t,e,i){this.p=t,this.k=e,this.s=i};V.__name__="com.lightstreamer.client.internal.StateVar_w",V.prototype={toString:function(){return"<w_p="+this.p+" w_k="+this.k+" w_s="+this.s+">"},__class__:V};var Y=function(t){this.m=t};Y.__name__="com.lightstreamer.client.internal.StateVar_ws",Y.prototype={toString:function(){var t="<ws_m="+this.m;return null!=this.p&&(t+=" ws_p="+this.p),null!=this.k&&(t+=" ws_k="+this.k),null!=this.s&&(t+=" ws_s="+this.s),t+=">"},__class__:Y};var G=function(t){this.m=t};G.__name__="com.lightstreamer.client.internal.StateVar_wp",G.prototype={toString:function(){var t="<wp_m="+this.m;return null!=this.p&&(t+=" wp_p="+this.p),null!=this.c&&(t+=" wp_c="+this.c),null!=this.s&&(t+=" wp_s="+this.s),t+=">"},__class__:G};var K=function(t){this.m=t};K.__name__="com.lightstreamer.client.internal.StateVar_hs",K.prototype={toString:function(){var t="<hs_m="+this.m;return null!=this.p&&(t+=" hs_p="+this.p),null!=this.k&&(t+=" hs_k="+this.k),t+=">"},__class__:K};var z=function(t){this.m=t};z.__name__="com.lightstreamer.client.internal.StateVar_hp",z.prototype={toString:function(){return"<hp_m="+this.m+">"},__class__:z};var j=function(){this.s_mpn=new _t,this.s_m=100,this.s_du=20,this.s_nr=1400};j.__name__="com.lightstreamer.client.internal.State",j.prototype={goto_m_from_w:function(t){this.clear_w(),this.goto_m_from_session(t)},goto_m_from_ws:function(t){this.clear_ws(),this.goto_m_from_session(t)},goto_rec_from_w:function(){this.clear_w(),this.goto_rec()},goto_rec_from_ws:function(){this.clear_ws(),this.goto_rec()},goto_m_from_wp:function(t){this.clear_wp(),this.goto_m_from_session(t)},goto_rec_from_wp:function(){this.clear_wp(),this.goto_rec()},goto_m_from_hs:function(t){this.clear_hs(),this.s_ctrl=null,this.s_h=null,this.goto_m_from_session(t)},goto_m_from_rec:function(t){this.s_tr=null,this.goto_m_from_session(t)},goto_rec_from_hs:function(){this.clear_hs(),this.s_ctrl=null,this.s_h=null,this.goto_rec()},goto_m_from_hp:function(t){this.clear_hp(),this.s_ctrl=null,this.s_h=null,this.goto_m_from_session(t)},goto_rec_from_hp:function(){this.clear_hp(),this.s_ctrl=null,this.s_h=null,this.goto_rec()},goto_rec:function(){this.s_tr=260,this.s_rec=1e3,this.traceState()},goto_m_from_session:function(t){this.s_tr=null,this.s_swt=null,this.s_bw=null,this.s_m=t,this.traceState()},goto_m_from_ctrl:function(t){this.clear_hs(),this.clear_hp(),this.s_ctrl=null,this.s_h=null,this.goto_m_from_session(t)},goto_200_from_rec:function(){this.s_rec=null,this.s_tr=200,this.traceState()},clear_w:function(){this.s_w=null,this.s_rhb=null,this.s_slw=null},clear_ws:function(){this.s_ws=null,this.s_rhb=null,this.s_slw=null},clear_wp:function(){this.s_wp=null},clear_hs:function(){this.s_hs=null,this.s_rhb=null,this.s_slw=null},clear_hp:function(){this.s_hp=null,this.s_rhb=null},isSwitching:function(){return 150==this.s_m&&(1302==this.s_swt||1303==this.s_swt)},inPushing:function(){return!!this.inStreaming()||this.inPolling()},inStreaming:function(){var t,e;return!!(e=300==(null!=(t=this.s_w)?t.p:null)||510==(null!=(t=this.s_ws)?t.p:null))||810==(null!=(e=this.s_hs)?e.p:null)},inPolling:function(){var t;if(220!=this.s_tr&&230!=this.s_tr){var e=this.s_wp;t=611==(null!=e?e.p:null)}else t=!0;return!!(!!t||901==(null!=(t=this.s_hp)?t.m:null))||1001==this.s_rec},inRetryUnit:function(){switch(this.s_m){case 110:case 111:case 112:case 113:case 114:case 115:case 116:return!0;default:return!1}},inDisconnected:function(){return 100==this.s_m},toString:function(){var t="<m="+this.s_m;return t+=" du="+this.s_du,null!=this.s_tr&&(t+=" tr="+this.s_tr),null!=this.s_w&&(t+=" "+m.string(this.s_w)),null!=this.s_ws&&(t+=" "+m.string(this.s_ws)),null!=this.s_wp&&(t+=" "+m.string(this.s_wp)),null!=this.s_hs&&(t+=" "+m.string(this.s_hs)),null!=this.s_hp&&(t+=" "+m.string(this.s_hp)),null!=this.s_rec&&(t+=" rec="+this.s_rec),null!=this.s_h&&(t+=" h="+this.s_h),null!=this.s_ctrl&&(t+=" ctrl="+this.s_ctrl),null!=this.s_swt&&(t+=" swt="+this.s_swt),null!=this.s_bw&&(t+=" bw="+this.s_bw),null!=this.s_rhb&&(t+=" rhb="+this.s_rhb),null!=this.s_slw&&(t+=" slw="+this.s_slw),t+=" nr="+this.s_nr,null!=this.s_mpn&&(t+=" "+m.string(this.s_mpn)),t+=">"},traceState:function(){Ds.isTraceEnabled()&&Ds.trace("goto: "+this.toString())},__class__:j};var Q=function(){x.call(this)};Q.__name__="com.lightstreamer.client.internal.MessageEventDispatcher",Q.__super__=x,Q.prototype=l(x.prototype,{onAbort:function(t,e){this.dispatchToAll((function(i){null!=i.onAbort&&i.onAbort(t,e)}))},onDeny:function(t,e,i){this.dispatchToAll((function(s){null!=s.onDeny&&s.onDeny(t,e,i)}))},onDiscarded:function(t){this.dispatchToAll((function(e){null!=e.onDiscarded&&e.onDiscarded(t)}))},onError:function(t){this.dispatchToAll((function(e){null!=e.onError&&e.onError(t)}))},onProcessed:function(t,e){this.dispatchToAll((function(i){null!=i.onProcessed&&i.onProcessed(t,e)}))},__class__:Q});var X=function(t,e,i,s,n,r){this.eventDispatcher=new Q,this.txt=t,this.sequence=e,this.prog="UNORDERED_MESSAGES"!=e||null!=s?r.getAndSetNextMsgProg(e):-1,this.maxWait=i,this.delegate=s,null!=s&&this.eventDispatcher.addListener(s),this.enqueueWhileDisconnected=n,this.client=r,this.s_m=null!=s?10:"UNORDERED_MESSAGES"!=e?20:30,r.relateMsgManager(this)};X.__name__="com.lightstreamer.client.internal.MessageManager",X.__interfaces__=[U],X.prototype={finalize:function(){this.client.unrelateMsgManager(this)},evtExtSendMessage:function(){switch(this.traceEvent("sendMessage"),this.s_m){case 10:this.goto(11),this.client.evtSendMessage(this);break;case 20:this.goto(21),this.client.evtSendMessage(this);break;case 30:this.goto(31),this.client.evtSendMessage(this)}},evtMSGFAIL:function(t,e){switch(this.traceEvent("MSGFAIL"),this.s_m){case 10:this.finalize(),this.goto(13);break;case 11:case 12:this.doMSGFAIL(t,e),this.finalize(),this.goto(14)}},evtMSGDONE:function(t){switch(this.traceEvent("MSGDONE"),this.s_m){case 10:this.finalize(),this.goto(13);break;case 11:case 12:this.doMSGDONE(t),this.finalize(),this.goto(13)}},evtREQOK:function(t){switch(this.traceEvent("REQOK"),this.s_m){case 11:t==this.lastReqId&&this.goto(12);break;case 21:t==this.lastReqId&&(this.finalize(),this.goto(22));break;case 31:t==this.lastReqId&&(this.finalize(),this.goto(33))}},evtREQERR:function(t,e,i){switch(this.traceEvent("REQERR"),this.s_m){case 11:t==this.lastReqId&&(this.doREQERR(e,i),this.finalize(),this.goto(14));break;case 21:t==this.lastReqId&&(this.finalize(),this.goto(23));break;case 31:t==this.lastReqId&&(this.finalize(),this.goto(34))}},evtAbort:function(){switch(this.traceEvent("abort"),this.s_m){case 11:case 12:this.doAbort(),this.finalize(),this.goto(15);break;case 21:As.isWarnEnabled()&&As.warn("Message "+this.sequence+":"+this.prog+" aborted"),this.finalize(),this.goto(24);break;case 31:As.isWarnEnabled()&&As.warn("Message "+this.sequence+":"+this.prog+" aborted"),this.finalize(),this.goto(35)}},evtWSSent:function(){this.traceEvent("ws.sent"),31==this.s_m&&(this.finalize(),this.goto(32))},isPending:function(){return 11==this.s_m||21==this.s_m||31==this.s_m},encode:function(t){return this.encodeMsg(t)},encodeWS:function(){return"msg\r\n"+this.encode(!0)},doMSGDONE:function(t){this.fireOnProcessed(t)},doMSGFAIL:function(t,e){38==t||39==t?this.fireOnDiscarded():t<=0?this.fireOnDeny(t,e):32!=t&&33!=t&&this.fireOnError()},doREQERR:function(t,e){32!=t&&33!=t&&this.fireOnError()},doAbort:function(){this.fireOnAbort()},encodeMsg:function(t){var e="UNORDERED_MESSAGES"!=this.sequence,i=null!=this.delegate,s=new Me;return this.lastReqId=this.client.generateFreshReqId(),s.LS_reqId(this.lastReqId),s.LS_message(this.txt),e&&i?(s.LS_sequence(this.sequence),s.LS_msg_prog(this.prog),this.maxWait>=0&&s.LS_max_wait(this.maxWait)):!e&&i?s.LS_msg_prog(this.prog):e&&!i?(s.LS_outcome(!1),s.LS_sequence(this.sequence),s.LS_msg_prog(this.prog),this.maxWait>=0&&s.LS_max_wait(this.maxWait)):e||i||(s.LS_outcome(!1),t&&s.LS_ack(!1)),Ns.isInfoEnabled()&&Ns.info("Sending message: "+m.string(s)),s.getEncodedString()},fireOnProcessed:function(t){As.isInfoEnabled()&&As.info("Message "+this.sequence+":"+this.prog+" processed"),this.eventDispatcher.onProcessed(this.txt,t)},fireOnDiscarded:function(){As.isWarnEnabled()&&As.warn("Message "+this.sequence+":"+this.prog+" discarded"),this.eventDispatcher.onDiscarded(this.txt)},fireOnDeny:function(t,e){As.isWarnEnabled()&&As.warn("Message "+this.sequence+":"+this.prog+" denied: "+t+" - "+e),this.eventDispatcher.onDeny(this.txt,t,e)},fireOnError:function(){As.isWarnEnabled()&&As.warn("Message "+this.sequence+":"+this.prog+" failed"),this.eventDispatcher.onError(this.txt)},fireOnAbort:function(){As.isWarnEnabled()&&As.warn("Message "+this.sequence+":"+this.prog+" aborted"),this.eventDispatcher.onAbort(this.txt,!1)},traceEvent:function(t){Ds.isTraceEnabled()&&Ds.trace("msg#"+t+"("+this.sequence+":"+this.prog+") in "+this.s_m)},goto:function(t){this.s_m=t,Ds.isTraceEnabled()&&Ds.trace("msg#goto("+this.sequence+":"+this.prog+") "+this.s_m)},toString:function(){var t=ge._new();return ge.set(t,"text",this.txt),ge.set(t,"sequence",this.sequence),ge.set(t,"prog",this.prog),ge.set(t,"timeout",this.maxWait),ge.set(t,"enqueueWhileDisconnected",this.enqueueWhileDisconnected),ki.stringify(t.h)},__class__:X};var Z=function(t,e,i){this.items=new Ni,this.s_m=1,this.lock=e.lock,this.client=e,this.subscription=t,this.m_subId=i};Z.__name__="com.lightstreamer.client.internal.ModeStrategy",Z.prototype={finalize:function(){},evtAbort:function(){this.traceEvent("abort"),1==this.s_m?(this.doAbort(),this.goto(1)):2==this.s_m&&(this.doAbort(),this.goto(1),this.genDisposeItems())},evtOnSUB:function(t,e,i,s,n){this.traceEvent("onSUB"),1==this.s_m&&(this.doSUB(t,e),this.goto(2))},evtOnCONF:function(t){this.traceEvent("onCONF"),2==this.s_m&&(this.doCONF(t),this.goto(2))},evtOnCS:function(t){this.traceEvent("onCS"),2==this.s_m&&(this.doCS(t),this.goto(2))},evtOnEOS:function(t){this.traceEvent("onEOS"),2==this.s_m&&(this.doEOS(t),this.goto(2))},evtUpdate:function(t,e){this.traceEvent("update"),2==this.s_m&&(this.doUpdate(t,e),this.goto(2))},evtUnsubscribe:function(){this.traceEvent("unsubscribe"),1==this.s_m?(this.finalize(),this.goto(3)):2==this.s_m&&(this.finalize(),this.goto(3),this.genDisposeItems())},evtOnUNSUB:function(){this.traceEvent("onUNSUB"),2==this.s_m&&(this.finalize(),this.goto(3),this.genDisposeItems())},evtDispose:function(){this.traceEvent("dispose"),1!=this.s_m&&2!=this.s_m||(this.finalize(),this.goto(3),this.genDisposeItems())},evtSetRequestedMaxFrequency:function(t){},getValue:function(t,e){var i=this.items.h[t];return null!=i?i.getValue(e):null},getCommandValue:function(t,e,i){throw new be("Unsupported operation")},createItem:function(t){throw new be("Abstract method")},doSUB:function(t,e){var i=this.subscription.getItems(),s=this.subscription.getFields();if(null!=i&&t!=i.slice().length)throw new be("Assertion failure: items != null ? nItems == items.toHaxe().length : true");if(null!=s&&e!=s.slice().length)throw new be("Assertion failure: fields != null ? nFields == fields.toHaxe().length : true")},doUpdate:function(t,e){this.selectItem(t).evtUpdate(e)},doEOS:function(t){this.selectItem(t).evtOnEOS()},doCS:function(t){this.selectItem(t).evtOnCS()},doCONF:function(t){this.realMaxFrequency=t,this.subscription.fireOnRealMaxFrequency(t,this.m_subId)},doAbort:function(){this.realMaxFrequency=null},genDisposeItems:function(){for(var t=this.items.copy(),e=t.keys();e.hasNext();)t.get(e.next()).evtDispose(this)},selectItem:function(t){var e=this.items.h[t];return null==e&&(e=this.createItem(t),this.items.h[t]=e),e},unrelate:function(t){this.items.remove(t)},traceEvent:function(t){Ds.isTraceEnabled()&&Ds.trace("sub#mod#"+t+"("+this.m_subId+") in "+this.s_m)},goto:function(t){this.s_m=t,Ds.isTraceEnabled()&&Ds.trace("sub#mod#goto("+this.m_subId+") "+this.s_m)},__class__:Z};var J=function(t,e,i){Z.call(this,t,e,i)};J.__name__="com.lightstreamer.client.internal.ModeStrategyCommand",J.__super__=Z,J.prototype=l(Z.prototype,{evtOnSUB:function(t,e,i,s,n){this.traceEvent("onSUB"),1==this.s_m&&(this.doSUBCMD(t,e,i,s),this.goto(2))},getCommandValue:function(t,e,i){var s=this.items.h[t];return null!=s?s.getCommandValue(e,i):null},doSUBCMD:function(t,e,i,s){var n=this.subscription.getItems(),r=null!=n?n.slice():null,a=this.subscription.getFields(),o=null!=a?a.slice():null;if(null!=r&&t!=r.length)throw new be("Assertion failure: items != null ? nItems == items.length : true");if(null!=o&&e!=o.length)throw new be("Assertion failure: fields != null ? nFields == fields.length : true");if(null!=o&&i-1!=o.indexOf("command"))throw new be('Assertion failure: fields != null ? cmdIdx - 1 == fields.indexOf("command") : true');if(null!=o&&s-1!=o.indexOf("key"))throw new be('Assertion failure: fields != null ? keyIdx - 1 == fields.indexOf("key") : true')},__class__:J});var $=function(t,e,i){J.call(this,t,e,i)};$.__name__="com.lightstreamer.client.internal.ModeStrategyCommand1Level",$.__super__=J,$.prototype=l(J.prototype,{createItem:function(t){return new Ft(t,this.subscription,this.client,this.m_subId)},__class__:$});var tt=function(t,e,i){J.call(this,t,e,i)};tt.__name__="com.lightstreamer.client.internal.ModeStrategyCommand2Level",tt.__super__=J,tt.prototype=l(J.prototype,{evtOnSUB:function(t,e,i,s,n){this.traceEvent("onSUB"),1==this.s_m&&(this.doSUBCMD2Level(t,e,i,s,n),this.goto(2))},evtSetRequestedMaxFrequency:function(t){switch(this.traceEvent("setRequestedMaxFrequency"),this.s_m){case 1:case 2:this.doSetRequestedMaxFrequency(t),this.goto(this.s_m),this.genSetRequestedMaxFrequency()}},evtOnRealMaxFrequency2LevelAdded:function(t){this.traceEvent("onRealMaxFrequency2LevelAdded"),2==this.s_m&&(this.doAggregateFrequenciesWhenFreqIsAdded(t),this.goto(2))},evtOnRealMaxFrequency2LevelRemoved:function(){this.traceEvent("onRealMaxFrequency2LevelRemoved"),2==this.s_m&&(this.doAggregateFrequenciesWhenFreqIsRemoved(),this.goto(2))},evtOnCONF:function(t){this.traceEvent("onCONF"),2==this.s_m&&(this.doCONF2Level(t),this.doAggregateFrequenciesWhenFreqIsAdded(t),this.goto(2))},createItem:function(t){return new At(t,this.subscription,this,this.client,this.m_subId)},doSUBCMD2Level:function(t,e,i,s,n){var r=this.subscription.getItems(),a=null!=r?r.slice():null,o=this.subscription.getFields(),h=null!=o?o.slice():null;if(null!=a&&t!=a.length)throw new be("Assertion failure: items != null ? nItems == items.length : true");if(null!=h&&e!=h.length)throw new be("Assertion failure: fields != null ? nFields == fields.length : true");if(null!=h&&i-1!=h.indexOf("command"))throw new be('Assertion failure: fields != null ? cmdIdx - 1 == fields.indexOf("command") : true');if(null!=h&&s-1!=h.indexOf("key"))throw new be('Assertion failure: fields != null ? keyIdx - 1 == fields.indexOf("key") : true');this.requestedMaxFrequency=n},doSetRequestedMaxFrequency:function(t){this.requestedMaxFrequency=t},genSetRequestedMaxFrequency:function(){for(var t=this.items,e=t.keys();e.hasNext();)ns.__cast(t.get(e.next()),At).evtSetRequestedMaxFrequency()},doCONF2Level:function(t){this.realMaxFrequency=t},maxFreq:function(t,e){var i;if(null==t)i=e;else switch(t._hx_index){case 0:var s=t.freq;if(null==e)i=t;else switch(e._hx_index){case 0:i=ei.RFreqLimited(Math.max(s,e.freq));break;case 1:i=e}break;case 1:i=t}return i},doAggregateFrequenciesWhenFreqIsAdded:function(t){var e=this.maxFreq(this.aggregateRealMaxFrequency,t),i=this.aggregateRealMaxFrequency;this.aggregateRealMaxFrequency=e,li(i,e)||this.subscription.fireOnRealMaxFrequency(e,this.m_subId)},doAggregateFrequenciesWhenFreqIsRemoved:function(){for(var t=this.realMaxFrequency,e=!1,i=this.items,s=i.keys();s.hasNext();){for(var n=ns.__cast(i.get(s.next()),At).keys.h,r=Object.keys(n),a=r.length,o=0;o<a;)if((t=this.maxFreq(t,ns.__cast(n[r[o++]],Gt).realMaxFrequency))==ei.RFreqUnlimited){e=!0;break}if(e)break}var h=this.aggregateRealMaxFrequency;this.aggregateRealMaxFrequency=t,li(h,t)||this.subscription.fireOnRealMaxFrequency(t,this.m_subId)},__class__:tt});var et=function(t,e,i){Z.call(this,t,e,i)};et.__name__="com.lightstreamer.client.internal.ModeStrategyDistinct",et.__super__=Z,et.prototype=l(Z.prototype,{createItem:function(t){return new qt(t,this.subscription,this.client,this.m_subId)},__class__:et});var it=function(t,e,i){Z.call(this,t,e,i)};it.__name__="com.lightstreamer.client.internal.ModeStrategyMerge",it.__super__=Z,it.prototype=l(Z.prototype,{createItem:function(t){return new Ut(t,this.subscription,this.client,this.m_subId)},__class__:it});var st=function(t,e,i){Z.call(this,t,e,i)};st.__name__="com.lightstreamer.client.internal.ModeStrategyRaw",st.__super__=Z,st.prototype=l(Z.prototype,{createItem:function(t){return new Wt(t,this.subscription,this.client,this.m_subId)},__class__:st});var nt=function(t,e,i,s,n,r,a){this.mpn_badge_reset_requested=!1,this.mpn_filter_pendings=[],this.mpn_snapshotSet=new Ne,this.mpn_candidate_devices=[],this.mpnSubscriptionManagers=Se._new(),D.call(this,t,e,i,s,n,r,a),this.mpnRegisterRequest=new ut(this),this.mpnFilterUnsubscriptionRequest=new ct(this),this.mpnBadgeResetRequest=new dt(this)};nt.__name__="com.lightstreamer.client.internal.MpnClientMachine",nt.__super__=D,nt.prototype=l(D.prototype,{evtExtConnect_NextRegion:function(){return this.evtExtConnect_MpnRegion()},evtExtConnect_MpnRegion:function(){var t=!0;return 401==this.state.s_mpn.m&&(this.state.s_mpn.m=403,this.state.traceState(),t=this.evtExtConnect_NetworkReachabilityRegion(),this.genSendMpnRegister()),t&&(t=this.evtExtConnect_NetworkReachabilityRegion()),!1},evtREQOK_Forward:function(t){this.traceEvent("mpn:REQOK");var e=!0;return 403==this.state.s_mpn.m&&t==this.mpn_lastRegisterReqId?(this.state.s_mpn.m=404,this.state.traceState(),e=this.evtREQOK_TransportRegion(t)):406==this.state.s_mpn.m&&t==this.mpn_lastRegisterReqId?(this.state.s_mpn.m=407,this.state.traceState(),e=this.evtREQOK_TransportRegion(t)):453==this.state.s_mpn.tk&&t==this.mpn_lastRegisterReqId?(this.state.s_mpn.tk=454,this.state.traceState(),e=this.evtREQOK_TransportRegion(t)):432==this.state.s_mpn.ft&&t==this.mpn_filter_lastDeactivateReqId?(this.doREQMpnUnsubscribeFilter(),this.state.s_mpn.ft=430,this.state.traceState(),e=this.evtREQOK_TransportRegion(t),this.evtMpnCheckFilter()):442==this.state.s_mpn.bg&&t==this.mpn_badge_lastResetReqId&&(this.doREQOKMpnResetBadge(),e=this.evtREQOK_TransportRegion(t),this.state.s_mpn.bg=440,this.state.traceState(),this.evtMpnCheckReset()),e},evtREQERR_Forward:function(t,e,i){this.traceEvent("mpn:REQERR");var s=!0;return 403==this.state.s_mpn.m&&t==this.mpn_lastRegisterReqId?(this.notifyDeviceError(e,i),this.state.s_mpn.m=402,this.state.traceState(),s=this.evtREQERR_TransportRegion(t,e,i),this.evtMpnCheckNext()):406==this.state.s_mpn.m&&t==this.mpn_lastRegisterReqId?(this.notifyDeviceError(e,i),this.state.s_mpn.m=408,this.state.traceState(),s=this.evtREQERR_TransportRegion(t,e,i),this.evtMpnCheckNext()):453==this.state.s_mpn.tk&&t==this.mpn_lastRegisterReqId?(this.notifyDeviceError(e,i),this.state.s_mpn.tk=452,this.state.traceState(),s=this.evtREQERR_TransportRegion(t,e,i),this.evtMpnCheckNext()):432==this.state.s_mpn.ft&&t==this.mpn_filter_lastDeactivateReqId?(this.doREQMpnUnsubscribeFilter(),this.state.s_mpn.ft=430,this.state.traceState(),s=this.evtREQERR_TransportRegion(t,e,i),this.evtMpnCheckFilter()):442==this.state.s_mpn.bg&&t==this.mpn_badge_lastResetReqId&&(this.doREQERRMpnResetBadge(),this.notifyOnBadgeResetFailed(e,i),this.state.s_mpn.bg=440,this.state.traceState(),s=this.evtREQERR_TransportRegion(t,e,i),this.evtMpnCheckReset()),s},evtRetry_NextRegion:function(){return this.evtRetry_MpnRegion()},evtRetry_MpnRegion:function(){switch(this.state.s_mpn.m){case 403:case 404:this.state.s_mpn.m=403,this.state.traceState();break;case 405:this.doRemoveMpnSpecialListeners(),this.state.s_mpn.m=406,this.state.s_mpn.st=null,this.state.s_mpn.tk=null,this.state.s_mpn.sbs=null,this.state.s_mpn.ft=null,this.state.s_mpn.bg=null,this.state.traceState(),this.genUnsubscribeMpnSpecialItems();break;case 406:case 407:this.state.s_mpn.m=406,this.state.traceState()}return!1},evtTerminate_NextRegion:function(){return this.evtTerminate_MpnRegion()},evtTerminate_MpnRegion:function(){var t=!0;switch(this.state.s_mpn.m){case 403:case 404:case 406:case 407:this.state.s_mpn.m=401,this.state.traceState(),t=this.evtTerminate_NetworkReachabilityRegion(),this.evtResetMpnDevice();break;case 405:this.doRemoveMpnSpecialListeners(),this.state.s_mpn.m=401,this.state.s_mpn.st=null,this.state.s_mpn.tk=null,this.state.s_mpn.sbs=null,this.state.s_mpn.ft=null,this.state.s_mpn.bg=null,this.state.traceState(),t=this.evtTerminate_NetworkReachabilityRegion(),this.genUnsubscribeMpnSpecialItems(),this.evtResetMpnDevice()}return t&&(t=this.evtTerminate_NetworkReachabilityRegion()),!1},evtMessage:function(t){if(!D.prototype.evtMessage.call(this,t))if(v.startsWith(t,"MPNREG")){var e=t.split(",");this.evtMPNREG(e[1],e[2])}else v.startsWith(t,"MPNZERO")?this.evtMPNZERO(t.split(",")[1]):v.startsWith(t,"MPNOK")?(e=t.split(","),this.evtMPNOK(vt(e[1]),e[2])):v.startsWith(t,"MPNDEL")?this.evtMPNDEL(t.split(",")[1]):v.startsWith(t,"MPNCONF")&&this.evtMPNCONF(t.split(",")[1]);return!0},evtExtMpnRegister:function(){this.traceEvent("mpn.register"),400==this.state.s_mpn.m||401==this.state.s_mpn.m?(this.state.s_mpn.m=402,this.state.traceState(),this.evtMpnCheckNext()):451==this.state.s_mpn.tk&&(this.state.s_mpn.tk=452,this.state.traceState(),this.evtMpnCheckNext())},evtMpnCheckNext:function(){this.traceEvent("mpn.check.next"),402==this.state.s_mpn.m?p.empty(this.mpn_candidate_devices)?(this.state.s_mpn.m=401,this.state.traceState(),this.evtResetMpnDevice()):(this.doRegisterMpnDevice(),this.state.s_mpn.m=403,this.state.traceState(),this.genSendMpnRegister()):408==this.state.s_mpn.m?p.empty(this.mpn_candidate_devices)?(this.state.s_mpn.m=401,this.state.traceState(),this.evtResetMpnDevice()):(this.doRegisterMpnDevice(),this.state.s_mpn.m=406,this.state.traceState(),this.genSendMpnRegister()):452==this.state.s_mpn.tk&&(p.empty(this.mpn_candidate_devices)?(this.doRemoveMpnSpecialListeners(),this.state.s_mpn.m=401,this.state.s_mpn.st=null,this.state.s_mpn.tk=null,this.state.s_mpn.sbs=null,this.state.s_mpn.ft=null,this.state.s_mpn.bg=null,this.state.traceState(),this.genUnsubscribeMpnSpecialItems(),this.evtResetMpnDevice()):(this.doRegisterMpnDevice(),this.state.s_mpn.tk=453,this.state.traceState(),this.genSendMpnRegister()))},evtResetMpnDevice:function(){this.traceEvent("reset.mpn.device"),401==this.state.s_mpn.m&&(this.doResetMpnDevice(),this.notifyDeviceReset(),this.state.s_mpn.m=401,this.state.traceState())},evtMpnError:function(t,e){this.traceEvent("mpn.error"),405==this.state.s_mpn.m&&(this.doRemoveMpnSpecialListeners(),this.notifyDeviceError(t,e),this.state.s_mpn.m=401,this.state.s_mpn.st=null,this.state.s_mpn.sbs=null,this.state.s_mpn.ft=null,this.state.s_mpn.bg=null,this.state.s_mpn.tk=null,this.state.traceState(),this.genUnsubscribeMpnSpecialItems(),this.evtResetMpnDevice())},evtMPNREG:function(t,e){this.traceEvent("MPNREG"),Ns.isDebugEnabled()&&Ns.debug("MPNREG "+t+" "+e);var i=!0;if(this.state.inPushing())if(this.isFreshData()){this.doMPNREG();var s=this.state.inStreaming();i=this.evtMPNREG_MpnRegion(t,e),s&&this.evtRestartKeepalive()}else this.onStaleData(),s=this.state.inStreaming(),i=this.evtMPNREG_MpnRegion(t,e),s&&this.evtRestartKeepalive();i&&(i=this.evtMPNREG_MpnRegion(t,e))},evtMPNREG_MpnRegion:function(t,e){return 403==this.state.s_mpn.m||404==this.state.s_mpn.m?(this.doMPNREG_Register(t,e),this.notifyDeviceRegistered(0),this.state.s_mpn.m=405,this.state.s_mpn.st=410,this.state.s_mpn.sbs=420,this.state.s_mpn.ft=430,this.state.s_mpn.bg=440,this.state.s_mpn.tk=450,this.state.traceState(),this.genDeviceActive(),this.genSubscribeSpecialItems(),this.evtMpnCheckPending(),this.evtSUBS_Init(),this.evtMpnCheckFilter(),this.evtMpnCheckReset()):406==this.state.s_mpn.m||407==this.state.s_mpn.m?t==this.mpn_deviceId&&e==this.mpn_adapterName?(this.doMPNREG_Register(t,e),this.notifyDeviceRegistered(0),this.state.s_mpn.m=405,this.state.s_mpn.st=410,this.state.s_mpn.sbs=420,this.state.s_mpn.ft=430,this.state.s_mpn.bg=440,this.state.s_mpn.tk=450,this.state.traceState(),this.genDeviceActive(),this.genSubscribeSpecialItems(),this.evtMpnCheckPending(),this.evtSUBS_Init(),this.evtMpnCheckFilter(),this.evtMpnCheckReset()):(this.doMPNREG_Error(),this.notifyDeviceError_DifferentDevice(),this.state.s_mpn.m=408,this.state.traceState(),this.evtMpnCheckNext()):453!=this.state.s_mpn.tk&&454!=this.state.s_mpn.tk||(t==this.mpn_deviceId&&e==this.mpn_adapterName?(this.doMPNREG_RefreshToken(t,e),this.state.s_mpn.tk=450,this.state.traceState(),this.evtMpnCheckPending()):(this.doMPNREG_Error(),this.notifyDeviceError_DifferentDevice(),this.state.s_mpn.tk=452,this.state.traceState(),this.evtMpnCheckNext())),!1},evtMPNZERO:function(t){this.traceEvent("MPNZERO"),Ns.isDebugEnabled()&&Ns.debug("MPNZERO "+t),this.state.inPushing()&&(this.isFreshData()?(this.doMPNZERO(t),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtMPNOK:function(t,e){this.traceEvent("MPNOK"),Ns.isDebugEnabled()&&Ns.debug("MPNOK "+t+" "+e),this.state.inPushing()&&(this.isFreshData()?(this.doMPNOK(t,e),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtMPNDEL:function(t){this.traceEvent("MPNDEL"),Ns.isDebugEnabled()&&Ns.debug("MPNDEL "+t),this.state.inPushing()&&(this.isFreshData()?(this.doMPNDEL(t),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtMPNCONF:function(t){this.traceEvent("MPNCONF"),Ns.isDebugEnabled()&&Ns.debug("MPNCONF "+t),this.state.inPushing()&&(this.isFreshData()?(this.doMPNCONF(t),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtDEV_Update:function(t,e){this.traceEvent("DEV.update"),410==this.state.s_mpn.st?"ACTIVE"==t?(Ee.sure(this.mpn_device).isRegistered()||this.notifyDeviceRegistered(e),this.state.s_mpn.st=410,this.state.traceState()):"SUSPENDED"==t&&(Ee.sure(this.mpn_device).isSuspended()||this.notifyDeviceSuspended(e),this.state.s_mpn.st=411,this.state.traceState()):411==this.state.s_mpn.st&&"ACTIVE"==t&&(this.notifyDeviceResume(e),this.state.s_mpn.st=410,this.state.traceState())},evtMpnCheckPending:function(){this.traceEvent("mpn.check.pending"),450==this.state.s_mpn.tk&&(p.empty(this.mpn_candidate_devices)?(this.state.s_mpn.tk=451,this.state.traceState()):(this.state.s_mpn.tk=452,this.state.traceState(),this.evtMpnCheckNext()))},evtSUBS_Init:function(){this.traceEvent("SUBS.init"),420==this.state.s_mpn.sbs&&(this.doClearMpnSnapshot(),this.state.s_mpn.sbs=421,this.state.traceState())},evtSUBS_Update:function(t,e){this.traceEvent("SUBS.update");var i=e.getValue("command"),s=e.getValue("status");null!=this.state.s_mpn.sbs&&this.exists(t)?(this.state.traceState(),this.genSUBS_update(t,e)):421==this.state.s_mpn.sbs&&"DELETE"!=i&&!this.exists(t)||423==this.state.s_mpn.sbs&&"DELETE"!=i&&!this.exists(t)?null==s?(this.doAddToMpnSnapshot(t),this.state.s_mpn.sbs=423,this.state.traceState()):(this.doRemoveFromMpnSnapshot(t),this.doAddMpnSubscription(t),this.state.s_mpn.sbs=423,this.state.traceState(),this.genSUBS_update(t,e)):424!=this.state.s_mpn.sbs||"DELETE"==i||null==s||this.exists(t)||(0==this.mpn_snapshotSet.count()||1==this.mpn_snapshotSet.count()&&this.mpn_snapshotSet.contains(t)?(this.doRemoveFromMpnSnapshot(t),this.doAddMpnSubscription(t),this.state.s_mpn.sbs=424,this.state.traceState(),this.genSUBS_update(t,e),this.notifyOnSubscriptionsUpdated()):(1==this.mpn_snapshotSet.count()&&!this.mpn_snapshotSet.contains(t)||this.mpn_snapshotSet.count()>1)&&(this.doRemoveFromMpnSnapshot(t),this.doAddMpnSubscription(t),this.state.s_mpn.sbs=424,this.state.traceState(),this.genSUBS_update(t,e)))},evtSUBS_EOS:function(){this.traceEvent("SUBS.EOS"),421==this.state.s_mpn.sbs?(this.state.s_mpn.sbs=424,this.state.traceState(),this.genSUBS_EOS(),this.notifyOnSubscriptionsUpdated()):423==this.state.s_mpn.sbs&&(this.mpn_snapshotSet.count()>0?(this.state.s_mpn.sbs=424,this.state.traceState(),this.genSUBS_EOS()):(this.state.s_mpn.sbs=424,this.state.traceState(),this.genSUBS_EOS(),this.notifyOnSubscriptionsUpdated()))},evtExtMpnUnsubscribeFilter:function(){this.traceEvent("mpn.unsubscribe.filter"),431==this.state.s_mpn.ft&&(this.state.s_mpn.ft=430,this.state.traceState(),this.evtMpnCheckFilter())},evtMpnCheckFilter:function(){this.traceEvent("mpn.check.filter"),430==this.state.s_mpn.ft&&(p.empty(this.mpn_filter_pendings)?(this.state.s_mpn.ft=431,this.state.traceState()):(this.state.s_mpn.ft=432,this.state.traceState(),this.genSendMpnUnsubscribeFilter()))},evtExtMpnResetBadge:function(){this.traceEvent("mpn.reset.badge"),441==this.state.s_mpn.bg&&(this.state.s_mpn.bg=440,this.state.traceState(),this.evtMpnCheckReset())},evtMpnCheckReset:function(){this.traceEvent("mpn.check.reset"),440==this.state.s_mpn.bg&&(this.mpn_badge_reset_requested?(this.state.s_mpn.bg=442,this.state.traceState(),this.genSendMpnResetBadge()):(this.state.s_mpn.bg=441,this.state.traceState()))},doREQOK:function(t){D.prototype.doREQOK.call(this,t);for(var e=this.mpnSubscriptionManagers.h;null!=e;){var i=e.item;e=e.next,i.evtREQOK(t)}},doREQERR:function(t,e,i){D.prototype.doREQERR.call(this,t,e,i);for(var s=this.mpnSubscriptionManagers.h;null!=s;){var n=s.item;s=s.next,n.evtREQERR(t,e,i)}},genAbortSubscriptions:function(){D.prototype.genAbortSubscriptions.call(this);for(var t=this.mpnSubscriptionManagers.h;null!=t;){var e=t.item;t=t.next,e.evtAbort()}},getPendingControls:function(){var t=D.prototype.getPendingControls.call(this);this.mpnRegisterRequest.isPending()&&t.push(this.mpnRegisterRequest);for(var e=this.mpnSubscriptionManagers.filter((function(t){return t.isPending()})).h;null!=e;){var i=e.item;e=e.next,t.push(i)}return this.mpnFilterUnsubscriptionRequest.isPending()&&t.push(this.mpnFilterUnsubscriptionRequest),this.mpnBadgeResetRequest.isPending()&&t.push(this.mpnBadgeResetRequest),t},doRegisterMpnDevice:function(){if(p.empty(this.mpn_candidate_devices))throw new be("Assertion failure: !mpn_candidate_devices.empty()");this.mpn_device=this.mpn_candidate_devices.shift()},doRemoveMpnSpecialListeners:function(){this.mpn_deviceSubscription.removeListener(this.mpn_deviceListener),this.mpn_deviceListener.disable(),this.mpn_deviceListener=null,this.mpn_itemSubscription.removeListener(this.mpn_itemListener),this.mpn_itemListener.disable(),this.mpn_itemListener=null},genSendMpnRegister:function(){this.evtSendControl(this.mpnRegisterRequest)},genUnsubscribeMpnSpecialItems:function(){this.client.unsubscribe(Ee.sure(this.mpn_deviceSubscription)),this.client.unsubscribe(Ee.sure(this.mpn_itemSubscription))},doResetMpnDevice:function(){this.mpn_deviceId=null,this.mpn_deviceToken=null,this.mpn_adapterName=null,this.mpn_lastRegisterReqId=null,this.mpn_deviceSubscription=null,this.mpn_itemSubscription=null,this.mpn_deviceListener=null,this.mpn_itemListener=null,this.mpn_snapshotSet.removeAll(),de(this.mpn_filter_pendings),this.mpn_filter_lastDeactivateReqId=null,this.mpn_badge_reset_requested=!1,this.mpn_badge_lastResetReqId=null},notifyDeviceReset:function(){Ee.sure(this.mpn_device).onReset()},notifyDeviceError:function(t,e){Ee.sure(this.mpn_device).onError(t,e)},doMPNREG:function(){this.onFreshData()},doMPNREG_Register:function(t,e){if(null==this.mpn_device)throw new be("Assertion failure: mpn_device != null");this.mpn_deviceId=t,this.mpn_deviceToken=this.mpn_device.getDeviceToken(),this.mpn_adapterName=e,this.mpn_device.setDeviceId(t,e),this.createSpecialItems(t,e)},doMPNZERO:function(t){this.onFreshData(),null!=this.mpn_deviceId&&t==this.mpn_deviceId&&Ee.sure(this.mpn_device).fireOnBadgeReset()},createSpecialItems:function(t,e){this.mpn_deviceListener=new ot(this);var i=new N("MERGE",["DEV-"+t].slice(),["status","status_timestamp"].slice());i.setInternal(),i.setDataAdapter(e),i.setRequestedMaxFrequency("unfiltered"),i.addListener(this.mpn_deviceListener),this.mpn_deviceSubscription=i,this.mpn_itemListener=new ht(this);var s=new N("COMMAND",["SUBS-"+t].slice(),["key","command"].slice());s.setInternal(),s.setDataAdapter(e),s.setRequestedMaxFrequency("unfiltered"),s.setCommandSecondLevelFields(["status","status_timestamp","notification_format","trigger","group","schema","adapter","mode","requested_buffer_size","requested_max_frequency"].slice()),s.setCommandSecondLevelDataAdapter(e),s.addListener(this.mpn_itemListener),this.mpn_itemSubscription=s},genDeviceActive:function(){for(var t=this.mpnSubscriptionManagers.h;null!=t;){var e=t.item;t=t.next,e.evtDeviceActive()}},genSubscribeSpecialItems:function(){if(null==this.mpn_deviceSubscription)throw new be("Assertion failure: mpn_deviceSubscription != null");if(null==this.mpn_itemSubscription)throw new be("Assertion failure: mpn_itemSubscription != null");this.subscribeExt(this.mpn_deviceSubscription,!0),this.subscribeExt(this.mpn_itemSubscription,!0)},doMPNREG_Error:function(){},notifyDeviceError_DifferentDevice:function(){Ee.sure(this.mpn_device).onError(62,"DeviceId or Adapter Name has unexpectedly been changed")},doMPNREG_RefreshToken:function(t,e){if(null==this.mpn_device)throw new be("Assertion failure: mpn_device != null");this.mpn_deviceToken=this.mpn_device.getDeviceToken(),this.mpn_device.setDeviceId(t,e)},notifyDeviceRegistered:function(t){Ee.sure(this.mpn_device).onRegistered(t)},notifyDeviceSuspended:function(t){Ee.sure(this.mpn_device).onSuspend(t)},notifyDeviceResume:function(t){Ee.sure(this.mpn_device).onResume(t)},doClearMpnSnapshot:function(){this.mpn_snapshotSet.removeAll()},exists:function(t){return p.exists(this.mpnSubscriptionManagers,(function(e){return e.fetch_mpnSubId()==t}))},genSUBS_update:function(t,e){for(var i=this.mpnSubscriptionManagers.h;null!=i;){var s=i.item;i=i.next,t==s.fetch_mpnSubId()&&s.evtMpnUpdate(e)}},doAddToMpnSnapshot:function(t){this.mpn_snapshotSet.insert(t)},doRemoveFromMpnSnapshot:function(t){this.mpn_snapshotSet.remove(t)},doAddMpnSubscription:function(t){new mt(ft.Ctor2(t,this)).start()},notifyOnSubscriptionsUpdated:function(){Ee.sure(this.mpn_device).fireOnSubscriptionsUpdated()},genSUBS_EOS:function(){for(var t=this.mpnSubscriptionManagers.h;null!=t;){var e=t.item;t=t.next,e.evtMpnEOS()}},genSendMpnUnsubscribeFilter:function(){this.evtSendControl(this.mpnFilterUnsubscriptionRequest)},genSendMpnResetBadge:function(){this.evtSendControl(this.mpnBadgeResetRequest)},doREQMpnUnsubscribeFilter:function(){this.mpn_filter_pendings.shift()},doREQOKMpnResetBadge:function(){this.mpn_badge_reset_requested=!1},doREQERRMpnResetBadge:function(){this.mpn_badge_reset_requested=!1},notifyOnBadgeResetFailed:function(t,e){Ee.sure(this.mpn_device).fireOnBadgeResetFailed(t,e)},doMPNOK:function(t,e){this.onFreshData();for(var i=this.mpnSubscriptionManagers.h;null!=i;){var s=i.item;i=i.next,s.m_subId==t&&s.evtMPNOK(e)}},doMPNDEL:function(t){this.onFreshData();for(var e=this.mpnSubscriptionManagers.h;null!=e;){var i=e.item;e=e.next,i.fetch_mpnSubId()==t&&i.evtMPNDEL()}},doMPNCONF:function(t){this.onFreshData()},encodeMpnRegister:function(){if(null==this.mpn_device)throw new be("Assertion failure: mpn_device != null");var t=new Me,e=this.mpn_device.getDeviceToken(),i=this.mpn_device.getPreviousDeviceToken();return this.mpn_lastRegisterReqId=this.generateFreshReqId(),t.LS_reqId(this.mpn_lastRegisterReqId),t.LS_op("register"),t.PN_type(this.mpn_device.getPlatform()),t.PN_appId(this.mpn_device.getApplicationId()),null==i||i==e?t.PN_deviceToken(e):(t.PN_deviceToken(i),t.PN_newDeviceToken(e)),Ns.isInfoEnabled()&&Ns.info("Sending MPNDevice register: "+m.string(t)),t.getEncodedString()},encodeMpnRefreshToken:function(){if(null==this.mpn_device)throw new be("Assertion failure: mpn_device != null");var t=new Me;return this.mpn_lastRegisterReqId=this.generateFreshReqId(),t.LS_reqId(this.mpn_lastRegisterReqId),t.LS_op("register"),t.PN_type(this.mpn_device.getPlatform()),t.PN_appId(this.mpn_device.getApplicationId()),t.PN_deviceToken(Ee.sure(this.mpn_deviceToken)),t.PN_newDeviceToken(this.mpn_device.getDeviceToken()),t.LS_cause("refresh.token"),Ns.isInfoEnabled()&&Ns.info("Sending MPNDevice refresh: "+m.string(t)),t.getEncodedString()},encodeMpnRestore:function(){if(null==this.mpn_device)throw new be("Assertion failure: mpn_device != null");var t=new Me;return this.mpn_lastRegisterReqId=this.generateFreshReqId(),t.LS_reqId(this.mpn_lastRegisterReqId),t.LS_op("register"),t.PN_type(this.mpn_device.getPlatform()),t.PN_appId(this.mpn_device.getApplicationId()),t.PN_deviceToken(Ee.sure(this.mpn_deviceToken)),t.PN_newDeviceToken(this.mpn_device.getDeviceToken()),t.LS_cause("restore.token"),Ns.isInfoEnabled()&&Ns.info("Sending MPNDevice restore: "+m.string(t)),t.getEncodedString()},encodeDeactivateFilter:function(){var t=new Me;switch(this.mpn_filter_lastDeactivateReqId=this.generateFreshReqId(),t.LS_reqId(this.mpn_filter_lastDeactivateReqId),t.LS_op("deactivate"),t.PN_deviceId(Ee.sure(this.mpn_deviceId)),this.mpn_filter_pendings[0]._hx_index){case 1:t.PN_subscriptionStatus("ACTIVE");break;case 2:t.PN_subscriptionStatus("TRIGGERED")}return Ns.isInfoEnabled()&&Ns.info("Sending multiple MPNSubscription deactivate: "+m.string(t)),t.getEncodedString()},encodeBadgeReset:function(){var t=new Me;return this.mpn_badge_lastResetReqId=this.generateFreshReqId(),t.LS_reqId(this.mpn_badge_lastResetReqId),t.LS_op("reset_badge"),t.PN_deviceId(Ee.sure(this.mpn_deviceId)),Ns.isInfoEnabled()&&Ns.info("Sending MPNDevice badge reset: "+m.string(t)),t.getEncodedString()},relate:function(t){if(p.has(this.mpnSubscriptionManagers,t))throw new be("Assertion failure: !mpnSubscriptionManagers.contains(subManager)");this.mpnSubscriptionManagers.add(t)},unrelate:function(t){this.mpnSubscriptionManagers.remove(t)},fetch_mpn_deviceId:function(){return this.mpn_deviceId},fetch_mpn_device:function(){return this.mpn_device},registerForMpn:function(t){if(null==t)throw new T("Device cannot be null");this.mpn_candidate_devices.push(t),Ps.isInfoEnabled()&&Ps.info("MPN registration requested: "+m.string(t)),this.evtExtMpnRegister()},subscribeMpn:function(t,e){if(null==this.mpn_device)throw new be(ws);if(t.isActive())throw new T(Es);if(null==t.getNotificationFormat())throw new T(Ts);if(null==t.getItems()&&null==t.getItemGroup())throw new T("Specify property 'items' or 'itemGroup'");if(null==t.getFields()&&null==t.getFieldSchema())throw new T("Specify property 'fields' or 'fieldSchema'");var i=new mt(ft.Ctor1(t,e,this));Ps.isInfoEnabled()&&Ps.info("MPN Subscription requested: subId: "+i.m_subId+" "+m.string(t)+" coalescing: "+(null==e?"null":""+e)),i.evtExtMpnSubscribe()},unsubscribeMpn:function(t){if(null==this.mpn_device)throw new be(ws);var e=t.fetch_subManager();if(null!=e){if(!p.has(this.mpnSubscriptionManagers,e))throw new be("The MPNSubscription is not subscribed to this Client");Ps.isInfoEnabled()&&Ps.info("MPN Unsubscription requested: pnSubId: "+t.getSubscriptionId()+" "+m.string(t)),e.evtExtMpnUnsubscribe()}},unsubscribeMpnSubscriptions:function(t){if(null==this.mpn_device)throw new be(ws);var e=lt(t);this.mpn_filter_pendings.push(e),Ps.isInfoEnabled()&&Ps.info("Multiple MPN Unsubscriptions requested: "+m.string(e)),this.evtExtMpnUnsubscribeFilter()},getMpnSubscriptions:function(t){if(null==this.mpn_device)throw new be(ws);var e;switch(lt(t)._hx_index){case 0:e=this.mpnSubscriptionManagers.map((function(t){return t.m_subscription})).filter((function(t){return t.fetch_status()==re.Subscribed||t.fetch_status()==re.Triggered}));break;case 1:e=this.mpnSubscriptionManagers.map((function(t){return t.m_subscription})).filter((function(t){return t.fetch_status()==re.Subscribed}));break;case 2:e=this.mpnSubscriptionManagers.map((function(t){return t.m_subscription})).filter((function(t){return t.fetch_status()==re.Triggered}))}for(var i=Object.create(null),s=e.h;null!=s;){var n=s.item;s=s.next;var r=n.getSubscriptionId();if(null!=r){var a=i[r];null==a?i[r]=[n]:a.push(n)}}for(var o=[],h=Object.keys(i),l=h.length,u=0;u<l;){for(var c=i[h[u++]],d=!1,_=0;_<c.length;){var p=c[_];if(++_,!p.fetch_madeByServer()){o.push(p),d=!0;break}}d||null==c[0]||o.push(c[0])}return o},findMpnSubscription:function(t){if(null==t)throw new T("Subscription id must be not null");if(null==this.mpn_device)throw new be(ws);for(var e=this.mpnSubscriptionManagers.h;null!=e;){var i=e.item;if(e=e.next,i.m_subscription.getSubscriptionId()==t)return i.m_subscription}return null},__class__:nt});var rt=a["com.lightstreamer.client.internal._MpnClientMachine.MPNSubscriptionStatus"]={__ename__:!0,__constructs__:null,ALL:{_hx_name:"ALL",_hx_index:0,__enum__:"com.lightstreamer.client.internal._MpnClientMachine.MPNSubscriptionStatus",toString:r},SUBSCRIBED:{_hx_name:"SUBSCRIBED",_hx_index:1,__enum__:"com.lightstreamer.client.internal._MpnClientMachine.MPNSubscriptionStatus",toString:r},TRIGGERED:{_hx_name:"TRIGGERED",_hx_index:2,__enum__:"com.lightstreamer.client.internal._MpnClientMachine.MPNSubscriptionStatus",toString:r}};rt.__constructs__=[rt.ALL,rt.SUBSCRIBED,rt.TRIGGERED];var at=function(t){this.m_disabled=!1,this.client=t};at.__name__="com.lightstreamer.client.internal._MpnClientMachine.SubscriptionDelegateBase",at.__interfaces__=[h],at.prototype={disable:function(){var t=this;Ie.synchronized(this.client.lock,(function(){return t.m_disabled=!0}))},synchronized:function(t){var e=this;Ie.synchronized(this.client.lock,(function(){e.m_disabled||t()}))},onClearSnapshot:function(t,e){},onCommandSecondLevelItemLostUpdates:function(t,e){},onCommandSecondLevelSubscriptionError:function(t,e,i){},onEndOfSnapshot:function(t,e){},onItemLostUpdates:function(t,e,i){},onItemUpdate:function(t){},onListenEnd:function(t){},onListenStart:function(t){},onSubscription:function(){},onSubscriptionError:function(t,e){},onUnsubscription:function(){},onRealMaxFrequency:function(t){},__class__:at};var ot=function(t){at.call(this,t)};ot.__name__="com.lightstreamer.client.internal._MpnClientMachine.MpnDeviceDelegate",ot.__super__=at,ot.prototype=l(at.prototype,{onItemUpdate:function(t){var e=this;this.synchronized((function(){var i=t.getValue("status"),s=t.getValue("status_timestamp");null!=i&&e.client.evtDEV_Update(i,bt(null!=s?s:"0"))}))},onSubscriptionError:function(t,e){var i=this;this.synchronized((function(){i.client.evtMpnError(62,"MPN device activation can't be completed (62/1)")}))},onUnsubscription:function(){var t=this;this.synchronized((function(){t.client.evtMpnError(62,"MPN device activation can't be completed (62/2)")}))},__class__:ot});var ht=function(t){at.call(this,t)};function lt(t){if(null==t)return rt.ALL;switch(t){case"ALL":return rt.ALL;case"SUBSCRIBED":return rt.SUBSCRIBED;case"TRIGGERED":return rt.TRIGGERED;default:throw new T("The given value is not valid for this setting. Use null, ALL, TRIGGERED or SUBSCRIBED instead")}}ht.__name__="com.lightstreamer.client.internal._MpnClientMachine.MpnItemDelegate",ht.__super__=at,ht.prototype=l(at.prototype,{onItemUpdate:function(t){var e=this;this.synchronized((function(){var i=t.getValue("key");null!=i&&e.client.evtSUBS_Update(i.substring(4),t)}))},onEndOfSnapshot:function(t,e){var i=this;this.synchronized((function(){i.client.evtSUBS_EOS()}))},onSubscriptionError:function(t,e){var i=this;this.synchronized((function(){i.client.evtMpnError(62,"MPN device activation can't be completed (62/3)")}))},onUnsubscription:function(){var t=this;this.synchronized((function(){t.client.evtMpnError(62,"MPN device activation can't be completed (62/4)")}))},onCommandSecondLevelSubscriptionError:function(t,e,i){this.synchronized((function(){qs.isWarnEnabled()&&qs.warn("MPN device can't complete the subscription of "+i)}))},__class__:ht});var ut=function(t){this.client=t};ut.__name__="com.lightstreamer.client.internal.MpnRegisterRequest",ut.__interfaces__=[U],ut.prototype={isPending:function(){return 403==this.client.state.s_mpn.m||406==this.client.state.s_mpn.m||453==this.client.state.s_mpn.tk},encode:function(t){if(403==this.client.state.s_mpn.m)return this.client.encodeMpnRegister();if(406==this.client.state.s_mpn.m)return this.client.encodeMpnRestore();if(453==this.client.state.s_mpn.tk)return this.client.encodeMpnRefreshToken();throw new be("Can't encode register request")},encodeWS:function(){return"control\r\n"+this.encode(!0)},__class__:ut};var ct=function(t){this.client=t};ct.__name__="com.lightstreamer.client.internal.MpnFilterUnsubscriptionRequest",ct.__interfaces__=[U],ct.prototype={isPending:function(){return 432==this.client.state.s_mpn.ft},encode:function(t){if(this.isPending())return this.client.encodeDeactivateFilter();throw new be("Can't encode unsubscription request")},encodeWS:function(){return"control\r\n"+this.encode(!0)},__class__:ct};var dt=function(t){this.client=t};dt.__name__="com.lightstreamer.client.internal.MpnBadgeResetRequest",dt.__interfaces__=[U],dt.prototype={isPending:function(){return 442==this.client.state.s_mpn.bg},encode:function(t){if(this.isPending())return this.client.encodeBadgeReset();throw new be("Can't encode badge reset request")},encodeWS:function(){return"control\r\n"+this.encode(!0)},__class__:dt};var _t=function(){this.m=400};_t.__name__="com.lightstreamer.client.internal.StateVar_mpn",_t.prototype={toString:function(){var t="<mpn_m="+this.m;return null!=this.st&&(t+=" mpn_st="+this.st),null!=this.tk&&(t+=" mpn_tk="+this.tk),null!=this.sbs&&(t+=" mpn_sbs="+this.sbs),null!=this.ft&&(t+=" mpn_ft="+this.ft),null!=this.bg&&(t+=" mpn_bg="+this.bg),t+=">"},__class__:_t};var pt=function(t,e){this.s_tu=30,this.s_fu=20,this.s_uu=10,this.s_m=t,this.manager=e};pt.__name__="com.lightstreamer.client.internal._MpnSubscriptionManager.State",pt.prototype={toString:function(){var t="<m="+this.s_m;return t+=" uu="+this.s_uu,t+=" fu="+this.s_fu,t+=" tu="+this.s_tu,null!=this.s_st&&(t+=" st="+this.s_st),null!=this.s_ab&&(t+=" ab="+this.s_ab),null!=this.s_ct&&(t+=" ct="+this.s_ct),t+=">"},traceState:function(){Ds.isTraceEnabled()&&Ds.trace("mpn#sub#goto("+this.manager.m_subId+":"+this.manager.fetch_mpnSubId()+") "+this.toString())},__class__:pt};var ft=a["com.lightstreamer.client.internal._MpnSubscriptionManager.CtorArgs"]={__ename__:!0,__constructs__:null,Ctor1:(e=function(t,e,i){return{_hx_index:0,sub:t,coalescing:e,client:i,__enum__:"com.lightstreamer.client.internal._MpnSubscriptionManager.CtorArgs",toString:r}},e._hx_name="Ctor1",e.__params__=["sub","coalescing","client"],e),Ctor2:(e=function(t,e){return{_hx_index:1,mpnSubId:t,client:e,__enum__:"com.lightstreamer.client.internal._MpnSubscriptionManager.CtorArgs",toString:r}},e._hx_name="Ctor2",e.__params__=["mpnSubId","client"],e)};ft.__constructs__=[ft.Ctor1,ft.Ctor2];var mt=function(t){var e=null,i=null,s=null,n=null;switch(t._hx_index){case 0:e=t.sub,i=t.coalescing,s=t.client;break;case 1:n=t.mpnSubId,s=t.client}null==n?(this.lock=s.lock,this.m_subId=s.generateFreshSubId(),this.m_coalescing=i,this.m_initFormat=e.getNotificationFormat(),this.m_initTrigger=e.getTriggerExpression(),this.m_subscription=e,this.m_client=s,this.state=new pt(40,this),this.m_subscription.relate(this),this.m_client.relate(this)):(this.lock=s.lock,this.m_subId=null,this.m_coalescing=!1,this.m_initFormat=null,this.m_initTrigger=null,this.m_subscription=new oe("MERGE",null,null),this.m_subscription.reInit(n),this.m_client=s,this.state=new pt(45,this),this.m_subscription.relate(this),this.m_client.relate(this))};mt.__name__="com.lightstreamer.client.internal.MpnSubscriptionManager",mt.__interfaces__=[U],mt.prototype={finalize:function(){this.m_subscription.reset(),this.m_client.unrelate(this),this.m_subscription.unrelate(this)},fetch_mpnSubId:function(){return this.m_subscription.fetch_mpnSubId()},start:function(){},evtExtMpnUnsubscribe:function(){this.traceEvent("unsubscribe");var t=!0;41==this.state.s_m?(this.notifyStatus(re.Unknown),this.notifyOnSubscriptionDiscarded(),this.finalize(),this.state.s_m=50,this.state.traceState(),t=this.evtExtMpnUnsubscribe_UnsubRegion()):71==this.state.s_ct&&(this.state.s_ct=70,this.state.traceState(),t=this.evtExtMpnUnsubscribe_UnsubRegion(),this.evtCheck()),t&&this.evtExtMpnUnsubscribe_UnsubRegion()},evtExtMpnUnsubscribe_UnsubRegion:function(){return this.traceEvent("unsubscribe"),(10==this.state.s_uu||12==this.state.s_uu)&&(this.state.s_uu=11,this.state.traceState()),!1},evtAbort:function(){this.traceEvent("abort"),41==this.state.s_m?(this.notifyStatus(re.Unknown),this.notifyOnSubscriptionDiscarded(),this.finalize(),this.state.s_m=50,this.state.traceState()):42==this.state.s_m||43==this.state.s_m?(this.notifyStatus(re.Unknown),this.notifyOnSubscriptionAbort(),this.finalize(),this.state.s_m=50,this.state.traceState()):44==this.state.s_m&&(this.state.s_m=44,this.state.traceState(),this.evtAbort_AbortRegion())},evtAbort_AbortRegion:function(){this.traceEvent("abort");var t=!0;80==this.state.s_ab&&(this.state.s_ab=81,this.state.traceState(),t=this.evtAbort_ControlRegion()),t&&(t=this.evtAbort_ControlRegion())},evtAbort_ControlRegion:function(){return this.traceEvent("abort"),70!=this.state.s_ct&&71!=this.state.s_ct&&72!=this.state.s_ct&&73!=this.state.s_ct&&74!=this.state.s_ct||(this.state.s_ct=76,this.state.traceState(),this.evtAbortFormat(),this.evtAbortTrigger(),this.evtAbortUnsubscribe()),!1},evtRestoreSession:function(){this.traceEvent("restore.session"),76==this.state.s_ct&&(this.state.s_ct=70,this.state.traceState(),this.evtCheck())},evtREQOK:function(t){this.traceEvent("REQOK");var e=!0;22==this.state.s_fu&&t==this.m_lastConfigureReqId?(this.state.s_fu=20,this.state.traceState(),e=this.evtREQOK_TriggerRegion(t)):23==this.state.s_fu&&t==this.m_lastConfigureReqId&&(this.state.s_fu=21,this.state.traceState(),e=this.evtREQOK_TriggerRegion(t)),e&&this.evtREQOK_TriggerRegion(t)},evtREQOK_TriggerRegion:function(t){this.traceEvent("REQOK");var e=!0;return 32==this.state.s_tu&&t==this.m_lastConfigureReqId?(this.state.s_tu=30,this.state.traceState(),e=this.evtREQOK_MainRegion(t)):33==this.state.s_tu&&t==this.m_lastConfigureReqId&&(this.state.s_tu=31,this.state.traceState(),e=this.evtREQOK_MainRegion(t)),e&&this.evtREQOK_MainRegion(t),!1},evtREQOK_MainRegion:function(t){return this.traceEvent("REQOK"),42==this.state.s_m&&t==this.m_lastActivateReqId?(this.state.s_m=43,this.state.traceState()):44==this.state.s_m&&(this.state.s_m=44,this.state.traceState(),this.evtREQOK_ControlRegion(t)),!1},evtREQOK_ControlRegion:function(t){this.traceEvent("REQOK"),72==this.state.s_ct&&t==this.m_lastDeactivateReqId?(this.notifyStatus(re.Unknown),this.notifyOnUnsubscription(),this.notifyOnSubscriptionsUpdated(),this.finalize(),this.state.s_m=52,this.state.s_st=null,this.state.s_ct=null,this.state.s_ab=null,this.state.traceState()):73!=this.state.s_ct&&74!=this.state.s_ct||t!=this.m_lastConfigureReqId||(this.state.s_ct=70,this.state.traceState(),this.evtCheck())},evtREQERR:function(t,e,i){this.traceEvent("REQERR");var s=!0;11==this.state.s_uu&&t==this.m_lastDeactivateReqId&&(this.notifyOnUnsubscriptionError(e,i),this.state.s_uu=12,this.state.traceState(),s=this.evtREQERR_FormatRegion(t,e,i)),s&&(s=this.evtREQERR_FormatRegion(t,e,i))},evtREQERR_FormatRegion:function(t,e,i){this.traceEvent("REQERR");var s=!0;return 22==this.state.s_fu&&t==this.m_lastConfigureReqId?(this.notifyOnModificationError_Format(e,i),this.state.s_fu=20,this.state.traceState(),s=this.evtREQERR_TriggerRegion(t,e,i)):23==this.state.s_fu&&t==this.m_lastConfigureReqId&&(this.state.s_fu=21,this.state.traceState(),s=this.evtREQERR_TriggerRegion(t,e,i)),s&&this.evtREQERR_TriggerRegion(t,e,i),!1},evtREQERR_TriggerRegion:function(t,e,i){this.traceEvent("REQERR");var s=!0;return 32==this.state.s_tu&&t==this.m_lastConfigureReqId?(this.notifyOnModificationError_Trigger(e,i),this.state.s_tu=30,this.state.traceState(),s=this.evtREQERR_MainRegion(t,e,i)):33==this.state.s_tu&&t==this.m_lastConfigureReqId&&(this.state.s_tu=31,this.state.traceState(),s=this.evtREQERR_MainRegion(t,e,i)),s&&this.evtREQERR_MainRegion(t,e,i),!1},evtREQERR_MainRegion:function(t,e,i){return this.traceEvent("REQERR"),42==this.state.s_m&&t==this.m_lastActivateReqId?(this.notifyStatus(re.Unknown),this.notifyOnSubscriptionError(e,i),this.finalize(),this.state.s_m=50,this.state.traceState()):44==this.state.s_m&&(this.state.s_m=44,this.state.traceState(),this.evtREQERR_ControlRegion(t,e,i)),!1},evtREQERR_ControlRegion:function(t,e,i){this.traceEvent("REQERR"),72==this.state.s_ct&&t==this.m_lastDeactivateReqId?(this.state.s_ct=70,this.state.traceState(),this.evtCheck()):73!=this.state.s_ct&&74!=this.state.s_ct||t!=this.m_lastConfigureReqId||(this.state.s_ct=70,this.state.traceState(),this.evtCheck())},evtAbortUnsubscribe:function(){this.traceEvent("abort.unsubscribe"),11==this.state.s_uu&&(this.notifyOnUnsubscriptionAbort(),this.state.s_uu=12,this.state.traceState())},evtExtMpnSetFormat:function(){this.traceEvent("setFormat");var t=!0;20==this.state.s_fu?(this.state.s_fu=21,this.state.traceState(),t=this.evtExtMpnSetFormat_ControlRegion()):22==this.state.s_fu&&(this.state.s_fu=23,this.state.traceState(),t=this.evtExtMpnSetFormat_ControlRegion()),t&&this.evtExtMpnSetFormat_ControlRegion()},evtExtMpnSetFormat_ControlRegion:function(){return this.traceEvent("setFormat"),71==this.state.s_ct&&(this.state.s_ct=70,this.state.traceState(),this.evtCheck()),!1},evtExtMpnSetTrigger:function(){this.traceEvent("setTrigger");var t=!0;30==this.state.s_tu?(this.state.s_tu=31,this.state.traceState(),t=this.evtExtMpnSetTrigger_ControlRegion()):32==this.state.s_tu&&(this.state.s_tu=33,this.state.traceState(),t=this.evtExtMpnSetTrigger_ControlRegion()),t&&this.evtExtMpnSetTrigger_ControlRegion()},evtExtMpnSetTrigger_ControlRegion:function(){return this.traceEvent("setTrigger"),71==this.state.s_ct&&(this.state.s_ct=70,this.state.traceState(),this.evtCheck()),!1},evtChangeFormat:function(){this.traceEvent("change.format"),21==this.state.s_fu&&(this.doSetCurrentFormat(),this.state.s_fu=22,this.state.traceState())},evtChangeTrigger:function(){this.traceEvent("change.trigger"),31==this.state.s_tu&&(this.doSetCurrentTrigger(),this.state.s_tu=32,this.state.traceState())},evtAbortFormat:function(){switch(this.traceEvent("abort.format"),this.state.s_fu){case 21:case 22:case 23:this.notifyOnModificationAbort_Format(),this.state.s_fu=20,this.state.traceState()}},evtAbortTrigger:function(){switch(this.traceEvent("abort.trigger"),this.state.s_tu){case 31:case 32:case 33:this.notifyOnModificationAbort_Trigger(),this.state.s_tu=30,this.state.traceState()}},evtCheck:function(){this.traceEvent("check"),70==this.state.s_ct&&(11==this.state.s_uu?(this.state.s_ct=72,this.state.traceState(),this.genSendUnsubscribe()):21==this.state.s_fu?(this.state.s_ct=74,this.state.traceState(),this.evtChangeFormat(),this.genSendConfigure()):31==this.state.s_tu?(this.state.s_ct=73,this.state.traceState(),this.evtChangeTrigger(),this.genSendConfigure()):(this.state.s_ct=71,this.state.traceState()))},evtExtMpnSubscribe:function(){this.traceEvent("subscribe"),40==this.state.s_m&&(405==this.m_client.state.s_mpn.m?(this.notifyStatus(re.Active),this.state.s_m=42,this.state.traceState(),this.genSendSubscribe()):(this.notifyStatus(re.Active),this.state.s_m=41,this.state.traceState()))},evtDeviceActive:function(){this.traceEvent("device.active"),41==this.state.s_m&&(this.state.s_m=42,this.state.traceState(),this.genSendSubscribe())},evtMPNOK:function(t){this.traceEvent("MPNOK"),(42==this.state.s_m||43==this.state.s_m)&&(this.doMPNOK(t),this.notifyStatus(re.Subscribed),this.notifyOnSubscription(),this.notifyOnSubscriptionsUpdated(),this.state.s_m=44,this.state.s_st=60,this.state.s_ct=70,this.state.s_ab=80,this.state.traceState(),this.evtCheck())},evtMPNDEL:function(){this.traceEvent("MPNDEL"),72==this.state.s_ct&&(this.notifyStatus(re.Unknown),this.notifyOnUnsubscription(),this.notifyOnSubscriptionsUpdated(),this.finalize(),this.state.s_m=52,this.state.s_st=null,this.state.s_ct=null,this.state.s_ab=null,this.state.traceState())},evtMpnUpdate:function(t){this.traceEvent("update");var e=t.getValue("status_timestamp"),i=t.getValue("status");i=null!=i?i.toUpperCase():null;var s=t.getValue("command");s=null!=s?s.toUpperCase():null,44==this.state.s_m&&"DELETE"==s?(this.notifyStatus(re.Unknown),this.notifyOnUnsubscription(),this.notifyOnSubscriptionsUpdated(),this.finalize(),this.state.s_m=52,this.state.s_st=null,this.state.s_ct=null,this.state.s_ab=null,this.state.traceState()):45==this.state.s_m?"ACTIVE"==i?(this.notifyStatus(re.Subscribed,e),this.notifyOnSubscription(),this.notifyUpdate(t),this.state.s_m=44,this.state.s_st=60,this.state.s_ct=70,this.state.s_ab=80,this.state.traceState(),this.evtCheck()):"TRIGGERED"==i&&(this.notifyStatus(re.Triggered,e),this.notifyOnSubscription(),this.notifyOnTriggered(),this.notifyUpdate(t),this.state.s_m=44,this.state.s_st=61,this.state.s_ct=70,this.state.s_ab=80,this.state.traceState(),this.evtCheck()):44==this.state.s_m&&(this.state.s_m=44,this.state.traceState(),this.evtMpnUpdate_AbortRegion(t))},evtMpnUpdate_AbortRegion:function(t){this.traceEvent("update");var e=!0;81==this.state.s_ab&&(this.state.s_ab=80,this.state.traceState(),e=this.evtMpnUpdate_StatusRegion(t),this.evtRestoreSession()),e&&(e=this.evtMpnUpdate_StatusRegion(t))},evtMpnUpdate_StatusRegion:function(t){this.traceEvent("update");var e=t.getValue("status_timestamp"),i=t.getValue("status");return i=null!=i?i.toUpperCase():null,60==this.state.s_st?"ACTIVE"==i?(this.notifyUpdate(t),this.state.s_st=60,this.state.traceState()):"TRIGGERED"==i&&(this.notifyStatus(re.Triggered,e),this.notifyOnTriggered(),this.notifyUpdate(t),this.state.s_st=61,this.state.traceState()):61==this.state.s_st&&("ACTIVE"==i?(this.notifyStatus(re.Subscribed,e),this.notifyUpdate(t),this.state.s_st=60,this.state.traceState()):"TRIGGERED"==i&&(this.notifyUpdate(t),this.state.s_st=61,this.state.traceState())),!1},evtMpnEOS:function(){this.traceEvent("EOS"),81==this.state.s_ab&&(this.notifyStatus(re.Unknown),this.notifyOnUnsubscription(),this.notifyOnSubscriptionsUpdated(),this.finalize(),this.state.s_m=51,this.state.s_st=null,this.state.s_ct=null,this.state.s_ab=null,this.state.traceState())},isPending:function(){return 42==this.state.s_m||72==this.state.s_ct||73==this.state.s_ct||74==this.state.s_ct},encode:function(t){if(42==this.state.s_m)return this.encodeActivate();if(72==this.state.s_ct)return this.encodeDeactivate();if(73==this.state.s_ct||74==this.state.s_ct)return this.encodeConfigure();throw new be("Can't encode request")},encodeWS:function(){return"control\r\n"+this.encode(!0)},encodeActivate:function(){var t=new Me;this.m_lastActivateReqId=this.m_client.generateFreshReqId(),t.LS_reqId(this.m_lastActivateReqId),t.LS_op("activate"),t.LS_subId(Ee.sure(this.m_subId)),t.LS_mode(Ee.sure(this.m_subscription.fetch_mode()));var e=this.m_subscription.getItemGroup(),i=this.m_subscription.getItems();null!=e?t.LS_group(e):null!=i&&t.LS_group(i.slice().join(" "));var s=this.m_subscription.getFieldSchema(),n=this.m_subscription.getFields();null!=s?t.LS_schema(s):null!=n&&t.LS_schema(n.slice().join(" "));var r=this.m_subscription.getDataAdapter();null!=r&&t.LS_data_adapter(r);var a=this.m_subscription.fetch_requestedMaxFrequency();if(null!=a)switch(a._hx_index){case 0:t.LS_requested_max_frequency_Float(a.max);break;case 1:t.LS_requested_max_frequency("unlimited")}var o=this.m_subscription.fetch_requestedBufferSize();if(null!=o)switch(o._hx_index){case 0:t.LS_requested_buffer_size_Int(o.size);break;case 1:t.LS_requested_buffer_size("unlimited")}t.PN_deviceId(Ee.sure(this.m_client.fetch_mpn_deviceId())),t.PN_notificationFormat(Ee.sure(this.m_initFormat));var h=this.m_initTrigger;return null!=h&&t.PN_trigger(h),this.m_coalescing&&t.PN_coalescing(!0),Ns.isInfoEnabled()&&Ns.info("Sending MPNSubscription activate: "+m.string(t)),t.getEncodedString()},encodeDeactivate:function(){var t=new Me;return this.m_lastDeactivateReqId=this.m_client.generateFreshReqId(),t.LS_reqId(this.m_lastDeactivateReqId),t.LS_op("deactivate"),t.PN_deviceId(Ee.sure(this.m_client.fetch_mpn_deviceId())),t.PN_subscriptionId(Ee.sure(this.m_subscription.getSubscriptionId())),Ns.isInfoEnabled()&&Ns.info("Sending MPNSubscription deactivate: "+m.string(t)),t.getEncodedString()},encodeConfigure:function(){var t=new Me;this.m_lastConfigureReqId=this.m_client.generateFreshReqId(),t.LS_reqId(this.m_lastConfigureReqId),t.LS_op("pn_reconf"),t.LS_mode(Ee.sure(this.m_subscription.fetch_mode()));var e=this.m_subscription.getItemGroup(),i=this.m_subscription.getItems();null!=e?t.LS_group(e):null!=i&&t.LS_group(i.slice().join(" "));var s=this.m_subscription.getFieldSchema(),n=this.m_subscription.getFields();null!=s?t.LS_schema(s):null!=n&&t.LS_schema(n.slice().join(" "));var r=this.m_subscription.getDataAdapter();if(null!=r&&t.LS_data_adapter(r),t.PN_deviceId(Ee.sure(this.m_client.fetch_mpn_deviceId())),t.PN_subscriptionId(Ee.sure(this.m_subscription.getSubscriptionId())),74==this.state.s_ct&&t.PN_notificationFormat(Ee.sure(this.m_currentFormat)),73==this.state.s_ct){var a=this.m_currentTrigger;t.PN_trigger(null!=a?a:"")}return Ns.isInfoEnabled()&&Ns.info("Sending MPNSubscription configuration: "+m.string(t)),t.getEncodedString()},genSendSubscribe:function(){this.m_client.evtSendControl(this)},genSendConfigure:function(){this.m_client.evtSendControl(this)},genSendUnsubscribe:function(){this.m_client.evtSendControl(this)},notifyStatus:function(t,e){this.m_subscription.changeStatus(t,e)},notifyOnSubscriptionError:function(t,e){this.m_subscription.fireOnSubscriptionError(t,e)},notifyOnSubscriptionAbort:function(){this.m_subscription.fireOnSubscriptionError(54,"The request was aborted because the operation could not be completed")},notifyOnSubscriptionDiscarded:function(){this.m_subscription.fireOnSubscriptionError(55,"The request was discarded because the operation could not be completed")},notifyOnUnsubscriptionError:function(t,e){this.m_subscription.fireOnUnsubscriptionError(t,e)},notifyOnUnsubscriptionAbort:function(){this.m_subscription.fireOnUnsubscriptionError(54,"The request was aborted because the operation could not be completed")},doMPNOK:function(t){this.m_subscription.setSubscriptionId(t)},notifyOnSubscription:function(){this.m_subscription.fireOnSubscription()},notifyOnUnsubscription:function(){this.m_subscription.fireOnUnsubscription()},notifyOnTriggered:function(){this.m_subscription.fireOnTriggered()},notifyOnSubscriptionsUpdated:function(){Ee.sure(this.m_client.fetch_mpn_device()).fireOnSubscriptionsUpdated()},notifyUpdate:function(t){this.m_subscription.changeStatusTs(t.getValue("status_timestamp")),this.m_subscription.changeMode(t.getValue("mode")),this.m_subscription.changeAdapter(t.getValue("adapter")),this.m_subscription.changeGroup(t.getValue("group")),this.m_subscription.changeSchema(t.getValue("schema")),this.m_subscription.changeFormat(t.getValue("notification_format")),this.m_subscription.changeTrigger(t.getValue("trigger")),this.m_subscription.changeBufferSize(t.getValue("requested_buffer_size")),this.m_subscription.changeMaxFrequency(t.getValue("requested_max_frequency"))},doSetCurrentFormat:function(){this.m_currentFormat=this.m_subscription.fetch_requestedFormat()},doSetCurrentTrigger:function(){this.m_currentTrigger=this.m_subscription.fetch_requestedTrigger()},notifyOnModificationError_Format:function(t,e){this.m_subscription.fireOnModificationError(t,e,"notification_format")},notifyOnModificationAbort_Format:function(){this.m_subscription.fireOnModificationError(54,"The request was aborted because the operation could not be completed","notification_format")},notifyOnModificationError_Trigger:function(t,e){this.m_subscription.fireOnModificationError(t,e,"trigger")},notifyOnModificationAbort_Trigger:function(){this.m_subscription.fireOnModificationError(54,"The request was aborted because the operation could not be completed","trigger")},traceEvent:function(t){Ds.isTraceEnabled()&&Ds.trace("mpn#sub#"+t+"("+this.m_subId+":"+this.fetch_mpnSubId()+") in "+m.string(this.state))},__class__:mt};var gt=function(t,e,i){this.subId=t,this.itemIdx=e,this.values=i};function vt(t){return Ee.sure(m.parseInt(t))}function St(t){return Ee.sure(parseFloat(t))}function bt(t){return vt(t)}function yt(t){for(var e=Et(t,",")+1,i=Et(t,",",e)+1,s=Et(t,",",i)+1,n=vt(t.substring(e,i-1)),r=vt(t.substring(i,s-1)),a=new Ni,o=s-1,h=1;o<t.length;){var l=t.indexOf("|",o+1);-1==l&&(l=t.length);var u=t.substring(o+1,l);if(""==u)a.h[h]=Ve.unchanged,++h;else if("#"==u)a.h[h]=Ve.changed(null),++h;else if("$"==u)a.h[h]=Ve.changed(""),++h;else if("^"==u.charAt(0))if("P"==u.charAt(1)){var c=wt(u.substring(2));try{var d=_i._new(c);a.h[h]=Ve.jsonPatch(d),++h}catch(t){var _=w.caught(t);throw Os.isErrorEnabled()&&Os.error("Invalid JSON patch "+c+": "+_.get_message()+"\n"+_.details()),new be("The JSON Patch for the field "+h+" is not well-formed")}}else if("T"==u.charAt(1)){var p=wt(u.substring(2));a.h[h]=Ve.diffPatch(p),++h}else for(var f=vt(u.substring(1)),m=0;m<f;)++m,a.h[h]=Ve.unchanged,++h;else{var g=Ve.changed(wt(u));a.h[h]=g,++h}o=l}return new gt(n,r,a)}function Et(t,e,i){var s=t.indexOf(e,i);if(-1==s)throw new be("string not found");return s}function wt(t){for(var e=Rt.ofString(t,xt.UTF8),i=0,s=0;i<e.length;)37==e.b[i]?(e.b[s++]=(Tt(e.b[i+1])<<4)+Tt(e.b[i+2]),i+=3):e.b[s++]=e.b[i++];return e.getString(0,s,xt.UTF8)}function Tt(t){var e=0;return(e=t-97+10)<=9&&(e=t-65+10)<=9&&(e=t-48),e}gt.__name__="com.lightstreamer.client.internal.UpdateInfo",gt.prototype={__class__:gt};var Rt=function(t){this.length=t.byteLength,this.b=new Uint8Array(t),this.b.bufferValue=t,t.hxBytes=this,t.bytes=this.b};Rt.__name__="haxe.io.Bytes",Rt.ofString=function(t,e){if(e==xt.RawNative){for(var i=new Uint8Array(t.length<<1),s=0,n=t.length;s<n;){var r=s++,a=t.charCodeAt(r);i[r<<1]=255&a,i[r<<1|1]=a>>8}return new Rt(i.buffer)}var o=[];for(r=0;r<t.length;)55296<=(a=t.charCodeAt(r++))&&a<=56319&&(a=a-55232<<10|1023&t.charCodeAt(r++)),a<=127?o.push(a):a<=2047?(o.push(192|a>>6),o.push(128|63&a)):a<=65535?(o.push(224|a>>12),o.push(128|a>>6&63),o.push(128|63&a)):(o.push(240|a>>18),o.push(128|a>>12&63),o.push(128|a>>6&63),o.push(128|63&a));return new Rt(new Uint8Array(o).buffer)},Rt.prototype={getString:function(t,e,i){if(t<0||e<0||t+e>this.length)throw w.thrown(qi.OutsideBounds);null==i&&(i=xt.UTF8);var s="",n=this.b,r=t,a=t+e;switch(i._hx_index){case 0:for(;r<a;)if((u=n[r++])<128){if(0==u)break;s+=String.fromCodePoint(u)}else if(u<224){var o=(63&u)<<6|127&n[r++];s+=String.fromCodePoint(o)}else if(u<240){var h=(31&u)<<12|(127&n[r++])<<6|127&n[r++];s+=String.fromCodePoint(h)}else{var l=(15&u)<<18|(127&n[r++])<<12|(127&n[r++])<<6|127&n[r++];s+=String.fromCodePoint(l)}break;case 1:for(;r<a;){var u=n[r++]|n[r++]<<8;s+=String.fromCodePoint(u)}}return s},__class__:Rt};var xt=a["haxe.io.Encoding"]={__ename__:!0,__constructs__:null,UTF8:{_hx_name:"UTF8",_hx_index:0,__enum__:"haxe.io.Encoding",toString:r},RawNative:{_hx_name:"RawNative",_hx_index:1,__enum__:"haxe.io.Encoding",toString:r}};xt.__constructs__=[xt.UTF8,xt.RawNative];var It=function(){this.body=""};It.__name__="com.lightstreamer.client.internal.Request",It.isEmpty=function(t){return 0==t.length},It.lengthOfBytes=function(t){return Rt.ofString(t,xt.UTF8).length},It.prototype={getByteSize:function(){return It.lengthOfBytes(this.body)},getBody:function(){return this.body},addSubRequest:function(t){It.isEmpty(this.body)?this.body=t:this.body+="\r\n"+t},addSubRequestOnlyIfBodyIsLessThan:function(t,e){return It.isEmpty(this.body)&&It.lengthOfBytes(t)<=e?(this.body=t,!0):It.lengthOfBytes(this.body)+It.EOL_LEN+It.lengthOfBytes(t)<=e&&(this.body+="\r\n"+t,!0)},__class__:It};var Ct=function(){this.attempt=1,this._currentRetryDelay=0};Ct.__name__="com.lightstreamer.client.internal.RetryDelayCounter",Ct.prototype={get_currentRetryDelay:function(){return this._currentRetryDelay},increase:function(){this.attempt>10?this._currentRetryDelay<6e4&&(2*this._currentRetryDelay<6e4?this._currentRetryDelay*=2:this._currentRetryDelay=6e4):this.attempt+=1},reset:function(t){this.attempt=1,this._currentRetryDelay=t},__class__:Ct};var Lt=function(){};Lt.__name__="com.lightstreamer.client.internal.SubscriptionManager",Lt.__isInterface__=!0,Lt.__interfaces__=[U],Lt.prototype={__class__:Lt};var Mt=function(t){this.subId=t,this.s_m=1};Mt.__name__="com.lightstreamer.client.internal._SubscriptionManager.State",Mt.prototype={toString:function(){var t="<m="+this.s_m;return null!=this.s_s&&(t+=" s="+this.s_s),null!=this.s_c&&(t+=" c="+this.s_c),t+=">"},traceState:function(){Ds.isTraceEnabled()&&Ds.trace("sub#goto("+this.subId+") "+this.toString())},__class__:Mt};var Nt=function(t,e){var i;switch(this.lock=e.lock,this.subId=e.generateFreshSubId(),t.fetch_mode()){case"COMMAND":i=Nt.is2LevelCommand(t)?new tt(t,e,this.subId):new $(t,e,this.subId);break;case"DISTINCT":i=new et(t,e,this.subId);break;case"MERGE":i=new it(t,e,this.subId);break;case"RAW":i=new st(t,e,this.subId)}this.m_strategy=i,this.state=new Mt(this.subId),this.m_client=e,this.m_subscription=t,this.m_client.relateSubManager(this),this.m_subscription.relate(this)};Nt.__name__="com.lightstreamer.client.internal.SubscriptionManagerLiving",Nt.__interfaces__=[Lt],Nt.is2LevelCommand=function(t){return"COMMAND"==t.fetch_mode()&&(null!=t.getCommandSecondLevelFields()||null!=t.getCommandSecondLevelFieldSchema())},Nt.prototype={finalize:function(){this.m_strategy.evtDispose(),this.m_client.unrelateSubManager(this),this.m_subscription.unrelate(this)},evtExtSubscribe:function(){this.traceEvent("subscribe"),1==this.state.s_m&&(this.doSetActive(),this.doSubscribe(),this.state.s_m=2,this.state.traceState(),this.genSendControl())},evtExtUnsubscribe:function(){this.traceEvent("unsubscribe"),2==this.state.s_m?(this.doSetInactive(),this.finalize(),this.state.s_m=30,this.state.traceState()):3==this.state.s_m?(this.doUnsubscribe(),this.doSetInactive(),this.state.s_m=5,this.state.traceState(),this.genSendControl()):10==this.state.s_s&&(this.doUnsubscribe(),this.m_subscription.setInactive(),this.notifyOnUnsubscription(),this.state.s_m=5,this.state.s_s=null,this.state.s_c=null,this.state.traceState(),this.genSendControl())},evtExtAbort:function(){this.traceEvent("abort"),2==this.state.s_m?(this.state.s_m=2,this.state.traceState()):3==this.state.s_m?(this.doAbort(),this.doSetActive(),this.state.s_m=2,this.state.traceState()):10==this.state.s_s?(this.doAbort(),this.doSetActive(),this.notifyOnUnsubscription(),this.state.s_s=null,this.state.s_c=null,this.state.s_m=2,this.state.traceState()):5==this.state.s_m&&(this.finalize(),this.state.s_m=32,this.state.traceState())},evtREQERR:function(t,e,i){this.traceEvent("REQERR"),2==this.state.s_m&&t==this.m_lastAddReqId?(this.doSetInactive(),this.notifyOnSubscriptionError(e,i),this.finalize(),this.state.s_m=30,this.state.traceState()):5==this.state.s_m&&t==this.m_lastDeleteReqId?(this.finalize(),this.state.s_m=32,this.state.traceState()):22==this.state.s_c&&t==this.m_lastReconfReqId&&(ti.extEquals(this.m_reqMaxFrequency,this.m_subscription.fetch_requestedMaxFrequency())?(this.state.s_c=21,this.state.traceState()):(this.state.s_c=20,this.state.traceState(),this.evtCheckFrequency()))},evtREQOK:function(t){this.traceEvent("REQOK"),2==this.state.s_m&&t==this.m_lastAddReqId?(this.state.s_m=3,this.state.traceState()):5==this.state.s_m&&t==this.m_lastDeleteReqId?(this.finalize(),this.state.s_m=32,this.state.traceState()):22==this.state.s_c&&t==this.m_lastReconfReqId&&(this.doREQOKConfigure(),this.state.s_c=20,this.state.traceState(),this.evtCheckFrequency())},checkItems:function(t,e){return null==t||t==e},checkFields:function(t,e){return null==t||t==e},checkItemsAndFields:function(t,e,i,s){return!!this.checkItems(t,i)&&this.checkFields(e,s)},evtSUBOK:function(t,e){if(this.traceEvent("SUBOK"),2==this.state.s_m||3==this.state.s_m){var i,s=null!=(i=this.m_subscription.fetch_items())?i.length:null,n=null!=(i=this.m_subscription.fetch_fields())?i.length:null;this.checkItemsAndFields(s,n,t,e)?(this.doSUBOK(t,e),this.notifyOnSubscription(),this.state.s_m=4,this.state.s_s=10,this.state.s_c=20,this.state.traceState(),this.evtCheckFrequency()):(this.doUnsubscribe(),this.doSetInactive(),this.notifyOnSubscriptionError_CountMismatch(s,n,t,e),this.state.s_m=5,this.state.traceState(),this.genSendControl())}},evtSUBCMD:function(t,e,i,s){if(this.traceEvent("SUBCMD"),2==this.state.s_m||3==this.state.s_m){var n,r=null!=(n=this.m_subscription.fetch_items())?n.length:null,a=null!=(n=this.m_subscription.fetch_fields())?n.length:null;this.checkItemsAndFields(r,a,t,e)?(this.doSUBCMD(t,e,s,i),this.notifyOnSubscription(),this.state.s_m=4,this.state.s_s=10,this.state.s_c=20,this.state.traceState(),this.evtCheckFrequency()):(this.doUnsubscribe(),this.doSetInactive(),this.notifyOnSubscriptionError_CountMismatch(r,a,t,e),this.state.s_m=5,this.state.traceState(),this.genSendControl())}},evtUNSUB:function(){this.traceEvent("UNSUB"),10==this.state.s_s?(this.doUNSUB(),this.doSetInactive(),this.notifyOnUnsubscription(),this.finalize(),this.state.s_m=31,this.state.s_s=null,this.state.s_c=null,this.state.traceState()):5==this.state.s_m&&(this.finalize(),this.state.s_m=32,this.state.traceState())},evtU:function(t,e){this.traceEvent("U"),10==this.state.s_s&&(this.doU(t,e),this.state.s_s=10,this.state.traceState())},evtEOS:function(t){this.traceEvent("EOS"),10==this.state.s_s&&(this.doEOS(t),this.state.s_s=10,this.state.traceState())},evtCS:function(t){this.traceEvent("CS"),10==this.state.s_s&&(this.doCS(t),this.state.s_s=10,this.state.traceState())},evtOV:function(t,e){this.traceEvent("OV"),10==this.state.s_s&&(this.doOV(t,e),this.state.s_s=10,this.state.traceState())},evtCONF:function(t){this.traceEvent("CONF"),10==this.state.s_s&&(this.doCONF(t),this.state.s_s=10,this.state.traceState())},evtCheckFrequency:function(){this.traceEvent("check.frequency"),20==this.state.s_c&&(ti.extEquals(this.m_subscription.fetch_requestedMaxFrequency(),this.m_currentMaxFrequency)?(this.state.s_c=21,this.state.traceState()):(this.doConfigure(),this.state.s_c=22,this.state.traceState(),this.genSendControl()))},evtExtConfigure:function(){this.traceEvent("configure"),21==this.state.s_c&&(this.state.s_c=20,this.state.traceState(),this.evtCheckFrequency())},isPending:function(){return 2==this.state.s_m||5==this.state.s_m||22==this.state.s_c},encode:function(t){if(2==this.state.s_m)return this.encodeAdd(t);if(5==this.state.s_m)return this.encodeDelete(t);if(22==this.state.s_c)return this.encodeReconf(t);throw new be("Can't encode request")},encodeWS:function(){return"control\r\n"+this.encode(!0)},getValue:function(t,e){return this.m_strategy.getValue(t,e)},getCommandValue:function(t,e,i){return this.m_strategy.getCommandValue(t,e,i)},encodeAdd:function(t){var e=new Me;this.m_lastAddReqId=this.m_client.generateFreshReqId(),e.LS_reqId(this.m_lastAddReqId),e.LS_op("add"),e.LS_subId(this.subId),e.LS_mode(this.m_subscription.fetch_mode());var i=this.m_subscription.getItemGroup(),s=this.m_subscription.getItems();null!=i?e.LS_group(i):null!=s&&e.LS_group(s.slice().join(" "));var n=this.m_subscription.getFieldSchema(),r=this.m_subscription.getFields();null!=n?e.LS_schema(n):null!=r&&e.LS_schema(r.slice().join(" "));var a=this.m_subscription.getDataAdapter();null!=a&&e.LS_data_adapter(a);var o=this.m_subscription.getSelector();null!=o&&e.LS_selector(o);var h=this.m_subscription.fetch_requestedSnapshot();if(null!=h)switch(h._hx_index){case 0:e.LS_snapshot(!0);break;case 1:e.LS_snapshot(!1);break;case 2:e.LS_snapshot_Int(h.len)}var l=this.m_currentMaxFrequency;if(null!=l)switch(l._hx_index){case 0:e.LS_requested_max_frequency_Float(l.max);break;case 1:e.LS_requested_max_frequency("unlimited");break;case 2:e.LS_requested_max_frequency("unfiltered")}var u=this.m_subscription.fetch_requestedBufferSize();if(null!=u)switch(u._hx_index){case 0:e.LS_requested_buffer_size_Int(u.size);break;case 1:e.LS_requested_buffer_size("unlimited")}return t&&e.LS_ack(!1),Ns.isInfoEnabled()&&Ns.info("Sending Subscription add: "+m.string(e)),e.getEncodedString()},encodeDelete:function(t){var e=new Me;return this.m_lastDeleteReqId=this.m_client.generateFreshReqId(),e.LS_reqId(this.m_lastDeleteReqId),e.LS_subId(this.subId),e.LS_op("delete"),t&&e.LS_ack(!1),Ns.isInfoEnabled()&&Ns.info("Sending Subscription delete: "+m.string(e)),e.getEncodedString()},encodeReconf:function(t){var e=new Me;this.m_lastReconfReqId=this.m_client.generateFreshReqId(),e.LS_reqId(this.m_lastReconfReqId),e.LS_subId(this.subId),e.LS_op("reconf");var i=this.m_reqMaxFrequency;if(null!=i)switch(i._hx_index){case 0:e.LS_requested_max_frequency_Float(i.max);break;case 1:e.LS_requested_max_frequency("unlimited");break;case 2:e.LS_requested_max_frequency("unfiltered")}return Ns.isInfoEnabled()&&Ns.info("Sending Subscription configuration: "+m.string(e)),e.getEncodedString()},doSetActive:function(){this.m_subscription.setActive()},doSetInactive:function(){this.m_subscription.setInactive()},doSubscribe:function(){this.m_currentMaxFrequency=this.m_subscription.fetch_requestedMaxFrequency()},doUnsubscribe:function(){this.m_strategy.evtUnsubscribe(),this.m_subscription.unrelate(this)},doAbort:function(){this.m_lastAddReqId=null,this.m_lastDeleteReqId=null,this.m_lastReconfReqId=null,this.m_reqMaxFrequency=null,this.m_currentMaxFrequency=this.m_subscription.fetch_requestedMaxFrequency(),this.m_strategy.evtAbort()},genSendControl:function(){this.m_client.evtSendControl(this)},notifyOnSubscription:function(){this.m_subscription.fireOnSubscription(this.subId)},notifyOnUnsubscription:function(){this.m_subscription.fireOnUnsubscription(this.subId)},notifyOnSubscriptionError:function(t,e){this.m_subscription.fireOnSubscriptionError(this.subId,t,e)},notifyOnSubscriptionError_CountMismatch:function(t,e,i,s){this.checkItems(t,i)?this.m_subscription.fireOnSubscriptionError(this.subId,61,"Expected "+e+" fields but got "+s):this.m_subscription.fireOnSubscriptionError(this.subId,61,"Expected "+t+" items but got "+i)},doConfigure:function(){this.m_reqMaxFrequency=this.m_subscription.fetch_requestedMaxFrequency(),this.m_strategy.evtSetRequestedMaxFrequency(this.m_reqMaxFrequency)},doREQOKConfigure:function(){this.m_currentMaxFrequency=this.m_reqMaxFrequency},doSUBOK:function(t,e){this.m_subscription.setSubscribed(this.subId,t,e),this.m_strategy.evtOnSUB(t,e,null,null,null)},doSUBCMD:function(t,e,i,s){this.m_subscription.setSubscribedCMD(this.subId,t,e,i,s),this.m_strategy.evtOnSUB(t,e,i,s,this.m_currentMaxFrequency)},doUNSUB:function(){this.m_strategy.evtOnUNSUB()},doU:function(t,e){if(t>Ee.sure(this.m_subscription.fetch_nItems()))throw new be("Assertion failure: itemIdx <= m_subscription.fetch_nItems().sure()");this.m_strategy.evtUpdate(t,e)},doEOS:function(t){this.m_strategy.evtOnEOS(t),this.m_subscription.fireOnEndOfSnapshot(t,this.subId)},doCS:function(t){this.m_strategy.evtOnCS(t),this.m_subscription.fireOnClearSnapshot(t,this.subId)},doOV:function(t,e){this.m_subscription.fireOnLostUpdates(t,e,this.subId)},doCONF:function(t){this.m_strategy.evtOnCONF(t)},traceEvent:function(t){Ds.isTraceEnabled()&&Ds.trace("sub#"+t+"("+this.subId+") in "+m.string(this.state))},__class__:Nt};var Dt=function(t,e){this.s_m=1,this.subId=t,this.lock=e.lock,this.m_client=e,e.relateSubManager(this)};Dt.__name__="com.lightstreamer.client.internal.SubscriptionManagerZombie",Dt.__interfaces__=[Lt],Dt.prototype={finalize:function(){this.m_client.unrelateSubManager(this)},evtExtAbort:function(){this.traceEvent("abort"),2==this.s_m&&(this.finalize(),this.goto(3))},evtREQERR:function(t,e,i){this.traceEvent("REQERR"),2==this.s_m&&t==this.m_lastDeleteReqId&&(this.finalize(),this.goto(3))},evtREQOK:function(t){this.traceEvent("REQOK"),2==this.s_m&&t==this.m_lastDeleteReqId&&(this.finalize(),this.goto(3))},evtSUBOK:function(t,e){this.traceEvent("SUBOK"),1==this.s_m&&(this.goto(2),this.genSendControl())},evtSUBCMD:function(t,e,i,s){this.traceEvent("SUBCMD"),1==this.s_m&&(this.goto(2),this.genSendControl())},evtUNSUB:function(){this.traceEvent("UNSUB"),2==this.s_m&&(this.finalize(),this.goto(3))},evtU:function(t,e){this.traceEvent("U"),1==this.s_m&&(this.goto(2),this.genSendControl())},evtEOS:function(t){this.traceEvent("EOS"),1==this.s_m&&(this.goto(2),this.genSendControl())},evtCS:function(t){this.traceEvent("CS"),1==this.s_m&&(this.goto(2),this.genSendControl())},evtOV:function(t,e){this.traceEvent("OV"),1==this.s_m&&(this.goto(2),this.genSendControl())},evtCONF:function(t){this.traceEvent("CONF"),1==this.s_m&&(this.goto(2),this.genSendControl())},isPending:function(){return 2==this.s_m},encode:function(t){if(this.isPending())return this.encodeDelete(t);throw new be("Can't encode unsubscription request")},encodeWS:function(){return"control\r\n"+this.encode(!0)},genSendControl:function(){this.m_client.evtSendControl(this)},encodeDelete:function(t){var e=new Me;return this.m_lastDeleteReqId=this.m_client.generateFreshReqId(),e.LS_reqId(this.m_lastDeleteReqId),e.LS_subId(this.subId),e.LS_op("delete"),t&&e.LS_ack(!1),e.LS_cause("zombie"),Ns.isInfoEnabled()&&Ns.info("Sending Subscription delete: "+m.string(e)),e.getEncodedString()},traceEvent:function(t){Ds.isTraceEnabled()&&Ds.trace("zsub#"+t+"("+this.subId+") in "+this.s_m)},goto:function(t){this.s_m=t,Ds.isTraceEnabled()&&Ds.trace("zsub#goto("+this.subId+") "+this.s_m)},__class__:Dt};var Ot=function(){};Ot.__name__="com.lightstreamer.client.internal.update.AbstractItemUpdate",Ot.__interfaces__=[o],Ot.prototype={__class__:Ot};var Pt=function(t,e,i,s){this.m_subId=s,this.itemIdx=t,this.subscription=e,this.client=i,this.lock=i.lock};Pt.__name__="com.lightstreamer.client.internal.update.ItemBase",Pt.prototype={finalize:function(){},evtUpdate:function(t){this.fatalError()},evtOnEOS:function(){this.fatalError()},evtOnCS:function(){this.fatalError()},evtDispose:function(t){this.fatalError()},getValue:function(t){return null!=this.currValues?jt.toString(this.currValues.h[t]):null},getCommandValue:function(t,e){throw new be("Unsupported operation")},fatalError:function(){throw new be("Unsupported operation")},doFirstUpdate:function(t){this.doUpdate(t,!1)},doUpdate0:function(t){this.doUpdate(t,!1)},doFirstSnapshot:function(t){this.doUpdate(t,!0)},doSnapshot:function(t){this.doUpdate(t,!0)},doUpdate:function(t,e){var i=this.currValues;this.currValues=Qt(i,t);var s=Xt(i,this.currValues),n=Zt(i,t),r=new Vt(this.itemIdx,this.subscription,this.currValues,s,e,n);this.subscription.fireOnItemUpdate(r,this.m_subId)},__class__:Pt};var kt=function(t,e,i,s){this.keys=new ki,Pt.call(this,t,e,i,s),this.s_m=e.hasSnapshot()?3:1};kt.__name__="com.lightstreamer.client.internal.update.ItemCommand",kt.__super__=Pt,kt.prototype=l(Pt.prototype,{finalize:function(){},unrelate:function(t){var e=this.keys;Object.prototype.hasOwnProperty.call(e.h,t)&&delete e.h[t]},evtUpdate:function(t){switch(this.traceEvent("update"),this.s_m){case 1:this.doFirstUpdate(t),this.goto(2);break;case 2:this.doUpdate0(t),this.goto(2);break;case 3:this.doFirstSnapshot(t),this.goto(4);break;case 4:this.doSnapshot(t),this.goto(4)}},evtOnEOS:function(){switch(this.traceEvent("onEOS"),this.s_m){case 3:this.goto(1);break;case 4:this.goto(2)}},evtOnCS:function(){throw new be("Unsupported method")},evtDispose:function(t){switch(this.traceEvent("dispose"),this.s_m){case 1:case 2:case 3:case 4:this.finalize(),this.goto(5),this.genDisposeKeys(),t.unrelate(this.itemIdx)}},getCommandValue:function(t,e){var i=this.keys.h[t];return null!=i?i.getCommandValue(e):null},createKey:function(t){throw new be("Abstract method")},doUpdate:function(t,e){this.currValues=Qt(this.currValues,t),this.selectKey().evtUpdate(this.currValues,e)},genDisposeKeys:function(){for(var t=ki.createCopy(this.keys.h).h,e=Object.keys(t),i=e.length,s=0;s<i;)t[e[s++]].evtDispose()},selectKey:function(){var t=this.currValues,e=this.subscription.getKeyPosition(),i=jt.toString(t.h[e]);return null==(e=this.keys.h[i])&&(e=this.createKey(i),this.keys.h[i]=e),e},goto:function(t){this.s_m=t,Ds.isTraceEnabled()&&Ds.trace("sub#itm#goto("+this.m_subId+":"+this.itemIdx+") in "+this.s_m)},traceEvent:function(t){Ds.isTraceEnabled()&&Ds.trace("sub#itm#"+t+"("+this.m_subId+":"+this.itemIdx+") in "+this.s_m)},__class__:kt});var Ft=function(t,e,i,s){kt.call(this,t,e,i,s)};Ft.__name__="com.lightstreamer.client.internal.update.ItemCommand1Level",Ft.__super__=kt,Ft.prototype=l(kt.prototype,{evtOnCS:function(){switch(this.traceEvent("onCS"),this.s_m){case 1:case 2:case 3:case 4:this.goto(this.s_m),this.genDisposeKeys()}},createKey:function(t){return new Yt(t,this)},__class__:Ft});var At=function(t,e,i,s,n){kt.call(this,t,e,s,n),this.strategy=i};At.__name__="com.lightstreamer.client.internal.update.ItemCommand2Level",At.__super__=kt,At.prototype=l(kt.prototype,{evtOnCS:function(){switch(this.traceEvent("onCS"),this.s_m){case 1:case 2:case 3:case 4:this.goto(this.s_m),this.genDisposeKeys(),this.genOnRealMaxFrequency2LevelRemoved()}},evtSetRequestedMaxFrequency:function(){switch(this.traceEvent("setRequestedMaxFrequency"),this.s_m){case 1:case 2:case 3:case 4:this.goto(this.s_m),this.genSetRequestedMaxFrequency()}},createKey:function(t){return new Gt(t,this)},genSetRequestedMaxFrequency:function(){for(var t=this.keys.h,e=Object.keys(t),i=e.length,s=0;s<i;)t[e[s++]].evtSetRequestedMaxFrequency()},genOnRealMaxFrequency2LevelRemoved:function(){this.strategy.evtOnRealMaxFrequency2LevelRemoved()},__class__:At});var qt=function(t,e,i,s){Pt.call(this,t,e,i,s),this.s_m=e.hasSnapshot()?3:1};qt.__name__="com.lightstreamer.client.internal.update.ItemDistinct",qt.__super__=Pt,qt.prototype=l(Pt.prototype,{evtUpdate:function(t){switch(this.traceEvent("update"),this.s_m){case 1:this.doFirstUpdate(t),this.goto(2);break;case 2:this.doUpdate0(t),this.goto(2);break;case 3:this.doFirstSnapshot(t),this.goto(4);break;case 4:this.doSnapshot(t),this.goto(4)}},evtOnEOS:function(){switch(this.traceEvent("onEOS"),this.s_m){case 3:this.goto(1);break;case 4:this.goto(2)}},evtOnCS:function(){},evtDispose:function(t){switch(this.traceEvent("dispose"),this.s_m){case 1:case 2:case 3:case 4:this.finalize(),this.goto(5),t.unrelate(this.itemIdx)}},goto:function(t){this.s_m=t,Ds.isTraceEnabled()&&Ds.trace("sub#itm#goto("+this.m_subId+":"+this.itemIdx+") "+this.s_m)},traceEvent:function(t){Ds.isTraceEnabled()&&Ds.trace("sub#itm#"+t+"("+this.m_subId+":"+this.itemIdx+") in "+this.s_m)},__class__:qt});var Bt=function(){};Bt.__name__="com.lightstreamer.client.internal.update.ItemKey",Bt.__isInterface__=!0,Bt.prototype={__class__:Bt};var Ut=function(t,e,i,s){this.s_m=1,Pt.call(this,t,e,i,s)};Ut.__name__="com.lightstreamer.client.internal.update.ItemMerge",Ut.__super__=Pt,Ut.prototype=l(Pt.prototype,{evtUpdate:function(t){switch(this.traceEvent("update"),this.s_m){case 1:this.subscription.hasSnapshot()?(this.doSnapshot(t),this.goto(2)):(this.doFirstUpdate(t),this.goto(3));break;case 2:case 3:this.doUpdate0(t),this.goto(3)}},evtDispose:function(t){switch(this.traceEvent("dispose"),this.s_m){case 1:case 2:case 3:this.finalize(),this.goto(4),t.unrelate(this.itemIdx)}},goto:function(t){this.s_m=t,Ds.isTraceEnabled()&&Ds.trace("sub#itm#goto("+this.m_subId+":"+this.itemIdx+") "+this.s_m)},traceEvent:function(t){Ds.isTraceEnabled()&&Ds.trace("sub#itm#"+t+"("+this.m_subId+":"+this.itemIdx+") in "+this.s_m)},__class__:Ut});var Wt=function(t,e,i,s){this.s_m=1,Pt.call(this,t,e,i,s)};Wt.__name__="com.lightstreamer.client.internal.update.ItemRaw",Wt.__super__=Pt,Wt.prototype=l(Pt.prototype,{evtUpdate:function(t){switch(this.traceEvent("update"),this.s_m){case 1:this.doFirstUpdate(t),this.goto(2);break;case 2:this.doUpdate0(t),this.goto(2)}},evtDispose:function(t){switch(this.traceEvent("dispose"),this.s_m){case 1:case 2:this.finalize(),this.goto(3),t.unrelate(this.itemIdx)}},goto:function(t){this.s_m=t,Ds.isTraceEnabled()&&Ds.trace("sub#itm#goto("+this.m_subId+":"+this.itemIdx+") "+this.s_m)},traceEvent:function(t){Ds.isTraceEnabled()&&Ds.trace("sub#itm#"+t+"("+this.m_subId+":"+this.itemIdx+") in "+this.s_m)},__class__:Wt});var Ht=function(t,e,i,s,n,r){var a=e.fetch_items(),o=e.fetch_fields(),h=e.fetch_fields2();this.m_itemIdx=t,this.m_items=Jt(a),this.m_nFields=Ee.sure(e.fetch_nFields()),this.m_fields=Jt(o),this.m_fields2=Jt(h),this.m_newValues=i.copy(),this.m_changedFields=s.copy(),this.m_isSnapshot=n,this.m_jsonPatches=r};Ht.__name__="com.lightstreamer.client.internal.update.ItemUpdate2Level",Ht.__super__=Ot,Ht.prototype=l(Ot.prototype,{getItemName:function(){return null!=this.m_items?this.m_items.h[this.m_itemIdx]:null},getItemPos:function(){return this.m_itemIdx},isSnapshot:function(){return this.m_isSnapshot},getValue:function(t){return"number"==typeof t&&(0|t)===t?this.getValuePos(t):this.getValueName(m.string(t))},isValueChanged:function(t){return"number"==typeof t&&(0|t)===t?this.isValueChangedPos(t):this.isValueChangedName(m.string(t))},_getValueAsJSONPatchIfAvailable:function(t){if("number"==typeof t&&(0|t)===t)return this.m_jsonPatches.h[t];var e=this.getFieldIdxFromName(m.string(t));return null!=e?this.m_jsonPatches.h[e]:null},getValueAsJSONPatchIfAvailable:function(t){return this._getValueAsJSONPatchIfAvailable(t)},forEachChangedField:function(t){for(var e=this.m_changedFields.iterator();e.current<e.array.length;){var i=e.array[e.current++];try{t(this.getFieldNameFromIdx(i),i,jt.toString(this.m_newValues.h[i]))}catch(t){var s=w.caught(t);Ps.isErrorEnabled()&&Ps.error("An exception was thrown while executing the Function passed to the forEachChangedField method\n"+s.details())}}},forEachField:function(t){for(var e=this.m_newValues,i=e.keys();i.hasNext();){var s=i.next(),n=e.get(s);try{t(this.getFieldNameFromIdx(s),s,jt.toString(n))}catch(t){var r=w.caught(t);Ps.isErrorEnabled()&&Ps.error("An exception was thrown while executing the Function passed to the forEachField method\n"+r.details())}}},getValuePos:function(t){return jt.toString(this.m_newValues.h[t])},getValueName:function(t){if(null==this.m_fields&&null==this.m_fields2)throw new be(Rs);var e=this.getFieldIdxFromName(t);if(null==e)throw new T(Is);return jt.toString(this.m_newValues.h[e])},isValueChangedPos:function(t){return this.m_changedFields.contains(t)},isValueChangedName:function(t){if(null==this.m_fields&&null==this.m_fields2)throw new be(Rs);var e=this.getFieldIdxFromName(t);if(null==e)throw new T(Is);return this.m_changedFields.contains(e)},getFieldNameFromIdx:function(t){return t<=this.m_nFields?null!=this.m_fields?this.m_fields.h[t]:null:null!=this.m_fields2?this.m_fields2.h[t-this.m_nFields]:null},getFieldIdxFromName:function(t){var e,i,s=this.m_fields;return null!=s&&null!=(i=$t(Ee.sure(s),t))?i:null!=(e=this.m_fields2)&&null!=(i=$t(Ee.sure(e),t))?this.m_nFields+Ee.sure(i):null},toString:function(){var t="";t="[";for(var e=this.m_newValues,i=e.keys();i.hasNext();){var s=i.next(),n=e.get(s),r=this.getFieldNameFromIdx(s),a=null!=r?r:null==s?"null":""+s,o=m.string(n);s>1&&(t+=","),t+=null==a?"null":""+a,t+=":",t+=null==o?"null":""+o}return t+="]"},__class__:Ht});var Vt=function(t,e,i,s,n,r){var a=e.fetch_items(),o=e.fetch_fields();this.m_itemIdx=t,this.m_items=Jt(a),this.m_nFields=Ee.sure(e.fetch_nFields()),this.m_fields=Jt(o),null!=o&&o.length!=this.m_nFields&&Fs.isErrorEnabled()&&Fs.error("Expected "+this.m_nFields+" field names but got "+o.length+": "+m.string(o)),this.m_newValues=i.copy(),this.m_changedFields=s.copy(),this.m_isSnapshot=n,this.m_jsonPatches=r};Vt.__name__="com.lightstreamer.client.internal.update.ItemUpdateBase",Vt.__super__=Ot,Vt.prototype=l(Ot.prototype,{getItemName:function(){return null!=this.m_items?this.m_items.h[this.m_itemIdx]:null},getItemPos:function(){return this.m_itemIdx},isSnapshot:function(){return this.m_isSnapshot},getValue:function(t){return"number"==typeof t&&(0|t)===t?this.getValuePos(t):this.getValueName(m.string(t))},isValueChanged:function(t){return"number"==typeof t&&(0|t)===t?this.isValueChangedPos(t):this.isValueChangedName(m.string(t))},_getValueAsJSONPatchIfAvailable:function(t){if("number"==typeof t&&(0|t)===t)return this.m_jsonPatches.h[t];var e=this.getFieldIdxFromName(m.string(t));return this.m_jsonPatches.h[e]},getValueAsJSONPatchIfAvailable:function(t){return this._getValueAsJSONPatchIfAvailable(t)},forEachChangedField:function(t){for(var e=this.m_changedFields.iterator();e.current<e.array.length;){var i=e.array[e.current++];try{t(null!=this.m_fields?this.m_fields.h[i]:null,i,jt.toString(this.m_newValues.h[i]))}catch(t){var s=w.caught(t);Ps.isErrorEnabled()&&Ps.error("An exception was thrown while executing the Function passed to the forEachChangedField method\n"+s.details())}}},forEachField:function(t){for(var e=this.m_newValues,i=e.keys();i.hasNext();){var s=i.next(),n=e.get(s);try{t(null!=this.m_fields?this.m_fields.h[s]:null,s,jt.toString(n))}catch(t){var r=w.caught(t);Ps.isErrorEnabled()&&Ps.error("An exception was thrown while executing the Function passed to the forEachField method\n"+r.details())}}},getValuePos:function(t){if(!(1<=t&&t<=this.m_nFields))throw new T(xs);return jt.toString(this.m_newValues.h[t])},getValueName:function(t){var e=this.getFieldIdxFromName(t);return jt.toString(this.m_newValues.h[e])},isValueChangedPos:function(t){if(!(1<=t&&t<=this.m_nFields))throw new T(xs);return this.m_changedFields.contains(t)},isValueChangedName:function(t){var e=this.getFieldIdxFromName(t);return this.m_changedFields.contains(e)},getFieldNameOrNullFromIdx:function(t){return null!=this.m_fields?this.m_fields.h[t]:null},getFieldIdxFromName:function(t){if(null==this.m_fields)throw new be(Rs);var e=$t(this.m_fields,t);if(null==e)throw new T(Is);return e},toString:function(){var t="";t="[";for(var e=this.m_newValues,i=e.keys();i.hasNext();){var s=i.next(),n=e.get(s),r=this.getFieldNameOrNullFromIdx(s),a=null!=r?r:null==s?"null":""+s,o=m.string(n);s>1&&(t+=","),t+=null==a?"null":""+a,t+=":",t+=null==o?"null":""+o}return t+="]"},__class__:Vt});var Yt=function(t,e){this.s_m=1,this.keyName=t,this.item=e,this.lock=e.lock};Yt.__name__="com.lightstreamer.client.internal.update.Key1Level",Yt.__interfaces__=[Bt],Yt.prototype={finalize:function(){this.currKeyValues=null,this.item.unrelate(this.keyName)},evtUpdate:function(t,e){switch(this.traceEvent("update"),this.s_m){case 1:this.isDelete(t)?(this.doLightDelete(t,e),this.finalize(),this.goto(3)):(this.doFirstUpdate(t,e),this.goto(2));break;case 2:this.isDelete(t)?(this.doDelete(t,e),this.finalize(),this.goto(3)):(this.doUpdate(t,e),this.goto(2))}},evtDispose:function(){switch(this.traceEvent("dispose"),this.s_m){case 1:case 2:this.finalize(),this.goto(3)}},evtSetRequestedMaxFrequency:function(){},getCommandValue:function(t){return null!=this.currKeyValues?jt.toString(this.currKeyValues.h[t]):null},doFirstUpdate:function(t,e){var i=Ee.sure(this.item.subscription.fetch_nFields()),s=this.item.subscription.getCommandPosition();this.currKeyValues=t,this.currKeyValues.h[s]=zt.StringVal("ADD");var n=new Ne(new _(1,i+1));this.fireOnItemUpdate(new Vt(this.item.itemIdx,this.item.subscription,this.currKeyValues,n,e,new Ni))},doUpdate:function(t,e){var i=this.item.subscription.getCommandPosition(),s=this.currKeyValues;this.currKeyValues=t,this.currKeyValues.h[i]=zt.StringVal("UPDATE");var n=Xt(s,this.currKeyValues);this.fireOnItemUpdate(new Vt(this.item.itemIdx,this.item.subscription,this.currKeyValues,n,e,new Ni))},doLightDelete:function(t,e){this.currKeyValues=null;var i=new Ne(t.keys()),s=new Vt(this.item.itemIdx,this.item.subscription,this.nullify(t),i,e,new Ni);this.item.unrelate(this.keyName),this.fireOnItemUpdate(s)},doDelete:function(t,e){this.currKeyValues=null;var i=new Ne(t.keys()).subtracting([this.item.subscription.getKeyPosition()]),s=new Vt(this.item.itemIdx,this.item.subscription,this.nullify(t),i,e,new Ni);this.item.unrelate(this.keyName),this.fireOnItemUpdate(s)},nullify:function(t){for(var e=new Ni,i=t,s=i.keys();s.hasNext();){var n=s.next(),r=i.get(n),a=n==this.item.subscription.getCommandPosition()||n==this.item.subscription.getKeyPosition();e.h[n]=a?r:null}return e},isDelete:function(t){var e=this.item.subscription.getCommandPosition();return"DELETE"==jt.toString(t.h[e])},fireOnItemUpdate:function(t){this.item.subscription.fireOnItemUpdate(t,this.item.m_subId)},goto:function(t){this.s_m=t,this.traceEvent("goto")},traceEvent:function(t){if(Ds.isTraceEnabled()){var e=this.item.m_subId,i=this.item.itemIdx;Ds.isTraceEnabled()&&Ds.trace("sub#key#"+t+"("+e+":"+i+":"+this.keyName+") in "+this.s_m)}},__class__:Yt};var Gt=function(t,e){this.s_m=1,this.keyName=t,this.item=e,this.lock=e.lock};Gt.__name__="com.lightstreamer.client.internal.update.Key2Level",Gt.__interfaces__=[Bt],Gt.prototype={finalize:function(){this.currKeyValues=null,this.currKey2Values=null,this.item.unrelate(this.keyName)},evtUpdate:function(t,e){switch(this.traceEvent("update"),this.s_m){case 1:if(this.isDelete(t))this.doLightDelete(t,e),this.finalize(),this.goto(11),this.genOnRealMaxFrequency2LevelRemoved();else{var i=this.create2LevelSubscription();null!=i?(this.doFirstUpdate(t,e),this.subscription2Level=i,this.goto(4),this.item.strategy.client.subscribeExt(i,!0)):(this.doFirstUpdate(t,e),this.notify2LevelIllegalArgument(),this.goto(3))}break;case 3:this.isDelete(t)?(this.doDelete1LevelOnly(t,e),this.finalize(),this.goto(11),this.genOnRealMaxFrequency2LevelRemoved()):(this.doUpdate(t,e),this.goto(3));break;case 4:this.isDelete(t)?(this.doDelete(t,e),this.finalize(),this.goto(11),this.genOnRealMaxFrequency2LevelRemoved()):(this.doUpdate(t,e),this.goto(4));break;case 5:this.isDelete(t)?(this.doDeleteExt(t,e),this.finalize(),this.goto(11),this.genOnRealMaxFrequency2LevelRemoved()):(this.doUpdate1Level(t,e),this.goto(5))}},evtDispose:function(){switch(this.traceEvent("dispose"),this.s_m){case 1:case 2:case 3:this.finalize(),this.goto(10);break;case 4:case 5:this.doUnsubscribe(),this.finalize(),this.goto(12)}},evtOnSubscriptionError2Level:function(t,e){this.traceEvent("onSubscriptionError2Level"),4==this.s_m&&(this.notify2LevelSubscriptionError(t,e),this.goto(3))},evtUpdate2Level:function(t){switch(this.traceEvent("update2Level"),this.s_m){case 4:case 5:this.doUpdate2Level(t),this.goto(5)}},evtOnUnsubscription2Level:function(){switch(this.traceEvent("onUnsubscription2Level"),this.s_m){case 4:case 5:this.doUnsetRealMaxFrequency(),this.goto(this.s_m),this.genOnRealMaxFrequency2LevelRemoved()}},evtOnItemLostUpdates2Level:function(t){switch(this.traceEvent("onItemLostUpdates2Level"),this.s_m){case 4:case 5:this.goto(this.s_m),this.notify2LevelLostUpdates(t)}},evtOnRealMaxFrequency2Level:function(t){switch(this.traceEvent("onRealMaxFrequency2Level"),this.s_m){case 4:case 5:this.doSetRealMaxFrequency(t),this.goto(this.s_m),this.genOnRealMaxFrequency2LevelAdded()}},evtSetRequestedMaxFrequency:function(){switch(this.traceEvent("setRequestedMaxFrequency"),this.s_m){case 4:case 5:this.doChangeRequestedMaxFrequency(),this.goto(this.s_m)}},getCommandValue:function(t){if(null!=(e=this.currKeyValues)&&null!=e.h[t])return jt.toString(e.h[t]);var e=this.currKey2Values,i=this.item.subscription.fetch_nFields();return null!=e&&null!=i?e.h[t-i]:null},doFirstUpdate:function(t,e){var i=this.item.subscription.getCommandPosition();this.currKeyValues=t,this.currKeyValues.h[i]=zt.StringVal("ADD");var s=Xt(null,this.currKeyValues);this.fireOnItemUpdate(new Ht(this.item.itemIdx,this.item.subscription,this.currKeyValues,s,e,new Ni))},doUpdate:function(t,e){var i=this.item.subscription.getCommandPosition(),s=this.currKeyValues;this.currKeyValues=t,this.currKeyValues.h[i]=zt.StringVal("UPDATE");var n=Xt(s,this.currKeyValues);this.fireOnItemUpdate(new Ht(this.item.itemIdx,this.item.subscription,this.currKeyValues,n,e,new Ni))},doUpdate2Level:function(t){var e=this.item.subscription.getCommandPosition(),i=Ee.sure(this.item.subscription.fetch_nFields()),s=Ee.sure(this.currKeyValues).copy();this.currKeyValues.h[e]=zt.StringVal("UPDATE"),this.currKey2Values=te(t);for(var n=Ee.sure(this.currKeyValues).copy(),r=(l=this.currKey2Values).keys();r.hasNext();){var a=r.next(),o=l.get(a);n.h[a+i]=null==o?null:zt.StringVal(o)}var h=new Ne;for(jt.toString(s.h[e])!=jt.toString(this.currKeyValues.h[e])&&h.insert(e),r=(l=ee(t)).keys();r.hasNext();)a=r.next(),l.get(a),h.insert(a+i);var l,u=t.isSnapshot(),c=new Ni;for(r=(l=this.currKey2Values).keys();r.hasNext();){a=r.next(),l.get(a);var d=t.getValueAsJSONPatchIfAvailable(a);null!=d&&(c.h[a+i]=d)}this.fireOnItemUpdate(new Ht(this.item.itemIdx,this.item.subscription,n,h,u,c))},doUpdate1Level:function(t,e){var i=this.item.subscription.getCommandPosition(),s=Ee.sure(this.item.subscription.fetch_nFields()),n=Ee.sure(this.currKeyValues);this.currKeyValues=t,this.currKeyValues.h[i]=zt.StringVal("UPDATE");for(var r=Ee.sure(this.currKeyValues).copy(),a=Ee.sure(this.currKey2Values),o=a.keys();o.hasNext();){var h=o.next(),l=a.get(h);r.h[h+s]=null==l?null:zt.StringVal(l)}for(var u=new Ne,c=1,d=s+1;c<d;){var _=c++;jt.toString(n.h[_])!=jt.toString(r.h[_])&&u.insert(_)}this.fireOnItemUpdate(new Ht(this.item.itemIdx,this.item.subscription,r,u,e,new Ni))},doDelete:function(t,e){var i=Ee.sure(this.item.subscription.fetch_nFields()),s=this.item.subscription.getKeyPosition(),n=this.item.subscription.getCommandPosition();this.currKeyValues=null;for(var r=new Ne(new _(1,i+1)).subtracting([s]),a=new Ni,o=1,h=i+1;o<h;)a.h[o++]=null;a.h[s]=zt.StringVal(this.keyName),a.h[n]=zt.StringVal("DELETE");var l=new Ht(this.item.itemIdx,this.item.subscription,a,r,e,new Ni);this.item.unrelate(this.keyName);var u=Ee.sure(this.subscription2Level);u.removeListener(Ee.sure(this.listener2Level)),Ee.sure(this.listener2Level).disable(),this.subscription2Level=null,this.listener2Level=null,this.item.strategy.client.unsubscribe(u),this.fireOnItemUpdate(l)},doDeleteExt:function(t,e){var i=Ee.sure(this.item.subscription.fetch_nFields()),s=this.item.subscription.getKeyPosition(),n=this.item.subscription.getCommandPosition(),r=i+p.count(Ee.sure(this.currKey2Values));this.currKeyValues=null,this.currKey2Values=null;for(var a=new Ne(new _(1,r+1)).subtracting([s]),o=new Ni,h=1,l=r+1;h<l;)o.h[h++]=null;o.h[s]=zt.StringVal(this.keyName),o.h[n]=zt.StringVal("DELETE");var u=new Ht(this.item.itemIdx,this.item.subscription,o,a,e,new Ni);this.item.unrelate(this.keyName);var c=Ee.sure(this.subscription2Level);c.removeListener(Ee.sure(this.listener2Level)),Ee.sure(this.listener2Level).disable(),this.subscription2Level=null,this.listener2Level=null,this.item.strategy.client.unsubscribe(c),this.fireOnItemUpdate(u)},doLightDelete:function(t,e){var i=Ee.sure(this.item.subscription.fetch_nFields()),s=this.item.subscription.getKeyPosition(),n=this.item.subscription.getCommandPosition();this.currKeyValues=null;for(var r=new Ne(new _(1,i+1)),a=new Ni,o=1,h=i+1;o<h;)a.h[o++]=null;a.h[s]=t.h[s],a.h[n]=t.h[n],this.fireOnItemUpdate(new Ht(this.item.itemIdx,this.item.subscription,a,r,e,new Ni))},doDelete1LevelOnly:function(t,e){var i=Ee.sure(this.item.subscription.fetch_nFields()),s=this.item.subscription.getKeyPosition(),n=this.item.subscription.getCommandPosition();this.currKeyValues=null;for(var r=new Ne(new _(1,i+1)).subtracting([s]),a=new Ni,o=1,h=i+1;o<h;)a.h[o++]=null;a.h[s]=t.h[s],a.h[n]=t.h[n],this.fireOnItemUpdate(new Ht(this.item.itemIdx,this.item.subscription,a,r,e,new Ni))},doChangeRequestedMaxFrequency:function(){Ee.sure(this.subscription2Level).setRequestedMaxFrequency(ti.toString(this.item.strategy.requestedMaxFrequency))},doSetRealMaxFrequency:function(t){this.realMaxFrequency=t},doUnsetRealMaxFrequency:function(){this.realMaxFrequency=null},genOnRealMaxFrequency2LevelAdded:function(){this.item.strategy.evtOnRealMaxFrequency2LevelAdded(this.realMaxFrequency)},genOnRealMaxFrequency2LevelRemoved:function(){this.item.strategy.evtOnRealMaxFrequency2LevelRemoved()},doUnsubscribe:function(){if(null==this.subscription2Level)throw new be("Assertion failure: subscription2Level != null");if(null==this.listener2Level)throw new be("Assertion failure: listener2Level != null");var t=this.subscription2Level;t.removeListener(this.listener2Level),this.listener2Level.disable(),this.subscription2Level=null,this.listener2Level=null,this.item.strategy.client.unsubscribe(t)},notify2LevelIllegalArgument:function(){this.listener2Level=null,this.subscription2Level=null,this.item.subscription.fireOnSubscriptionError2Level(this.keyName,14,"The received key value is not a valid name for an Item",this.item.m_subId,this.item.itemIdx)},notify2LevelSubscriptionError:function(t,e){this.listener2Level=null,this.subscription2Level=null,this.item.subscription.fireOnSubscriptionError2Level(this.keyName,t,e,this.item.m_subId,this.item.itemIdx)},notify2LevelLostUpdates:function(t){this.item.subscription.fireOnLostUpdates2Level(this.keyName,t,this.item.m_subId,this.item.itemIdx)},fireOnItemUpdate:function(t){this.item.subscription.fireOnItemUpdate(t,this.item.m_subId)},create2LevelSubscription:function(){this.listener2Level=new Kt(this);var t=this.item.subscription,e=new N("MERGE",null,null),i=[this.keyName];if(!ri.allValidNames(i))return null;e.setItems(i.slice());var s=t.getCommandSecondLevelFields();return null!=s?e.setFields(s):e.setFieldSchema(t.getCommandSecondLevelFieldSchema()),e.setDataAdapter(t.getCommandSecondLevelDataAdapter()),e.setRequestedSnapshot(Je.toString(Ze.SnpYes)),e.setRequestedMaxFrequency(ti.toString(this.item.strategy.requestedMaxFrequency)),e.addListener(Ee.sure(this.listener2Level)),e.setInternal(),e},isDelete:function(t){var e=this.item.subscription.getCommandPosition();return"DELETE"==jt.toString(t.h[e])},goto:function(t){this.s_m=t,this.traceEvent("goto")},traceEvent:function(t){if(Ds.isTraceEnabled()){var e=this.item.m_subId,i=this.item.itemIdx;Ds.isTraceEnabled()&&Ds.trace("sub#key#"+t+"("+e+":"+i+":"+this.keyName+") in "+this.s_m)}},__class__:Gt};var Kt=function(t){this.m_disabled=!1,this.key=t};Kt.__name__="com.lightstreamer.client.internal.update._Key2Level.Sub2LevelDelegate",Kt.__interfaces__=[h],Kt.prototype={disable:function(){var t=this;Ie.synchronized(this.key.lock,(function(){return t.m_disabled=!0}))},synchronized:function(t){var e=this;Ie.synchronized(this.key.lock,(function(){e.m_disabled||t()}))},onSubscriptionError:function(t,e){var i=this;this.synchronized((function(){i.key.evtOnSubscriptionError2Level(t,e)}))},onItemUpdate:function(t){var e=this;this.synchronized((function(){e.key.evtUpdate2Level(t)}))},onItemLostUpdates:function(t,e,i){var s=this;this.synchronized((function(){s.key.evtOnItemLostUpdates2Level(i)}))},onRealMaxFrequency:function(t){var e=this;this.synchronized((function(){var i,s=e.key;if(null==t)i=null;else if(null==t){var n=parseFloat(t);i=isNaN(n)?null:ei.RFreqLimited(n)}else"unlimited"==t?i=ei.RFreqUnlimited:(n=parseFloat(t),i=isNaN(n)?null:ei.RFreqLimited(n));s.evtOnRealMaxFrequency2Level(i)}))},onUnsubscription:function(){var t=this;this.synchronized((function(){t.key.evtOnUnsubscription2Level()}))},onClearSnapshot:function(t,e){},onCommandSecondLevelItemLostUpdates:function(t,e){},onCommandSecondLevelSubscriptionError:function(t,e,i){},onEndOfSnapshot:function(t,e){},onListenEnd:function(t){},onListenStart:function(t){},onSubscription:function(){},__class__:Kt};var zt=a["com.lightstreamer.client.internal.update.CurrFieldVal"]={__ename__:!0,__constructs__:null,StringVal:(e=function(t){return{_hx_index:0,string:t,__enum__:"com.lightstreamer.client.internal.update.CurrFieldVal",toString:r}},e._hx_name="StringVal",e.__params__=["string"],e),JsonVal:(e=function(t){return{_hx_index:1,json:t,__enum__:"com.lightstreamer.client.internal.update.CurrFieldVal",toString:r}},e._hx_name="JsonVal",e.__params__=["json"],e)};zt.__constructs__=[zt.StringVal,zt.JsonVal];var jt=function(){};function Qt(t,e){if(null!=t){for(var i=new Ni,s=(S=e).keys();s.hasNext();){var n=s.next();switch((b=S.get(n))._hx_index){case 0:i.h[n]=t.h[n];break;case 1:var r=b.val;i.h[n]=null==r?null:zt.StringVal(r);break;case 2:var a=b.patch,o=t.h[n];if(null==o)throw new be("Cannot apply the JSON patch to the field "+n+" because the field is null");switch(o._hx_index){case 0:var h=o.string,l=null;try{l=_i._new(h)}catch(t){var u=w.caught(t);throw Os.isErrorEnabled()&&Os.error(u.get_message()+"\n"+u.details()),new be("Cannot convert the field "+n+" to JSON")}try{var c=zt.JsonVal(_i.apply(Ee.sure(l),a));i.h[n]=c}catch(t){var d=w.caught(t);throw Os.isErrorEnabled()&&Os.error(d.get_message()+"\n"+d.details()),new be("Cannot apply the JSON Patch to the field "+n)}break;case 1:var _=o.json;try{var p=zt.JsonVal(_i.apply(_,a));i.h[n]=p}catch(t){var f=w.caught(t);throw Os.isErrorEnabled()&&Os.error(f.get_message()+"\n"+f.details()),new be("Cannot apply the JSON Patch to the field "+n)}}break;case 3:var m=b.patch,g=t.h[n];if(null==g)throw new be("Cannot apply the TLCP-diff to the field "+n+" because the field is null");switch(g._hx_index){case 0:var v=zt.StringVal(new di(g.string,m).decode());i.h[n]=v;break;case 1:throw new be("Cannot apply the TLCP-diff to the field "+n+" because the field is JSON")}}}return i}var S;for(i=new Ni,s=(S=e).keys();s.hasNext();){var b;switch(n=s.next(),(b=S.get(n))._hx_index){case 0:throw new be("Cannot set the field "+n+" because the first update is UNCHANGED");case 1:r=b.val,i.h[n]=null==r?null:zt.StringVal(r);break;case 2:throw new be("Cannot set the field "+n+" because the first update is a JSONPatch");case 3:throw new be("Cannot set the field "+n+" because the first update is a TLCP-diff")}}return i}function Xt(t,e){if(null!=t){for(var i=new Ne,s=(r=e).keys();s.hasNext();){var n=s.next();r.get(n),jt.toString(t.h[n])!=jt.toString(e.h[n])&&i.insert(n)}return i}var r;for(i=new Ne,s=(r=e).keys();s.hasNext();)n=s.next(),r.get(n),i.insert(n);return i}function Zt(t,e){if(null!=t){for(var i=new Ni,s=e,n=s.keys();n.hasNext();){var r=n.next(),a=s.get(r);switch(a._hx_index){case 0:var o=t.h[r];if(null!=o&&null!=o&&1==o._hx_index){var h=_i._new("[]");i.h[r]=h}break;case 2:i.h[r]=a.patch}}return i}return new Ni}function Jt(t){if(null!=t){for(var e=new Ni,i=0;i<t.length;){var s=t[i++];e.h[i-1+1]=s}return e}return null}function $t(t,e){for(var i=1,s=p.count(t)+1;i<s;){var n=i++;if(t.h[n]==e)return n}return null}function te(t){var e=new Ni;return t.forEachField((function(t,i,s){e.h[i]=s})),e}function ee(t){var e=new Ni;return t.forEachChangedField((function(t,i,s){e.h[i]=s})),e}jt.__name__="com.lightstreamer.client.internal.update.CurrFieldValTools",jt.toString=function(t){if(null==t)return null;switch(t._hx_index){case 0:return t.string;case 1:return _i.toString(t.json)}};var ie=c.LSFirebaseMpnBuilder=function(t){var e=null==t?null:JSON.parse(t);null==e&&(e={webpush:{notification:{}}}),null==e.webpush&&(e.webpush={notification:{}}),null==e.webpush.notification&&(e.webpush.notification={}),this.obj=e};ie.__name__="LSFirebaseMpnBuilder",ie.prototype={build:function(){return this.removeNullFields(this.obj.webpush),this.removeNullFields(this.obj.webpush.notification),JSON.stringify(this.obj)},removeNullFields:function(t){for(var e=0,i=f.fields(t);e<i.length;){var s=i[e];++e,null==f.field(t,s)&&f.deleteField(t,s)}},getHeaders:function(){var t=this.obj.webpush.headers;return null==t?null:f.copy(t)},setHeaders:function(t){var e=null==t?null:ye.toDynamicAccess(t);return this.obj.webpush.headers=e,this},getTitle:function(){return this.obj.webpush.notification.title},setTitle:function(t){return this.obj.webpush.notification.title=t,this},getBody:function(){return this.obj.webpush.notification.body},setBody:function(t){return this.obj.webpush.notification.body=t,this},getIcon:function(){return this.obj.webpush.notification.icon},setIcon:function(t){return this.obj.webpush.notification.icon=t,this},getData:function(){var t=this.obj.webpush.data;return null==t?null:f.copy(t)},setData:function(t){var e=null==t?null:ye.toDynamicAccess(t);return this.obj.webpush.data=e,this},__class__:ie};var se=function(){x.call(this)};se.__name__="com.lightstreamer.client.mpn._MpnDevice.MpnDeviceEventDispatcher",se.__super__=x,se.prototype=l(x.prototype,{addListenerAndFireOnListenStart:function(t){this.addListener(t)&&this.dispatchToOne(t,(function(t){null!=t.onListenStart&&t.onListenStart()}))},removeListenerAndFireOnListenEnd:function(t){this.removeListener(t)&&this.dispatchToOne(t,(function(t){null!=t.onListenEnd&&t.onListenEnd()}))},onRegistered:function(){this.dispatchToAll((function(t){null!=t.onRegistered&&t.onRegistered()}))},onSuspended:function(){this.dispatchToAll((function(t){null!=t.onSuspended&&t.onSuspended()}))},onResumed:function(){this.dispatchToAll((function(t){null!=t.onResumed&&t.onResumed()}))},onStatusChanged:function(t,e){this.dispatchToAll((function(i){null!=i.onStatusChanged&&i.onStatusChanged(t,e)}))},onRegistrationFailed:function(t,e){this.dispatchToAll((function(i){null!=i.onRegistrationFailed&&i.onRegistrationFailed(t,e)}))},onSubscriptionsUpdated:function(){this.dispatchToAll((function(t){null!=t.onSubscriptionsUpdated&&t.onSubscriptionsUpdated()}))},__class__:se});var ne=c.LSMpnDevice=function(t,e,i){if(this.lock=new Ei,this.statusTs=0,this.status="UNKNOWN",this.eventDispatcher=new se,null==t)throw new T("Please specify a valid device token");if(null==e)throw new T("Please specify a valid application ID");var s;switch(this.deviceToken=t,this.applicationId=e,i){case"Apple":s="Apple";break;case"Google":s="Google";break;default:throw new T("Please specify a valid platform: Google or Apple")}this.platform=s;var n=y.getLocalStorage();if(null!=n){var r=n.getItem("com.lightstreamer.mpn.device_token");null!=r?qs.isDebugEnabled()&&qs.debug("Previous registration ID found ("+r+")"):qs.isDebugEnabled()&&qs.debug("No previous registration ID found"),qs.isDebugEnabled()&&qs.debug("Registration ID obtained ("+t+"), storing..."),n.setItem("com.lightstreamer.mpn.device_token",t),qs.isDebugEnabled()&&qs.debug("Registration ID stored"),this.prevDeviceToken=r}else qs.isErrorEnabled()&&qs.error("Local storage not available"),this.prevDeviceToken=null};ne.__name__="LSMpnDevice",ne.prototype={addListener:function(t){this.eventDispatcher.addListenerAndFireOnListenStart(t)},removeListener:function(t){this.eventDispatcher.removeListenerAndFireOnListenEnd(t)},getListeners:function(){return this.eventDispatcher.getListeners().slice()},isRegistered:function(){return"REGISTERED"==this.status},isSuspended:function(){return"SUSPENDED"==this.status},getStatus:function(){return this.status},getStatusTimestamp:function(){return this.statusTs},getPlatform:function(){return this.platform},getApplicationId:function(){return this.applicationId},getDeviceToken:function(){return this.deviceToken},getPreviousDeviceToken:function(){return this.prevDeviceToken},getDeviceId:function(){return this.deviceId},setDeviceId:function(t,e){var i=this;Ie.synchronized(this.lock,(function(){return i.deviceId=t,i.adapterName=e}))},onRegistered:function(t){var e=this;Ie.synchronized(this.lock,(function(){qs.isInfoEnabled()&&qs.info("MPN device registered: "+e.deviceId+")"),e.status="REGISTERED",e.statusTs=t,e.eventDispatcher.onStatusChanged("REGISTERED",t),e.eventDispatcher.onRegistered()}))},onSuspend:function(t){var e=this;Ie.synchronized(this.lock,(function(){qs.isInfoEnabled()&&qs.info("MPN device suspended: "+e.deviceId),e.status="SUSPENDED",e.statusTs=t,e.eventDispatcher.onStatusChanged("SUSPENDED",t),e.eventDispatcher.onSuspended()}))},onResume:function(t){var e=this;Ie.synchronized(this.lock,(function(){qs.isInfoEnabled()&&qs.info("MPN device resumed: "+e.deviceId),e.status="REGISTERED",e.statusTs=t,e.eventDispatcher.onStatusChanged("REGISTERED",t),e.eventDispatcher.onResumed()}))},onError:function(t,e){var i=this;Ie.synchronized(this.lock,(function(){qs.isWarnEnabled()&&qs.warn("MPN device error: "+t+" - "+e+" "+i.deviceId),i.status="UNKNOWN",i.statusTs=0,i.deviceId=null,i.adapterName=null,i.eventDispatcher.onRegistrationFailed(t,e),i.eventDispatcher.onStatusChanged("UNKNOWN",0)}))},onReset:function(){var t=this;Ie.synchronized(this.lock,(function(){qs.isInfoEnabled()&&qs.info("MPN device NOT registered");var e=t.status;t.status="UNKNOWN",t.statusTs=0,t.deviceId=null,t.adapterName=null,"UNKNOWN"!=e&&t.eventDispatcher.onStatusChanged("UNKNOWN",0)}))},fireOnSubscriptionsUpdated:function(){var t=this;Ie.synchronized(this.lock,(function(){qs.isInfoEnabled()&&qs.info("MPN subscriptions have been updated: "+t.deviceId),t.eventDispatcher.onSubscriptionsUpdated()}))},fireOnBadgeResetFailed:function(t,e){var i=this;Ie.synchronized(this.lock,(function(){qs.isWarnEnabled()&&qs.warn("MPN badge reset failed: "+t+" - "+e+" "+i.deviceId)}))},fireOnBadgeReset:function(){var t=this;Ie.synchronized(this.lock,(function(){qs.isInfoEnabled()&&qs.info("MPN badge successfully reset: "+t.deviceId)}))},toString:function(){var t=ge._new();return ge.set(t,"platform",this.platform),ge.set(t,"applicationId",this.applicationId),ge.set(t,"deviceToken",this.deviceToken),ge.set(t,"prevDeviceToken",this.prevDeviceToken),ki.stringify(t.h)},__class__:ne};var re=a["com.lightstreamer.client.mpn.MpnSubscriptionStatus"]={__ename__:!0,__constructs__:null,Unknown:{_hx_name:"Unknown",_hx_index:0,__enum__:"com.lightstreamer.client.mpn.MpnSubscriptionStatus",toString:r},Active:{_hx_name:"Active",_hx_index:1,__enum__:"com.lightstreamer.client.mpn.MpnSubscriptionStatus",toString:r},Subscribed:{_hx_name:"Subscribed",_hx_index:2,__enum__:"com.lightstreamer.client.mpn.MpnSubscriptionStatus",toString:r},Triggered:{_hx_name:"Triggered",_hx_index:3,__enum__:"com.lightstreamer.client.mpn.MpnSubscriptionStatus",toString:r}};re.__constructs__=[re.Unknown,re.Active,re.Subscribed,re.Triggered];var ae=function(){x.call(this)};ae.__name__="com.lightstreamer.client.mpn._MpnSubscription.MpnSubscriptionEventDispatcher",ae.__super__=x,ae.prototype=l(x.prototype,{addListenerAndFireOnListenStart:function(t){this.addListener(t)&&this.dispatchToOne(t,(function(t){null!=t.onListenStart&&t.onListenStart()}))},removeListenerAndFireOnListenEnd:function(t){this.removeListener(t)&&this.dispatchToOne(t,(function(t){null!=t.onListenEnd&&t.onListenEnd()}))},onSubscription:function(){this.dispatchToAll((function(t){null!=t.onSubscription&&t.onSubscription()}))},onUnsubscription:function(){this.dispatchToAll((function(t){null!=t.onUnsubscription&&t.onUnsubscription()}))},onSubscriptionError:function(t,e){this.dispatchToAll((function(i){null!=i.onSubscriptionError&&i.onSubscriptionError(t,e)}))},onUnsubscriptionError:function(t,e){this.dispatchToAll((function(i){null!=i.onUnsubscriptionError&&i.onUnsubscriptionError(t,e)}))},onTriggered:function(){this.dispatchToAll((function(t){null!=t.onTriggered&&t.onTriggered()}))},onStatusChanged:function(t,e){this.dispatchToAll((function(i){null!=i.onStatusChanged&&i.onStatusChanged(t,e)}))},onPropertyChanged:function(t){this.dispatchToAll((function(e){null!=e.onPropertyChanged&&e.onPropertyChanged(t)}))},onModificationError:function(t,e,i){this.dispatchToAll((function(s){null!=s.onModificationError&&s.onModificationError(t,e,i)}))},__class__:ae});var oe=c.LSMpnSubscription=function(t,e,i,s){if(this.lock=new Ei,this.m_status=re.Unknown,this.m_statusTs=0,this.eventDispatcher=new ae,this.wrapper=s,"string"==typeof t)this.mode=le.fromString(t),this.madeByServer=!1,this.initItemsAndFields("string"==typeof e?[e].slice():e,i);else if(t instanceof N){var n=t;this.mode=le.fromString(n.getMode()),this.madeByServer=!1,this.initFromSubscription(n)}else{if(!(t instanceof oe))throw this.mode="MERGE",this.madeByServer=!1,new T("Wrong arguments for MpnSubscription constructor");var r=t;this.mode=r.mode,this.madeByServer=!1,this.initFromMpnSubscription(r)}};oe.__name__="LSMpnSubscription",oe.prototype={reInit:function(t){this.m_mpnSubId=t,this.madeByServer=!0},initFromSubscription:function(t){var e=t.getItems(),i=t.getFields();this.items=null!=e?ri.fromArray(e.slice()):null,this.group=oi.fromString(t.getItemGroup()),this.fields=null!=i?ai.fromArray(i.slice()):null,this.schema=oi.fromString(t.getFieldSchema()),this.dataAdapter=oi.fromString(t.getDataAdapter()),this.bufferSize=Xe.fromString(t.getRequestedBufferSize()),this.requestedMaxFrequency=ce.fromString(t.getRequestedMaxFrequency())},initFromMpnSubscription:function(t){this.items=t.items,this.group=t.group,this.fields=t.fields,this.schema=t.schema,this.dataAdapter=t.dataAdapter,this.bufferSize=t.bufferSize,this.requestedMaxFrequency=t.requestedMaxFrequency,this.requestedFormat=t.requestedFormat,this.requestedTrigger=t.requestedTrigger},initItemsAndFields:function(t,e){if(null!=t){if(null==e)throw new T("Please specify a valid field list");this.items=ri.fromArray(t.slice()),this.fields=ai.fromArray(e.slice())}else if(null!=e)throw new T("Please specify a valid item or item list")},addListener:function(t){this.eventDispatcher.addListenerAndFireOnListenStart(t)},removeListener:function(t){this.eventDispatcher.removeListenerAndFireOnListenEnd(t)},getListeners:function(){return this.eventDispatcher.getListeners().slice()},getMode:function(){return this.mode},getTriggerExpression:function(){return this.requestedTrigger},setTriggerExpression:function(t){var e,i=this;Ie.synchronized(this.lock,(function(){return i.requestedTrigger=null==t?null:t,e=i.m_manager})),null!=e&&e.evtExtMpnSetTrigger()},getActualTriggerExpression:function(){return this.realTrigger},getNotificationFormat:function(){return this.requestedFormat},setNotificationFormat:function(t){var e,i=this;Ie.synchronized(this.lock,(function(){return i.requestedFormat=null==t?null:t,e=i.m_manager})),null!=e&&e.evtExtMpnSetFormat()},getActualNotificationFormat:function(){return this.realFormat},getDataAdapter:function(){return this.dataAdapter},setDataAdapter:function(t){this.checkActive(),this.dataAdapter=oi.fromString(t)},getFields:function(){return null==this.fields?null:this.fields.slice()},setFields:function(t){this.checkActive(),this.fields=ai.fromArray(null==t?null:t.slice()),this.schema=null},getFieldSchema:function(){return this.schema},setFieldSchema:function(t){this.checkActive(),this.schema=oi.fromString(t),this.fields=null},getItems:function(){return null==this.items?null:this.items.slice()},setItems:function(t){this.checkActive(),this.items=ri.fromArray(null==t?null:t.slice()),this.group=null},getItemGroup:function(){return this.group},setItemGroup:function(t){this.checkActive(),this.group=oi.fromString(t),this.items=null},getRequestedBufferSize:function(){return Xe.toString(this.bufferSize)},setRequestedBufferSize:function(t){null!=t&&(t=null==t?"null":""+t),this.checkActive(),this.bufferSize=Xe.fromString(t)},getRequestedMaxFrequency:function(){return ce.toString(this.requestedMaxFrequency)},setRequestedMaxFrequency:function(t){null!=t&&(t=null==t?"null":""+t),this.checkActive(),this.requestedMaxFrequency=ce.fromString(t)},isActive:function(){return this.m_status!=re.Unknown},isSubscribed:function(){return this.m_status==re.Subscribed},isTriggered:function(){return this.m_status==re.Triggered},getStatus:function(){switch(this.m_status._hx_index){case 0:return"UNKNOWN";case 1:return"ACTIVE";case 2:return"SUBSCRIBED";case 3:return"TRIGGERED"}},getStatusTimestamp:function(){return this.m_statusTs},getSubscriptionId:function(){return this.m_mpnSubId},checkActive:function(){if(this.isActive())throw new be("Cannot modify an active MpnSubscription. Please unsubscribe before applying any change")},setSubscriptionId:function(t){this.m_mpnSubId=t},changeStatus:function(t,e){var i=null==e?this.m_statusTs:bt(e);t!=this.m_status&&(this.m_status=t,this.eventDispatcher.onStatusChanged(this.getStatus(),i))},changeStatusTs:function(t){if(null!=t){var e=bt(t);e!=this.m_statusTs&&(this.m_statusTs=e,this.fireOnPropertyChange("status_timestamp"))}},changeMode:function(t){if(null!=t){var e=le.fromString(t);this.mode!=e&&(this.mode=e,this.fireOnPropertyChange("mode"))}},changeGroup:function(t){null!=t&&this.group!=t&&(this.group=t,this.items=null,this.fireOnPropertyChange("group"))},changeSchema:function(t){null!=t&&this.schema!=t&&(this.schema=t,this.fields=null,this.fireOnPropertyChange("schema"))},changeAdapter:function(t){this.dataAdapter!=t&&(this.dataAdapter=null!=t?t:null,this.fireOnPropertyChange("adapter"))},changeFormat:function(t){null!=t&&t!=this.realFormat&&(this.realFormat=t,this.fireOnPropertyChange("notification_format"))},changeTrigger:function(t){t!=this.realTrigger&&(this.realTrigger=null!=t?t:null,this.fireOnPropertyChange("trigger"))},changeBufferSize:function(t){var e=Xe.fromString(t);Xe.extEquals(this.bufferSize,e)||(this.bufferSize=e,this.fireOnPropertyChange("requested_buffer_size"))},changeMaxFrequency:function(t){var e=ce.fromString(t);ce.extEquals(e,this.requestedMaxFrequency)||(this.requestedMaxFrequency=e,this.fireOnPropertyChange("requested_max_frequency"))},reset:function(){this.realFormat=null,this.realTrigger=null,this.m_statusTs=0,this.m_mpnSubId=null},fireOnSubscription:function(){Bs.isInfoEnabled()&&Bs.info((this.madeByServer?"Server ":"")+"MPNSubscription subscribed: pnSubId: "+this.m_mpnSubId),this.eventDispatcher.onSubscription()},fireOnUnsubscription:function(){Bs.isInfoEnabled()&&Bs.info((this.madeByServer?"Server ":"")+"MPNSubscription unsubscribed: pnSubId: "+this.m_mpnSubId),this.eventDispatcher.onUnsubscription()},fireOnTriggered:function(){Bs.isInfoEnabled()&&Bs.info((this.madeByServer?"Server ":"")+"MPNSubscription triggered: pnSubId: "+this.m_mpnSubId),this.eventDispatcher.onTriggered()},fireOnSubscriptionError:function(t,e){Bs.isWarnEnabled()&&Bs.warn((this.madeByServer?"Server ":"")+"MPNSubscription error: "+t+" - "+e+" pnSubId: "+this.m_mpnSubId),this.eventDispatcher.onSubscriptionError(t,e)},fireOnUnsubscriptionError:function(t,e){Bs.isWarnEnabled()&&Bs.warn((this.madeByServer?"Server ":"")+"MPNSubscription unsubscription error: "+t+" - "+e+" pnSubId: "+this.m_mpnSubId),this.eventDispatcher.onUnsubscriptionError(t,e)},fireOnModificationError:function(t,e,i){Bs.isWarnEnabled()&&Bs.warn((this.madeByServer?"Server ":"")+"MPNSubscription "+i+" modification error: "+t+" - "+e+" pnSubId: "+this.m_mpnSubId),this.eventDispatcher.onModificationError(t,e,i)},fireOnPropertyChange:function(t){if(Bs.isInfoEnabled()){var e;switch(t){case"adapter":e="newValue: "+this.dataAdapter;break;case"group":e="newValue: "+this.group;break;case"mode":e="newValue: "+this.mode;break;case"notification_format":e="newValue: "+this.realFormat;break;case"requested_buffer_size":e="newValue: "+Xe.toString(this.bufferSize);break;case"requested_max_frequency":e="newValue: "+ce.toString(this.requestedMaxFrequency);break;case"schema":e="newValue: "+this.schema;break;case"status_timestamp":default:e="";break;case"trigger":e="newValue: "+this.realTrigger}"status_timestamp"!=t&&Bs.isInfoEnabled()&&Bs.info((this.madeByServer?"Server ":"")+"MPNSubscription "+t+" changed: "+e+" pnSubId: "+(null!=this.m_mpnSubId?this.m_mpnSubId:"n.a."))}this.eventDispatcher.onPropertyChanged(t)},fetch_subManager:function(){return this.m_manager},fetch_status:function(){return this.m_status},fetch_madeByServer:function(){return this.madeByServer},fetch_mpnSubId:function(){return this.m_mpnSubId},fetch_requestedBufferSize:function(){return this.bufferSize},fetch_mode:function(){return this.mode},fetch_requestedMaxFrequency:function(){return this.requestedMaxFrequency},fetch_requestedFormat:function(){return this.requestedFormat},fetch_requestedTrigger:function(){return this.requestedTrigger},relate:function(t){this.m_manager=t},unrelate:function(t){t==this.m_manager&&(this.m_manager=null)},toString:function(){var t=ge._new();return ge.set(t,"mode",this.mode),ge.set(t,"items",null!=this.items?m.string(this.items):this.group),ge.set(t,"fields",null!=this.fields?m.string(this.fields):this.schema),ge.set(t,"dataAdapter",this.dataAdapter),ge.set(t,"requestedBufferSize",this.bufferSize),ge.set(t,"requestedMaxFrequency",this.requestedMaxFrequency),ge.set(t,"trigger",this.requestedTrigger),ge.set(t,"notificationFormat",this.requestedFormat),ki.stringify(t.h)},__class__:oe};var he=c.LSSafariMpnBuilder=function(t){var e=null==t?null:JSON.parse(t);null==e&&(e={aps:{alert:{}}}),null==e.aps&&(e.aps={alert:{}}),null==e.aps.alert&&(e.aps.alert={}),this.obj=e};he.__name__="LSSafariMpnBuilder",he.prototype={build:function(){return this.removeNullFields(this.obj.aps),this.removeNullFields(this.obj.aps.alert),JSON.stringify(this.obj)},removeNullFields:function(t){for(var e=0,i=f.fields(t);e<i.length;){var s=i[e];++e,null==f.field(t,s)&&f.deleteField(t,s)}},getTitle:function(){return this.obj.aps.alert.title},setTitle:function(t){return this.obj.aps.alert.title=t,this},getBody:function(){return this.obj.aps.alert.body},setBody:function(t){return this.obj.aps.alert.body=t,this},getAction:function(){return this.obj.aps.alert.action},setAction:function(t){return this.obj.aps.alert.action=t,this},getUrlArguments:function(){var t=f.field(this.obj.aps,"url-args");return null==t?null:t.slice()},setUrlArguments:function(t){return this.obj.aps["url-args"]=null==t?null:t.slice(),this},__class__:he};var le={fromString:function(t){switch(t){case"DISTINCT":return"DISTINCT";case"MERGE":return"MERGE";default:throw new T("The given value is not a valid subscription mode. Admitted values are MERGE, DISTINCT")}}},ue=a["com.lightstreamer.client.mpn.MpnRequestedMaxFrequency"]={__ename__:!0,__constructs__:null,FreqLimited:(e=function(t){return{_hx_index:0,max:t,__enum__:"com.lightstreamer.client.mpn.MpnRequestedMaxFrequency",toString:r}},e._hx_name="FreqLimited",e.__params__=["max"],e),FreqUnlimited:{_hx_name:"FreqUnlimited",_hx_index:1,__enum__:"com.lightstreamer.client.mpn.MpnRequestedMaxFrequency",toString:r}};ue.__constructs__=[ue.FreqLimited,ue.FreqUnlimited];var ce=function(){};function de(t){t.splice(0,t.length)}ce.__name__="com.lightstreamer.client.mpn.MpnRequestedMaxFrequencyTools",ce.fromString=function(t){if(null==t)return null;var e;if("unlimited"==t.toLowerCase())return ue.FreqUnlimited;if(e=parseFloat(t),!isNaN(e)&&e>0)return ue.FreqLimited(e);throw new T("The given value is not valid for this setting; use null, 'unlimited' or a positive number instead")},ce.toString=function(t){if(null==t)return null;switch(t._hx_index){case 0:var e=t.max;return null==e?"null":""+e;case 1:return"unlimited"}},ce.extEquals=function(t,e){return null==t?null==e:null!=e&&S.enumEq(t,e)};var _e=function(t,e){this.key=t,this.value=e};_e.__name__="com.lightstreamer.internal._AssocArray.AssocPair",_e.prototype={__class__:_e};var pe={_new:function(){return Se._new()},arrayRead:function(t,e){var i=p.find(t,(function(t){return t.key==e}));return null==i?null:i.value},arrayWrite:function(t,e,i){return t.add(new _e(e,i)),i},remove:function(t,e){Se.removeIf(t,(function(t){return t.key==e}))},keyValueIterator:function(t){return new Pi(t.h)},containsValue:function(t,e){return p.exists(t,(function(t){return t.value==e}))}},fe=function(){};fe.__name__="com.lightstreamer.internal.IHttpClient",fe.__isInterface__=!0,fe.prototype={__class__:fe};var me=function(t,e,i,s,n,r,a){this.isCanceled=!1,this.reader=new De;var o=this;if(Ms.isDebugEnabled()&&Ms.debug("HTTP sending: "+t+" "+e+" headers("+(null==i?"null":ki.stringify(i.h))+")"),this.xhr=new XMLHttpRequest,this.xhr.open("POST",t),this.xhr.withCredentials=s,null!=i)for(var h=i.h,l=Object.keys(h),u=l.length,c=0;c<u;){var d=l[c++];this.xhr.setRequestHeader(d,h[d])}this.xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),this.xhr.send(e),this.xhr.onreadystatechange=function(){if(!o.isCanceled){var t=o.xhr.readyState;if(2==t){var e=o.xhr.status;0==e||e>=200&&e<300||(Ms.isDebugEnabled()&&Ms.debug("HTTP event: error(HTTP code "+e+")"),r(o,"Unexpected HTTP code: "+e),o.xhr.abort())}else if(t>2){for(var i=3==t?o.reader.extractNewData(o.xhr.responseText,!1):o.reader.extractNewData(o.xhr.responseText,!0),s=0;s<i.length;){var h=i[s];if(++s,o.isCanceled)return;""!=h&&(Ms.isDebugEnabled()&&Ms.debug("HTTP event: text("+h+")"),n(o,h))}4==t&&(Ms.isDebugEnabled()&&Ms.debug("HTTP event: complete"),a(o))}}},this.xhr.onerror=function(){o.isCanceled||(Ms.isDebugEnabled()&&Ms.debug("HTTP event: error(Network error)"),r(o,"Network error"))}};me.__name__="com.lightstreamer.internal.HttpClient",me.__interfaces__=[fe],me.prototype={dispose:function(){Ms.isDebugEnabled()&&Ms.debug("HTTP disposing"),this.isCanceled=!0,this.xhr.abort()},isDisposed:function(){return this.isCanceled},__class__:me};var ge={_new:function(){return new ki},set:function(t,e,i){null!=i&&(t.h[e]=null==i?"null":m.string(i))}},ve=function(t){var e=this;this.id=setTimeout((function(){e.run()}),t)};ve.__name__="com.lightstreamer.internal.JsTimer",ve.prototype={stop:function(){null!=this.id&&(clearTimeout(this.id),this.id=null)},run:function(){},__class__:ve};var Se={_new:function(){return new Di},push:function(t,e){t.add(e)},exists:function(t,e){return p.exists(t,e)},find:function(t,e){return p.find(t,e)},contains:function(t,e){return p.has(t,e)},removeIf:function(t,e){for(var i=null,s=t.h;null!=s;){if(e(s.item))return null==i?t.h=s.next:i.next=s.next,t.q==s&&(t.q=i),t.length--,!0;i=s,s=s.next}return!1}},be=function(t,e,i){w.call(this,t,e,i),this.__skipStack++};be.__name__="com.lightstreamer.internal.IllegalStateException",be.__super__=w,be.prototype=l(w.prototype,{__class__:be});var ye={fromHaxeMap:function(t){return ye.fromMapToDynamicAccess(t)},toHaxeMap:function(t){return ye.toHaxe(t)},fromMapToDynamicAccess:function(t){for(var e={},i=t.h,s=Object.keys(i),n=s.length,r=0;r<n;){var a=s[r++];e[a]=i[a]}return e},toHaxe:function(t){for(var e=new ki,i=f.fields(t),s=0;s<i.length;){var n=i[s++];e.h[n]=t[n]}return e},toDynamicAccess:function(t){return f.copy(t)}},Ee=function(){};Ee.__name__="com.lightstreamer.internal.NullTools",Ee.sure=function(t){if(null==t)throw w.thrown("null pointer in .sure() call");return t},Ee.or=function(t,e){return null==t?e:t};var we=function(){};we.__name__="com.lightstreamer.internal.IWsClient",we.__isInterface__=!0,we.prototype={__class__:we};var Te=function(){};Te.__name__="com.lightstreamer.internal.ITimer",Te.__isInterface__=!0,Te.prototype={__class__:Te};var Re=a["com.lightstreamer.internal.ReachabilityStatus"]={__ename__:!0,__constructs__:null,RSReachable:{_hx_name:"RSReachable",_hx_index:0,__enum__:"com.lightstreamer.internal.ReachabilityStatus",toString:r},RSNotReachable:{_hx_name:"RSNotReachable",_hx_index:1,__enum__:"com.lightstreamer.internal.ReachabilityStatus",toString:r}};Re.__constructs__=[Re.RSReachable,Re.RSNotReachable];var xe=function(){};xe.__name__="com.lightstreamer.internal.IReachability",xe.__isInterface__=!0,xe.prototype={__class__:xe};var Ie={_new:function(){return new Ei},synchronized:function(t,e){var i=null,s=null;t.acquire();try{s=e()}catch(t){i=w.caught(t)}if(t.release(),null!=i)throw w.thrown(i);return s}},Ce=function(){};Ce.__name__="com.lightstreamer.internal.ReachabilityManager",Ce.__interfaces__=[xe],Ce.prototype={startListening:function(t){y.get_supported()&&(window.ononline=function(){t(Re.RSReachable)},window.onoffline=function(){t(Re.RSNotReachable)})},stopListening:function(){y.get_supported()&&(window.ononline=null,window.onoffline=null)},__class__:Ce};var Le=function(t,e){this.key=t,this.val=e};Le.__name__="com.lightstreamer.internal._RequestBuilder.KeyVal",Le.prototype={toEncodedPair:function(){var t=this.key,e=encodeURIComponent(t)+"=";return t=this.val,e+encodeURIComponent(t)},toString:function(){return this.key+"="+this.val},__class__:Le};var Me=function(){this.params=[]};Me.__name__="com.lightstreamer.internal.RequestBuilder",Me.prototype={LS_reqId:function(t){this.addParamAny("LS_reqId",t)},LS_message:function(t){this.addParamString("LS_message",t)},LS_sequence:function(t){this.addParamString("LS_sequence",t)},LS_msg_prog:function(t){this.addParamAny("LS_msg_prog",t)},LS_max_wait:function(t){this.addParamAny("LS_max_wait",t)},LS_outcome:function(t){this.addParamBool("LS_outcome",t)},LS_ack:function(t){this.addParamBool("LS_ack",t)},LS_op:function(t){this.addParamString("LS_op",t)},LS_subId:function(t){this.addParamAny("LS_subId",t)},LS_mode:function(t){this.addParamString("LS_mode",t)},LS_group:function(t){this.addParamString("LS_group",t)},LS_schema:function(t){this.addParamString("LS_schema",t)},LS_data_adapter:function(t){this.addParamString("LS_data_adapter",t)},LS_requested_max_frequency:function(t){this.addParamString("LS_requested_max_frequency",t)},LS_requested_max_frequency_Float:function(t){this.addParamAny("LS_requested_max_frequency",t)},LS_requested_buffer_size:function(t){this.addParamString("LS_requested_buffer_size",t)},LS_requested_buffer_size_Int:function(t){this.addParamAny("LS_requested_buffer_size",t)},LS_cause:function(t){this.addParamString("LS_cause",t)},LS_keepalive_millis:function(t){this.addParamAny("LS_keepalive_millis",t)},LS_inactivity_millis:function(t){this.addParamAny("LS_inactivity_millis",t)},LS_requested_max_bandwidth:function(t){this.addParamString("LS_requested_max_bandwidth",t)},LS_requested_max_bandwidth_Float:function(t){this.addParamAny("LS_requested_max_bandwidth",t)},LS_adapter_set:function(t){this.addParamString("LS_adapter_set",t)},LS_user:function(t){this.addParamString("LS_user",t)},LS_password:function(t){this.addParamString("LS_password",t)},LS_cid:function(t){this.addParamString("LS_cid",t)},LS_old_session:function(t){this.addParamString("LS_old_session",t)},LS_session:function(t){this.addParamString("LS_session",t)},LS_send_sync:function(t){this.addParamBool("LS_send_sync",t)},LS_polling:function(t){this.addParamBool("LS_polling",t)},LS_polling_millis:function(t){this.addParamAny("LS_polling_millis",t)},LS_idle_millis:function(t){this.addParamAny("LS_idle_millis",t)},LS_content_length:function(t){this.addParamAny("LS_content_length",t)},LS_ttl_millis:function(t){this.addParamString("LS_ttl_millis",t)},LS_recovery_from:function(t){this.addParamAny("LS_recovery_from",t)},LS_close_socket:function(t){this.addParamBool("LS_close_socket",t)},LS_selector:function(t){this.addParamString("LS_selector",t)},LS_snapshot:function(t){this.addParamBool("LS_snapshot",t)},LS_snapshot_Int:function(t){this.addParamAny("LS_snapshot",t)},addParamString:function(t,e){this.params.push(new Le(t,e))},addParamAny:function(t,e){this.addParamString(t,""+(null==e?"null":m.string(e)))},addParamBool:function(t,e){this.addParamString(t,e?"true":"false")},getEncodedString:function(){for(var t=this.params,e=new Array(t.length),i=0,s=t.length;i<s;){var n=i++;e[n]=t[n].toEncodedPair()}return e.join("&")},toString:function(){return this.params.join(" ")},PN_deviceId:function(t){this.addParamString("PN_deviceId",t)},PN_notificationFormat:function(t){this.addParamString("PN_notificationFormat",t)},PN_trigger:function(t){this.addParamString("PN_trigger",t)},PN_coalescing:function(t){this.addParamBool("PN_coalescing",t)},PN_subscriptionId:function(t){this.addParamString("PN_subscriptionId",t)},PN_type:function(t){this.addParamString("PN_type",t)},PN_appId:function(t){this.addParamString("PN_appId",t)},PN_deviceToken:function(t){this.addParamString("PN_deviceToken",t)},PN_newDeviceToken:function(t){this.addParamString("PN_newDeviceToken",t)},PN_subscriptionStatus:function(t){this.addParamString("PN_subscriptionStatus",t)},__class__:Me};var Ne=function(t){if(this.values=[],null!=t)for(;t.hasNext();)this.insert(t.next())};Ne.__name__="com.lightstreamer.internal.Set",Ne.prototype={count:function(){return this.values.length},insert:function(t){-1==this.values.indexOf(t)&&this.values.push(t)},contains:function(t){return-1!=this.values.indexOf(t)},remove:function(t){d.remove(this.values,t)},removeAll:function(){this.values.splice(0,this.values.length)},copy:function(){return new Ne(this.iterator())},union:function(t){for(var e=new Ne,i=0,s=this.values;i<s.length;)e.insert(s[i++]);for(i=0;i<t.length;)e.insert(t[i++]);return e},subtracting:function(t){for(var e=new Ne,i=0,s=this.values;i<s.length;){var n=s[i];++i,-1==t.indexOf(n)&&e.insert(n)}return e},iterator:function(){return new Bi(this.values)},toArray:function(){return this.values},__class__:Ne};var De=function(){this.progress=0};De.__name__="com.lightstreamer.internal.StreamReader",De.prototype={extractNewData:function(t,e){var i;if(e)i=t.length;else{if((i=t.lastIndexOf("\r\n"))<0)return[];i+=2}if(i<=this.progress)return[];var s=t.substring(this.progress,i);return this.progress=i,s.split("\r\n")},streamProgress:function(t){return this.extractNewData(t,!1)},streamComplete:function(t){return this.extractNewData(t,!0)},__class__:De};var Oe=function(){};Oe.__name__="hx.concurrent.Service",Oe.__isInterface__=!0,Oe.prototype={__class__:Oe};var Pe=function(t){null==t&&(t=0),this.lock=new Ei,this._value=t};Pe.__name__="hx.concurrent.atomic._AtomicInt.AtomicIntImpl",Pe.prototype={get_value:function(){this.lock.acquire();var t=this._value;return this.lock.release(),t},set_value:function(t){return this.lock.acquire(),this._value=t,this.lock.release(),t},getAndIncrement:function(t){null==t&&(t=1),this.lock.acquire();var e=this._value;return this._value+=t,this.lock.release(),e},incrementAndGet:function(t){null==t&&(t=1),this.lock.acquire();var e=this._value+=t;return this.lock.release(),e},__class__:Pe};var ke=function(){this._stateLock=new Ei,this.state=Ki.STOPPED,this.id=ke._ids.incrementAndGet()};ke.__name__="hx.concurrent.ServiceBase",ke.__interfaces__=[Oe],ke.prototype={set_state:function(t){return this.state=t},start:function(){var t=this;this._stateLock.execute((function(){switch(t.state._hx_index){case 0:case 1:break;case 2:throw w.thrown("Service ["+m.string(t)+"] is currently stopping!");case 3:t.set_state(Ki.STARTING),t.onStart(),t.set_state(Ki.RUNNING)}}))},onStart:function(){},stop:function(){var t=this;this._stateLock.execute((function(){t.state==Ki.RUNNING&&(t.set_state(Ki.STOPPING),t.onStop(),t.set_state(Ki.STOPPED))}))},onStop:function(){},toString:function(){return ns.getClass(this).__name__+"#"+this.id},__class__:ke};var Fe=a["hx.concurrent.executor.Schedule"]={__ename__:!0,__constructs__:null,ONCE:(e=function(t){return{_hx_index:0,initialDelayMS:t,__enum__:"hx.concurrent.executor.Schedule",toString:r}},e._hx_name="ONCE",e.__params__=["initialDelayMS"],e),FIXED_DELAY:(e=function(t,e){return{_hx_index:1,intervalMS:t,initialDelayMS:e,__enum__:"hx.concurrent.executor.Schedule",toString:r}},e._hx_name="FIXED_DELAY",e.__params__=["intervalMS","initialDelayMS"],e),FIXED_RATE:(e=function(t,e){return{_hx_index:2,intervalMS:t,initialDelayMS:e,__enum__:"hx.concurrent.executor.Schedule",toString:r}},e._hx_name="FIXED_RATE",e.__params__=["intervalMS","initialDelayMS"],e),HOURLY:(e=function(t,e){return{_hx_index:3,minute:t,second:e,__enum__:"hx.concurrent.executor.Schedule",toString:r}},e._hx_name="HOURLY",e.__params__=["minute","second"],e),DAILY:(e=function(t,e,i){return{_hx_index:4,hour:t,minute:e,second:i,__enum__:"hx.concurrent.executor.Schedule",toString:r}},e._hx_name="DAILY",e.__params__=["hour","minute","second"],e),WEEKLY:(e=function(t,e,i,s){return{_hx_index:5,day:t,hour:e,minute:i,second:s,__enum__:"hx.concurrent.executor.Schedule",toString:r}},e._hx_name="WEEKLY",e.__params__=["day","hour","minute","second"],e)};Fe.__constructs__=[Fe.ONCE,Fe.FIXED_DELAY,Fe.FIXED_RATE,Fe.HOURLY,Fe.DAILY,Fe.WEEKLY];var Ae=function(){this.completionListeners=ji._new(),ke.call(this)};Ae.__name__="hx.concurrent.executor.Executor",Ae.create=function(t,e){return null==e&&(e=!0),new qe(e)},Ae.__super__=ke,Ae.prototype=l(ke.prototype,{notifyResult:function(t){for(var e=this.completionListeners._items,i=0;i<e.length;){var s=e[i++];try{s(t)}catch(t){}}},onCompletion:function(t){this.completionListeners.add(t)},stop:function(){ke.prototype.stop.call(this)},__class__:Ae});var qe=function(t){null==t&&(t=!0),this._scheduledTasks=[],Ae.call(this),t&&this.start()};function Be(){return Ae.create()}qe.__name__="hx.concurrent.executor.TimerExecutor",qe.__super__=Ae,qe.prototype=l(Ae.prototype,{submit:function(t,e){var i=this,s=null==e?Ae.NOW_ONCE:e;return this._stateLock.execute((function(){if(i.state!=Ki.RUNNING)throw w.thrown("Cannot accept new tasks. Executor is not in state [RUNNING] but ["+m.string(i.state)+"].");for(var e=i._scheduledTasks.length;e-- >0;)i._scheduledTasks[e].isStopped&&i._scheduledTasks.splice(e,1);var n=new ts(i,t,s);if(0==s._hx_index){var r=s.initialDelayMS;(null==r||0!=r)&&i._scheduledTasks.push(n)}else i._scheduledTasks.push(n);return n}))},onStop:function(){for(var t=0,e=this._scheduledTasks;t<e.length;)e[t++].cancel();this._scheduledTasks=[]},__class__:qe});var Ue={_new:function(t){return t},toMillis:function(t){return t},toLong:function(t){return t}},We={_new:function(t){return t},now:function(){return d.now()/1e3},plus:function(t,e){return 1e3*t+e},minus:function(t,e){return 1e3*(t-e)},toFloat:function(t){return t}},He=function(t,e,i){var s=this;this.task=Ls.submit(es.a((function(){i(s)})),Fe.ONCE(e))};He.__name__="com.lightstreamer.internal.Timer",He.__interfaces__=[Te],He.stamp=function(){return d.now()/1e3},He.prototype={cancel:function(){this.task.cancel()},isCanceled:function(){return this.task.isStopped},__class__:He};var Ve=a["com.lightstreamer.internal.FieldValue"]={__ename__:!0,__constructs__:null,unchanged:{_hx_name:"unchanged",_hx_index:0,__enum__:"com.lightstreamer.internal.FieldValue",toString:r},changed:(e=function(t){return{_hx_index:1,val:t,__enum__:"com.lightstreamer.internal.FieldValue",toString:r}},e._hx_name="changed",e.__params__=["val"],e),jsonPatch:(e=function(t){return{_hx_index:2,patch:t,__enum__:"com.lightstreamer.internal.FieldValue",toString:r}},e._hx_name="jsonPatch",e.__params__=["patch"],e),diffPatch:(e=function(t){return{_hx_index:3,patch:t,__enum__:"com.lightstreamer.internal.FieldValue",toString:r}},e._hx_name="diffPatch",e.__params__=["patch"],e)};Ve.__constructs__=[Ve.unchanged,Ve.changed,Ve.jsonPatch,Ve.diffPatch];var Ye={_new:function(t){return t},fromIntGt0:function(t){if(t<=0)throw new T("value must be greater than zero");return t},fromIntGtEq0:function(t){if(t<0)throw new T("value must be greater than or equal to zero");return t},gti:function(t,e){return t>e},gt:function(t,e){return t>e},lt:function(t,e){return t<e},plus:function(t,e){return t+e},minus:function(t,e){return t-e},toInt:function(t){return t}},Ge={_new:function(t){return t},fromIntGt0:function(t){if(t<=0)throw new T("value must be greater than zero");return t}},Ke={fromString:function(t){if(null==t)return null;switch(t){case"HTTP":return"HTTP";case"HTTP-POLLING":return"HTTP-POLLING";case"HTTP-STREAMING":return"HTTP-STREAMING";case"WS":return"WS";case"WS-POLLING":return"WS-POLLING";case"WS-STREAMING":return"WS-STREAMING";default:throw new T("The given value is not valid. Use one of: HTTP-STREAMING, HTTP-POLLING, WS-STREAMING, WS-POLLING, WS, HTTP or null")}}},ze=a["com.lightstreamer.internal.RequestedMaxBandwidth"]={__ename__:!0,__constructs__:null,BWLimited:(e=function(t){return{_hx_index:0,bw:t,__enum__:"com.lightstreamer.internal.RequestedMaxBandwidth",toString:r}},e._hx_name="BWLimited",e.__params__=["bw"],e),BWUnlimited:{_hx_name:"BWUnlimited",_hx_index:1,__enum__:"com.lightstreamer.internal.RequestedMaxBandwidth",toString:r}};ze.__constructs__=[ze.BWLimited,ze.BWUnlimited];var je=function(){};je.__name__="com.lightstreamer.internal.RequestedMaxBandwidthTools",je.fromString=function(t){var e;if("unlimited"==t.toLowerCase())return ze.BWUnlimited;if(e=parseFloat(t),!isNaN(e)&&e>0)return ze.BWLimited(e);throw new T('The given value is a not valid value for RequestedMaxBandwidth. Use a positive number or the string "unlimited"')},je.toString=function(t){switch(t._hx_index){case 0:var e=t.bw;return null==e?"null":""+e;case 1:return"unlimited"}};var Qe=a["com.lightstreamer.internal.RequestedBufferSize"]={__ename__:!0,__constructs__:null,BSLimited:(e=function(t){return{_hx_index:0,size:t,__enum__:"com.lightstreamer.internal.RequestedBufferSize",toString:r}},e._hx_name="BSLimited",e.__params__=["size"],e),BSUnlimited:{_hx_name:"BSUnlimited",_hx_index:1,__enum__:"com.lightstreamer.internal.RequestedBufferSize",toString:r}};Qe.__constructs__=[Qe.BSLimited,Qe.BSUnlimited];var Xe=function(){};Xe.__name__="com.lightstreamer.internal.RequestedBufferSizeTools",Xe.fromString=function(t){if(null==t)return null;var e;if("unlimited"==t.toLowerCase())return Qe.BSUnlimited;if(null!=(e=m.parseInt(t))&&e>0)return Qe.BSLimited(e);throw new T("The given value is not valid for this setting; use null, 'unlimited' or a positive integer instead")},Xe.toString=function(t){if(null==t)return null;switch(t._hx_index){case 0:var e=t.size;return null==e?"null":""+e;case 1:return"unlimited"}},Xe.extEquals=function(t,e){return null==t?null==e:null!=e&&S.enumEq(t,e)};var Ze=a["com.lightstreamer.internal.RequestedSnapshot"]={__ename__:!0,__constructs__:null,SnpYes:{_hx_name:"SnpYes",_hx_index:0,__enum__:"com.lightstreamer.internal.RequestedSnapshot",toString:r},SnpNo:{_hx_name:"SnpNo",_hx_index:1,__enum__:"com.lightstreamer.internal.RequestedSnapshot",toString:r},SnpLength:(e=function(t){return{_hx_index:2,len:t,__enum__:"com.lightstreamer.internal.RequestedSnapshot",toString:r}},e._hx_name="SnpLength",e.__params__=["len"],e)};Ze.__constructs__=[Ze.SnpYes,Ze.SnpNo,Ze.SnpLength];var Je=function(){};Je.__name__="com.lightstreamer.internal.RequestedSnapshotTools",Je.fromString=function(t){if(null==t)return null;var e;switch(t.toLowerCase()){case"no":return Ze.SnpNo;case"yes":return Ze.SnpYes;default:if(null!=(e=m.parseInt(t))&&e>0)return Ze.SnpLength(e);throw new T("The given value is not valid for this setting; use null, 'yes', 'no' or a positive number instead")}},Je.toString=function(t){if(null==t)return null;switch(t._hx_index){case 0:return"yes";case 1:return"no";case 2:var e=t.len;return null==e?"null":""+e}};var $e=a["com.lightstreamer.internal.RequestedMaxFrequency"]={__ename__:!0,__constructs__:null,FreqLimited:(e=function(t){return{_hx_index:0,max:t,__enum__:"com.lightstreamer.internal.RequestedMaxFrequency",toString:r}},e._hx_name="FreqLimited",e.__params__=["max"],e),FreqUnlimited:{_hx_name:"FreqUnlimited",_hx_index:1,__enum__:"com.lightstreamer.internal.RequestedMaxFrequency",toString:r},FreqUnfiltered:{_hx_name:"FreqUnfiltered",_hx_index:2,__enum__:"com.lightstreamer.internal.RequestedMaxFrequency",toString:r}};$e.__constructs__=[$e.FreqLimited,$e.FreqUnlimited,$e.FreqUnfiltered];var ti=function(){};ti.__name__="com.lightstreamer.internal.RequestedMaxFrequencyTools",ti.fromString=function(t){if(null==t)return null;var e;switch(t.toLowerCase()){case"unfiltered":return $e.FreqUnfiltered;case"unlimited":return $e.FreqUnlimited;default:if(e=parseFloat(t),!isNaN(e)&&e>0)return $e.FreqLimited(e);throw new T("The given value is not valid for this setting; use null, 'unlimited', 'unfiltered' or a positive number instead")}},ti.toString=function(t){if(null==t)return null;switch(t._hx_index){case 0:var e=t.max;return null==e?"null":""+e;case 1:return"unlimited";case 2:return"unfiltered"}},ti.extEquals=function(t,e){return null==t?null==e:null!=e&&S.enumEq(t,e)};var ei=a["com.lightstreamer.internal.RealMaxFrequency"]={__ename__:!0,__constructs__:null,RFreqLimited:(e=function(t){return{_hx_index:0,freq:t,__enum__:"com.lightstreamer.internal.RealMaxFrequency",toString:r}},e._hx_name="RFreqLimited",e.__params__=["freq"],e),RFreqUnlimited:{_hx_name:"RFreqUnlimited",_hx_index:1,__enum__:"com.lightstreamer.internal.RealMaxFrequency",toString:r}};ei.__constructs__=[ei.RFreqLimited,ei.RFreqUnlimited];var ii=a["com.lightstreamer.internal.RealMaxBandwidth"]={__ename__:!0,__constructs__:null,BWLimited:(e=function(t){return{_hx_index:0,bw:t,__enum__:"com.lightstreamer.internal.RealMaxBandwidth",toString:r}},e._hx_name="BWLimited",e.__params__=["bw"],e),BWUnlimited:{_hx_name:"BWUnlimited",_hx_index:1,__enum__:"com.lightstreamer.internal.RealMaxBandwidth",toString:r},BWUnmanaged:{_hx_name:"BWUnmanaged",_hx_index:2,__enum__:"com.lightstreamer.internal.RealMaxBandwidth",toString:r}};ii.__constructs__=[ii.BWLimited,ii.BWUnlimited,ii.BWUnmanaged];var si=function(){};si.__name__="com.lightstreamer.internal.RealMaxBandwidthTools",si.toString=function(t){if(null==t)return null;switch(t._hx_index){case 0:var e=t.bw;return null==e?"null":""+e;case 1:return"unlimited";case 2:return"unmanaged"}};var ni={fromString:function(t){switch(t){case"COMMAND":return"COMMAND";case"DISTINCT":return"DISTINCT";case"MERGE":return"MERGE";case"RAW":return"RAW";default:throw new T("The given value is not a valid subscription mode. Admitted values are MERGE, DISTINCT, RAW, COMMAND")}}},ri={_new:function(t){return t},getPos:function(t,e){var i=t.indexOf(e);return-1!=i?i+1:-1},allValidNames:function(t){return!p.exists(t,(function(t){return new u("^$| |^\\d+$","").match(t)}))},fromArray:function(t){if(null==t)return null;if(0==t.length)throw new T("Item List is empty");if(ri.allValidNames(t))return t;throw new T("Item List is invalid")}},ai={_new:function(t){return t},getPos:function(t,e){var i=t.indexOf(e);return-1!=i?i+1:-1},hasKeyField:function(t){return-1!=t.indexOf("key")},hasCommandField:function(t){return-1!=t.indexOf("command")},fromArray:function(t){if(null==t)return null;if(0==t.length)throw new T("Field List is empty");if(p.exists(t,(function(t){return new u("^$| ","").match(t)})))throw new T("Field List is invalid");return t}},oi={};function hi(t){if(null==t)return"null";switch(t._hx_index){case 0:return""+t.freq;case 1:return"unlimited"}}function li(t,e){return null==t?null==e:null!=e&&S.enumEq(t,e)}oi._new=function(t){return t},oi.fromString=function(t){if(null==t)return null;if(""==t)throw new T("The value is empty");return t};var ui=function(t,e){var i=t.indexOf("://");-1!=i?(this._protocol=t.substring(0,i)+":",t=t.substring(i+3)):this._protocol="";var s=t.indexOf("/");-1!=s?(this._pathname=t.substring(s),t=t.substring(0,s)):this._pathname="/";var n=this.extractPortStart(t);-1!=n?(this._port=t.substring(n),this._hostname=t.substring(0,n-1)):(this._port="",this._hostname=t),null!=e&&this.set_pathname(e)};ui.__name__="com.lightstreamer.internal.Url",ui.build=function(t,e){if(null!=e){var i=v.endsWith(t,"/"),s=v.startsWith(e,"/");t+=i?s?e.substring(1):e:s?e:"/"+e}return t},ui.completeControlLink=function(t,e){var i=new ui(e),s=new ui(t);return""==s.get_protocol()&&s.set_protocol(i.get_protocol()),""==s.get_port()&&s.set_port(i.get_port()),s.get_href()},ui.prototype={get_protocol:function(){return this._protocol},set_protocol:function(t){return""==t||v.endsWith(t,":")||(t+=":"),this._protocol=t,this._protocol},get_hostname:function(){return this._hostname},set_hostname:function(t){return this._hostname=t,this._hostname},get_port:function(){return this._port},set_port:function(t){return this._port=t,this._port},get_pathname:function(){return this._pathname},set_pathname:function(t){return v.startsWith(t,"/")||(t="/"+t),this._pathname=t,this._pathname},get_href:function(){var t=this._hostname;return""!=this._protocol&&(t=this._protocol+"//"+t),""!=this._port&&(t+=":"+this._port),""!=this.get_pathname()&&(t+=this._pathname),t},toString:function(){return this.get_href()},extractPortStart:function(t){var e=t.indexOf(":");return e<=-1?-1:t.indexOf("]")>-1?(e=t.indexOf("]:"))<=-1?-1:e+2:e!=t.lastIndexOf(":")?-1:e+1},__class__:ui};var ci=function(t,e,i,s){this.isCanceled=!1;var n=this;v.startsWith(t,"https://")?t=v.replace(t,"https://","wss://"):v.startsWith(t,"http://")&&(t=v.replace(t,"http://","ws://")),Ms.isDebugEnabled()&&Ms.debug("WS connecting: "+t),this.ws=new WebSocket(t,gs),this.ws.onopen=function(){n.isCanceled||(Ms.isDebugEnabled()&&Ms.debug("WS event: open"),e(n))},this.ws.onmessage=function(t){if(!n.isCanceled)for(var e=0,s=t.data.split("\r\n");e<s.length;){var r=s[e];if(++e,n.isCanceled)return;""!=r&&(Ms.isDebugEnabled()&&Ms.debug("WS event: text("+r+")"),i(n,r))}},this.ws.onerror=function(){n.isCanceled||(Ms.isDebugEnabled()&&Ms.debug("WS event: error(Network error)"),s(n,"Network error"),n.ws.close())},this.ws.onclose=function(t){if(!n.isCanceled){var e="unexpected disconnection: "+t.code+" - "+t.reason;Ms.isDebugEnabled()&&Ms.debug("WS event: error("+e+")"),s(n,e),n.ws.close()}}};ci.__name__="com.lightstreamer.internal.WsClient",ci.__interfaces__=[we],ci.prototype={send:function(t){Ms.isDebugEnabled()&&Ms.debug("WS sending: "+t),this.ws.send(t)},dispose:function(){Ms.isDebugEnabled()&&Ms.debug("WS disposing"),this.isCanceled=!0,this.ws.close()},isDisposed:function(){return this.isCanceled},__class__:ci};var di=function(t,e){this.buf=new g,this.basePos=0,this.diffPos=0,this.diff=e,this.base=t};di.__name__="com.lightstreamer.internal.patch.DiffDecoder",di.apply=function(t,e){return new di(t,e).decode()},di.prototype={decode:function(){try{for(;this.diffPos!=this.diff.length&&(this.applyCopy(),this.diffPos!=this.diff.length)&&(this.applyAdd(),this.diffPos!=this.diff.length);)this.applyDel();return this.buf.b}catch(t){throw new w("Bad TLCP-diff",w.caught(t))}},applyCopy:function(){var t=this.decodeVarint();t>0&&(this.appendToBuf(this.base,this.basePos,t),this.basePos+=t)},applyAdd:function(){var t=this.decodeVarint();t>0&&(this.appendToBuf(this.diff,this.diffPos,t),this.diffPos+=t)},applyDel:function(){var t=this.decodeVarint();t>0&&(this.basePos+=t)},decodeVarint:function(){for(var t=0;;){var e=this.charAt(this.diff,this.diffPos);if(this.diffPos+=1,e>=97&&e<123)return 26*t+(e-97);if(!(e>=65&&e<91))throw new w("The code point "+e+" is not in the range A-Z");t=26*t+(e-65)}},appendToBuf:function(t,e,i){if(!(e+i<=t.length))throw new w("Index out of range: startIndex="+e+" count="+i+" length="+t.length);this.buf.b+=null==i?d.substr(t,e,null):d.substr(t,e,i)},charAt:function(t,e){if(e<t.length)return d.cca(t.charAt(e),0);throw new w("Index out of range: pos="+e+" length="+t.length)},__class__:di};var _i={_new:function(t){return JSON.parse(t)},apply:function(t,e){return pi.apply_patch(t,e)},toString:function(t){return JSON.stringify(t)}},pi=i.exports,fi=function(){};fi.__name__="com.lightstreamer.log.AbstractLogger",fi.__interfaces__=[s],fi.prototype={__class__:fi};var mi=c.LSConsoleLogLevel=function(){};mi.__name__="LSConsoleLogLevel",mi.prototype={__class__:mi};var gi=c.LSConsoleLoggerProvider=function(t){this.level=t};gi.__name__="LSConsoleLoggerProvider",gi.__interfaces__=[n],gi.prototype={getLogger:function(t){return new vi(this.level,t)},__class__:gi};var vi=function(t,e){this.level=t,this.category=e,this.traceEnabled=t<=mi.TRACE,this.debugEnabled=t<=mi.DEBUG,this.infoEnabled=t<=mi.INFO,this.warnEnabled=t<=mi.WARN,this.errorEnabled=t<=mi.ERROR,this.fatalEnabled=t<=mi.FATAL};vi.__name__="com.lightstreamer.log._ConsoleLoggerProvider.ConsoleLogger",vi.__super__=fi,vi.prototype=l(fi.prototype,{printLog:function(e){t.console.log(e)},format:function(t,e){return d.dateStr(new Date)+"|"+t+"|"+this.category+"|"+e},logFatal:function(e){t.console.log(e)},logError:function(e){t.console.log(e)},logWarn:function(e){t.console.log(e)},logInfo:function(e){t.console.log(e)},logDebug:function(e){t.console.log(e)},logTrace:function(e){t.console.log(e)},fatal:function(e,i){if(this.fatalEnabled){var s=this.format("FATAL",e);t.console.log(s),null!=i&&(s=w.caught(i).details(),t.console.log(s))}},error:function(e,i){if(this.errorEnabled){var s=this.format("ERROR",e);t.console.log(s),null!=i&&(s=w.caught(i).details(),t.console.log(s))}},warn:function(e,i){if(this.warnEnabled){var s=this.format("WARN ",e);t.console.log(s),null!=i&&(s=w.caught(i).details(),t.console.log(s))}},info:function(e,i){if(this.infoEnabled){var s=this.format("INFO ",e);t.console.log(s),null!=i&&(s=w.caught(i).details(),t.console.log(s))}},debug:function(e,i){if(this.debugEnabled){var s=this.format("DEBUG",e);t.console.log(s),null!=i&&(s=w.caught(i).details(),t.console.log(s))}},trace:function(e,i){if(this.traceEnabled){var s=this.format("TRACE",e);t.console.log(s),null!=i&&(s=w.caught(i).details(),t.console.log(s))}},isFatalEnabled:function(){return this.fatalEnabled},isErrorEnabled:function(){return this.errorEnabled},isWarnEnabled:function(){return this.warnEnabled},isInfoEnabled:function(){return this.infoEnabled},isDebugEnabled:function(){return this.debugEnabled},isTraceEnabled:function(){return this.traceEnabled},__class__:vi});var Si=function(){};Si.__name__="com.lightstreamer.log._LogManager.EmptyLogger",Si.__super__=fi,Si.prototype=l(fi.prototype,{fatal:function(t,e){},error:function(t,e){},warn:function(t,e){},info:function(t,e){},debug:function(t,e){},trace:function(t,e){},isFatalEnabled:function(){return!1},isErrorEnabled:function(){return!1},isWarnEnabled:function(){return!1},isInfoEnabled:function(){return!1},isDebugEnabled:function(){return!1},isTraceEnabled:function(){return!1},__class__:Si});var bi=function(){};bi.__name__="hx.concurrent.lock.Acquirable",bi.__isInterface__=!0,bi.prototype={__class__:bi};var yi=function(){};yi.__name__="hx.concurrent.lock.AbstractAcquirable",yi.__interfaces__=[bi],yi.prototype={execute:function(t,e){null==e&&(e=!1);var i=null,s=null;this.acquire();try{s=t()}catch(t){i=new Wi(w.caught(t))}if(this.release(),!e&&null!=i)throw w.thrown(i.toString());return s},__class__:yi};var Ei=function(){this._holderEntranceCount=0,this._holder=null};Ei.__name__="hx.concurrent.lock.RLock",Ei.__super__=yi,Ei.prototype=l(yi.prototype,{get_availablePermits:function(){return null!=this._holder?0:1},get_isAcquiredByAnyThread:function(){return null!=this._holder},get_isAcquiredByCurrentThread:function(){return this._holder==ss.get_current()},get_isAcquiredByOtherThread:function(){return null!=this._holder&&this._holder!=ss.get_current()},acquire:function(){this._holder=ss.get_current(),this._holderEntranceCount++},tryAcquire:function(t){if(null==t&&(t=0),t<0)throw w.thrown("[timeoutMS] must be >= 0");return(null==this._holder||this._holder==ss.get_current())&&(this._holder=ss.get_current(),this._holderEntranceCount++,!0)},tryAcquireInternal:function(t){return null==this._holder||this._holder==ss.get_current()},release:function(){if(this._holder!=ss.get_current())throw null!=this._holder&&this._holder!=ss.get_current()?w.thrown("Lock was aquired by another thread!"):w.thrown("Lock was not aquired by any thread!");this._holderEntranceCount--,0==this._holderEntranceCount&&(this._holder=null)},__class__:Ei});var wi=function(){};wi.__name__="com.lightstreamer.log.LogManager",wi.getLogger=function(t){return Ie.synchronized(wi.lock,(function(){var e=wi.logInstances.h[t];if(null==e){var i=new Ti(null==wi.currentLoggerProvider?wi.emptyLogger:wi.currentLoggerProvider.getLogger(t));wi.logInstances.h[t]=i,e=i}return e}))},wi.setLoggerProvider=function(t){Ie.synchronized(wi.lock,(function(){wi.currentLoggerProvider=t;for(var e=wi.logInstances.h,i=Object.keys(e),s=i.length,n=0;n<s;){var r=i[n++];e[r].wrappedLogger=null==wi.currentLoggerProvider?wi.emptyLogger:wi.currentLoggerProvider.getLogger(r)}}))},wi.newLogger=function(t){return null==wi.currentLoggerProvider?wi.emptyLogger:wi.currentLoggerProvider.getLogger(t)};var Ti=function(t){this.wrappedLogger=t};Ti.__name__="com.lightstreamer.log._LogManager.LoggerProxy",Ti.__super__=fi,Ti.prototype=l(fi.prototype,{fatal:function(t,e){this.wrappedLogger.fatal(t,e)},error:function(t,e){this.wrappedLogger.error(t,e)},warn:function(t,e){this.wrappedLogger.warn(t,e)},info:function(t,e){this.wrappedLogger.info(t,e)},debug:function(t,e){this.wrappedLogger.debug(t,e)},trace:function(t,e){this.wrappedLogger.trace(t,e)},isFatalEnabled:function(){return this.wrappedLogger.isFatalEnabled()},isErrorEnabled:function(){return this.wrappedLogger.isErrorEnabled()},isWarnEnabled:function(){return this.wrappedLogger.isWarnEnabled()},isInfoEnabled:function(){return this.wrappedLogger.isInfoEnabled()},isDebugEnabled:function(){return this.wrappedLogger.isDebugEnabled()},isTraceEnabled:function(){return this.wrappedLogger.isTraceEnabled()},__class__:Ti});var Ri=a["haxe.StackItem"]={__ename__:!0,__constructs__:null,CFunction:{_hx_name:"CFunction",_hx_index:0,__enum__:"haxe.StackItem",toString:r},Module:(e=function(t){return{_hx_index:1,m:t,__enum__:"haxe.StackItem",toString:r}},e._hx_name="Module",e.__params__=["m"],e),FilePos:(e=function(t,e,i,s){return{_hx_index:2,s:t,file:e,line:i,column:s,__enum__:"haxe.StackItem",toString:r}},e._hx_name="FilePos",e.__params__=["s","file","line","column"],e),Method:(e=function(t,e){return{_hx_index:3,classname:t,method:e,__enum__:"haxe.StackItem",toString:r}},e._hx_name="Method",e.__params__=["classname","method"],e),LocalFunction:(e=function(t){return{_hx_index:4,v:t,__enum__:"haxe.StackItem",toString:r}},e._hx_name="LocalFunction",e.__params__=["v"],e)};Ri.__constructs__=[Ri.CFunction,Ri.Module,Ri.FilePos,Ri.Method,Ri.LocalFunction];var xi={callStack:function(){return Ci.toHaxe(Ci.callStack())},exceptionStack:function(t){null==t&&(t=!1);var e=Ci.toHaxe(Ci.exceptionStack());return t?e:xi.subtract(e,xi.callStack())},toString:function(t){for(var e=new g,i=0,s=t;i<s.length;){var n=s[i++];e.b+="\nCalled from ",xi.itemToString(e,n)}return e.b},subtract:function(t,e){for(var i=-1,s=-1;++s<t.length;){for(var n=0,r=e.length;n<r;)if(xi.equalItems(t[s],e[n++])){if(i<0&&(i=s),++s>=t.length)break}else i=-1;if(i>=0)break}return i>=0?t.slice(0,i):t},equalItems:function(t,e){if(null==t)return null==e;switch(t._hx_index){case 0:return null!=e&&0==e._hx_index;case 1:return null!=e&&1==e._hx_index&&t.m==e.m;case 2:return null!=e&&2==e._hx_index&&t.file==e.file&&t.line==e.line&&t.column==e.column&&xi.equalItems(t.s,e.s);case 3:return null!=e&&3==e._hx_index&&t.classname==e.classname&&t.method==e.method;case 4:return null!=e&&4==e._hx_index&&t.v==e.v}},itemToString:function(t,e){switch(e._hx_index){case 0:t.b+="a C function";break;case 1:var i=e.m;t.b=(t.b+="module ")+(null==i?"null":""+i);break;case 2:i=e.s;var s=e.file,n=e.line,r=e.column;null!=i&&(xi.itemToString(t,i),t.b+=" ("),t.b=(t.b+=null==s?"null":""+s)+" line ",t.b+=null==n?"null":""+n,null!=r&&(t.b=(t.b+=" column ")+(null==r?"null":""+r)),null!=i&&(t.b+=")");break;case 3:i=e.classname,s=e.method,t.b=(t.b+=m.string(null==i?"<unknown>":i))+".",t.b+=null==s?"null":""+s;break;case 4:i=e.v,t.b=(t.b+="local function #")+(null==i?"null":""+i)}}},Ii=function(){};Ii.__name__="haxe.IMap",Ii.__isInterface__=!0,Ii.prototype={__class__:Ii};var Ci=function(){};Ci.__name__="haxe.NativeStackTrace",Ci.saveStack=function(t){Ci.lastError=t},Ci.callStack=function(){var t=new Error(""),e=Ci.tryHaxeStack(t);if(void 0===e){try{throw t}catch(t){}e=t.stack}return Ci.normalize(e,2)},Ci.exceptionStack=function(){return Ci.normalize(Ci.tryHaxeStack(Ci.lastError))},Ci.toHaxe=function(t,e){if(null==e&&(e=0),null==t)return[];if("string"==typeof t){var i=t.split("\n");"Error"==i[0]&&i.shift();for(var s=[],n=0,r=i.length;n<r;){var a=n++;if(!(e>a)){var o=i[a],h=o.match(/^    at ([$A-Za-z0-9_. ]+) \(([^)]+):([0-9]+):([0-9]+)\)$/);if(null!=h){var l=h[1].split(".");"$hxClasses"==l[0]&&l.shift();var u=l.pop(),c=h[2],d=m.parseInt(h[3]),_=m.parseInt(h[4]);s.push(Ri.FilePos("Anonymous function"==u?Ri.LocalFunction():"Global code"==u?null:Ri.Method(l.join("."),u),c,d,_))}else s.push(Ri.Module(v.trim(o)))}}return s}return e>0&&Array.isArray(t)?t.slice(e):t},Ci.tryHaxeStack=function(t){if(null==t)return[];var e=Error.prepareStackTrace;Error.prepareStackTrace=Ci.prepareHxStackTrace;var i=t.stack;return Error.prepareStackTrace=e,i},Ci.prepareHxStackTrace=function(t,e){for(var i=[],s=0;s<e.length;){var n=e[s];++s,null!=Ci.wrapCallSite&&(n=Ci.wrapCallSite(n));var r=null,a=n.getFunctionName();if(null!=a){var o=a.lastIndexOf(".");r=o>=0?Ri.Method(a.substring(0,o),a.substring(o+1)):Ri.Method(null,a)}var h=n.getFileName(),l=null==h?-1:h.indexOf("file:");null!=Ci.wrapCallSite&&l>0&&(h=h.substring(l+6)),i.push(Ri.FilePos(r,h,n.getLineNumber(),n.getColumnNumber()))}return i},Ci.normalize=function(t,e){if(null==e&&(e=0),Array.isArray(t)&&e>0)return t.slice(e);if("string"==typeof t){switch(t.substring(0,6)){case"Error\n":case"Error:":++e}return Ci.skipLines(t,e)}return t},Ci.skipLines=function(t,e,i){for(null==i&&(i=0);;){if(!(e>0))return t.substring(i);if((i=t.indexOf("\n",i))<0)return"";e=--e,i+=1}};var Li=function(t){var e=this;this.id=setInterval((function(){e.run()}),t)};Li.__name__="haxe.Timer",Li.delay=function(t,e){var i=new ve(e);return i.run=t,i},Li.prototype={stop:function(){null!=this.id&&(clearInterval(this.id),this.id=null)},run:function(){},__class__:Li};var Mi=function(t,e,i){w.call(this,String(t),e,i),this.value=t,this.__skipStack++};Mi.__name__="haxe.ValueException",Mi.__super__=w,Mi.prototype=l(w.prototype,{__class__:Mi});var Ni=function(){this.h={}};Ni.__name__="haxe.ds.IntMap",Ni.__interfaces__=[Ii],Ni.prototype={get:function(t){return this.h[t]},remove:function(t){return!!this.h.hasOwnProperty(t)&&(delete this.h[t],!0)},keys:function(){var t=[];for(var e in this.h)this.h.hasOwnProperty(e)&&t.push(+e);return new Bi(t)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){var t=this.it.next();return this.ref[t]}}},copy:function(){for(var t=new Ni,e=this.keys();e.hasNext();){var i=e.next();t.h[i]=this.h[i]}return t},__class__:Ni};var Di=function(){this.length=0};Di.__name__="haxe.ds.List",Di.prototype={add:function(t){var e=new Oi(t,null);null==this.h?this.h=e:this.q.next=e,this.q=e,this.length++},remove:function(t){for(var e=null,i=this.h;null!=i;){if(i.item==t)return null==e?this.h=i.next:e.next=i.next,this.q==i&&(this.q=e),this.length--,!0;e=i,i=i.next}return!1},iterator:function(){return new Pi(this.h)},filter:function(t){for(var e=new Di,i=this.h;null!=i;){var s=i.item;i=i.next,t(s)&&e.add(s)}return e},map:function(t){for(var e=new Di,i=this.h;null!=i;){var s=i.item;i=i.next,e.add(t(s))}return e},__class__:Di};var Oi=function(t,e){this.item=t,this.next=e};Oi.__name__="haxe.ds._List.ListNode",Oi.prototype={__class__:Oi};var Pi=function(t){this.head=t};Pi.__name__="haxe.ds._List.ListIterator",Pi.prototype={hasNext:function(){return null!=this.head},next:function(){var t=this.head.item;return this.head=this.head.next,t},__class__:Pi};var ki=function(){this.h=Object.create(null)};ki.__name__="haxe.ds.StringMap",ki.__interfaces__=[Ii],ki.createCopy=function(t){var e=new ki;for(var i in t)e.h[i]=t[i];return e},ki.stringify=function(t){var e="{",i=!0;for(var s in t)i?i=!1:e+=",",e+=s+" => "+m.string(t[s]);return e+"}"},ki.prototype={get:function(t){return this.h[t]},keys:function(){return new Fi(this.h)},iterator:function(){return new Ai(this.h)},__class__:ki};var Fi=function(t){this.h=t,this.keys=Object.keys(t),this.length=this.keys.length,this.current=0};Fi.__name__="haxe.ds._StringMap.StringMapKeyIterator",Fi.prototype={hasNext:function(){return this.current<this.length},next:function(){return this.keys[this.current++]},__class__:Fi};var Ai=function(t){this.h=t,this.keys=Object.keys(t),this.length=this.keys.length,this.current=0};Ai.__name__="haxe.ds._StringMap.StringMapValueIterator",Ai.prototype={hasNext:function(){return this.current<this.length},next:function(){return this.h[this.keys[this.current++]]},__class__:Ai};var qi=a["haxe.io.Error"]={__ename__:!0,__constructs__:null,Blocked:{_hx_name:"Blocked",_hx_index:0,__enum__:"haxe.io.Error",toString:r},Overflow:{_hx_name:"Overflow",_hx_index:1,__enum__:"haxe.io.Error",toString:r},OutsideBounds:{_hx_name:"OutsideBounds",_hx_index:2,__enum__:"haxe.io.Error",toString:r},Custom:(e=function(t){return{_hx_index:3,e:t,__enum__:"haxe.io.Error",toString:r}},e._hx_name="Custom",e.__params__=["e"],e)};qi.__constructs__=[qi.Blocked,qi.Overflow,qi.OutsideBounds,qi.Custom];var Bi=function(t){this.current=0,this.array=t};Bi.__name__="haxe.iterators.ArrayIterator",Bi.prototype={hasNext:function(){return this.current<this.array.length},next:function(){return this.array[this.current++]},__class__:Bi};var Ui=function(t,e,i){w.call(this,t,i),this.pos=e,this.__skipStack++};Ui.__name__="haxe.macro.Error",Ui.__super__=w,Ui.prototype=l(w.prototype,{__class__:Ui});var Wi=function(t){this.cause=t,this.causeStackTrace=xi.exceptionStack()};Wi.__name__="hx.concurrent.ConcurrentException",Wi.capture=function(t){return new Wi(t)},Wi.prototype={rethrow:function(){throw w.thrown(this.toString())},toString:function(){var t="";t="rethrown exception:\n",t="rethrown exception:\n  ",t+="--------------------\n",t+="  ",t+="| Exception : ",t+=m.string(this.cause),t+="\n";for(var e=0,i=xi.toString(this.causeStackTrace).split("\n");e<i.length;){var s=i[e];++e,""!=s&&(t+="  ",t+=m.string(v.replace(s,"Called from","| at")),t+="\n")}return t+="  ",t+="--------------------"},__class__:Wi};var Hi=function(){};Hi.__name__="hx.concurrent.Future",Hi.__isInterface__=!0,Hi.prototype={__class__:Hi};var Vi=a["hx.concurrent.FutureResult"]={__ename__:!0,__constructs__:null,VALUE:(e=function(t,e,i){return{_hx_index:0,result:t,time:e,future:i,__enum__:"hx.concurrent.FutureResult",toString:r}},e._hx_name="VALUE",e.__params__=["result","time","future"],e),FAILURE:(e=function(t,e,i){return{_hx_index:1,ex:t,time:e,future:i,__enum__:"hx.concurrent.FutureResult",toString:r}},e._hx_name="FAILURE",e.__params__=["ex","time","future"],e),PENDING:(e=function(t){return{_hx_index:2,future:t,__enum__:"hx.concurrent.FutureResult",toString:r}},e._hx_name="PENDING",e.__params__=["future"],e)};Vi.__constructs__=[Vi.VALUE,Vi.FAILURE,Vi.PENDING];var Yi=function(){this.sync=new Ei,this.completionListeners=[],this.result=Vi.PENDING(this)};Yi.__name__="hx.concurrent.AbstractFuture",Yi.__interfaces__=[Hi],Yi.prototype={isComplete:function(){return 2!=this.result._hx_index},onCompletion:function(t){var e=this;this.sync.execute((function(){return 2!=e.result._hx_index&&t(e.result),e.completionListeners.push(t)}))},__class__:Yi};var Gi=function(){Yi.call(this)};Gi.__name__="hx.concurrent.CompletableFuture",Gi.__super__=Yi,Gi.prototype=l(Yi.prototype,{complete:function(t,e){null==e&&(e=!1);var i=this;return this.sync.execute((function(){if(e||!i.isComplete()){switch((s=t)._hx_index){case 0:i.result=Vi.VALUE(s.v,Date.now(),i);break;case 1:i.result=Vi.FAILURE(s.v,Date.now(),i)}for(var s=0,n=i.completionListeners;s<n.length;){var r=n[s++];try{r(i.result)}catch(t){}}return!0}return!1}))},__class__:Gi});var Ki=a["hx.concurrent.ServiceState"]={__ename__:!0,__constructs__:null,STARTING:{_hx_name:"STARTING",_hx_index:0,__enum__:"hx.concurrent.ServiceState",toString:r},RUNNING:{_hx_name:"RUNNING",_hx_index:1,__enum__:"hx.concurrent.ServiceState",toString:r},STOPPING:{_hx_name:"STOPPING",_hx_index:2,__enum__:"hx.concurrent.ServiceState",toString:r},STOPPED:{_hx_name:"STOPPED",_hx_index:3,__enum__:"hx.concurrent.ServiceState",toString:r}};Ki.__constructs__=[Ki.STARTING,Ki.RUNNING,Ki.STOPPING,Ki.STOPPED];var zi=function(){};zi.__name__="hx.concurrent.collection.Collection",zi.__isInterface__=!0,zi.prototype={__class__:zi};var ji={_new:function(t){var e=new Xi;return null!=t&&e.addAll(t),e},_get:function(t,e){return t.get(e)},_set:function(t,e,i){return t._set(e,i),i}},Qi=function(){};Qi.__name__="hx.concurrent.collection.OrderedCollection",Qi.__isInterface__=!0,Qi.__interfaces__=[zi],Qi.prototype={__class__:Qi};var Xi=function(){this._sync=new Ei,this._items=[]};Xi.__name__="hx.concurrent.collection._CopyOnWriteArray.CopyOnWriteArrayImpl",Xi.__interfaces__=[Qi],Xi.prototype={_set:function(t,e){var i=this;this._sync.execute((function(){var s=i._items.slice();s[t]=e,i._items=s}))},get_first:function(){var t=this._items;return 0==t.length?null:t[0]},get_last:function(){var t=this._items;return 0==t.length?null:t[t.length-1]},get_length:function(){return this._items.length},add:function(t){var e=this;this._sync.execute((function(){var i=e._items.slice();i.push(t),e._items=i}))},addIfAbsent:function(t){var e=this;return this._sync.execute((function(){if(e._items.indexOf(t)>-1)return!1;var i=e._items.slice();return i.push(t),e._items=i,!0}))},addAll:function(t){var e=this;this._sync.execute((function(){var i=null,s=t;switch(s._hx_index){case 0:i=e._items.slice();for(var n=s.v.iterator();n.hasNext();)i.push(n.next());break;case 1:i=e._items.concat(s.v);break;case 2:i=e._items.slice();for(var r=s.v.h;null!=r;){var a=r.item;r=r.next,i.push(a)}}e._items=i}))},clear:function(){this._items=[]},insertAt:function(t,e){var i=this;this._items=this._sync.execute((function(){var s=i._items.slice();return s.splice(t,0,e),s}))},remove:function(t){var e=this;return this._sync.execute((function(){if(-1==e._items.indexOf(t))return!1;var i=e._items.slice(),s=d.remove(i,t);return e._items=i,s}))},removeAt:function(t,e){null==e&&(e=!1);var i=this;return this._sync.execute((function(){if(t<0||t>=i._items.length){if(e)throw w.thrown("Index out of range.");return null}var s=i._items.slice(),n=s.splice(t,1);return i._items=s,0==n.length?null:n[0]}))},removeFirst:function(t){null==t&&(t=!1);var e=this;return this._sync.execute((function(){if(0==e._items.length){if(t)throw w.thrown("This collection is empty.");return null}var i=e._items.slice(),s=i.shift();return e._items=i,s}))},removeLast:function(t){null==t&&(t=!1);var e=this;return this._sync.execute((function(){if(0==e._items.length){if(t)throw w.thrown("This collection is empty.");return null}var i=e._items.slice(),s=i.pop();return e._items=i,s}))},copy:function(){return ji._new(is.b(this._items.slice()))},contains:function(t){return this._items.indexOf(t,0)>-1},isEmpty:function(){return 0==this._items.length},get:function(t,e){null==e&&(e=!1);var i=this._items;if(t<0||t>=i.length){if(e)throw w.thrown("Index out of range.");return null}return i[t]},indexOf:function(t,e){return null==e&&(e=0),this._items.indexOf(t,e)},lastIndexOf:function(t,e){var i=this._items;return i.lastIndexOf(t,null==e?i.length-1:e)},filter:function(t){for(var e=this._items,i=[],s=0;s<e.length;){var n=e[s];++s,t(n)&&i.push(n)}return ji._new(is.b(i))},map:function(t){for(var e=this._items,i=new Array(e.length),s=0,n=e.length;s<n;){var r=s++;i[r]=t(e[r])}return ji._new(is.b(i))},join:function(t){return this._items.join(t)},iterator:function(){return new Bi(this._items)},toArray:function(){return this._items.slice()},toString:function(){return"["+this._items.toString()+"]"},__class__:Xi};var Zi=function(){};Zi.__name__="hx.concurrent.executor.TaskFuture",Zi.__isInterface__=!0,Zi.__interfaces__=[Hi],Zi.prototype={__class__:Zi};var Ji=function(t,e,i){this.isStopped=!1,Gi.call(this),this._executor=t,this._task=e,this.schedule=$i.assertValid(i)};Ji.__name__="hx.concurrent.executor.AbstractTaskFuture",Ji.__interfaces__=[Zi],Ji.__super__=Gi,Ji.prototype=l(Gi.prototype,{cancel:function(){this.isStopped=!0},__class__:Ji});var $i=function(){};$i.__name__="hx.concurrent.executor.ScheduleTools",$i.applyDefaults=function(t){switch(t._hx_index){case 0:if(null==t.initialDelayMS)return Fe.ONCE(0);break;case 1:if(null==t.initialDelayMS)return Fe.FIXED_DELAY(t.intervalMS,0);break;case 2:if(null==t.initialDelayMS)return Fe.FIXED_RATE(t.intervalMS,0);break;case 3:var e=t.minute,i=t.second;if(null==e||null==i)return Fe.HOURLY(null==e?0:e,null==i?0:i);break;case 4:e=t.hour,i=t.minute;var s=t.second;if(null==e||null==i||null==s)return Fe.DAILY(null==e?0:e,null==i?0:i,null==s?0:s);break;case 5:e=t.day,i=t.hour,s=t.minute;var n=t.second;if(null==e||null==i||null==s||null==n)return Fe.WEEKLY(null==e?0:e,null==i?0:i,null==s?0:s,null==n?0:n)}return t},$i.assertValid=function(t){switch((t=$i.applyDefaults(t))._hx_index){case 0:if(t.initialDelayMS<0)throw w.thrown("[Schedule.ONCE.initialDelayMS] must be >= 0");break;case 1:var e=t.initialDelayMS;if(t.intervalMS<=0)throw w.thrown("[Schedule.FIXED_DELAY.intervalMS] must be > 0");if(null==e||e<0)throw w.thrown("[Schedule.FIXED_DELAY.initialDelayMS] must be >= 0");break;case 2:if(t.intervalMS<=0)throw w.thrown("[Schedule.FIXED_RATE.intervalMS] must be > 0");if(t.initialDelayMS<0)throw w.thrown("[Schedule.FIXED_RATE.initialDelayMS] must be >= 0");break;case 3:e=t.minute;var i=t.second;if(null==e||e<0)throw w.thrown("[Schedule.DAILY.minute] must be between >= 0 and <= 59");if(null==i||i<0)throw w.thrown("[Schedule.DAILY.second] must be between >= 0 and <= 59");break;case 4:e=t.hour,i=t.minute;var s=t.second;if(null==e||e<0)throw w.thrown("[Schedule.DAILY.hour] must be between >= 0 and <= 23");if(null==i||i<0)throw w.thrown("[Schedule.DAILY.minute] must be between >= 0 and <= 59");if(null==s||s<0)throw w.thrown("[Schedule.DAILY.second] must be between >= 0 and <= 59");break;case 5:if(e=t.hour,i=t.minute,s=t.second,null==e||e<0)throw w.thrown("[Schedule.WEEKLY.hour] must be between >= 0 and <= 23");if(null==i||i<0)throw w.thrown("[Schedule.WEEKLY.minute] must be between >= 0 and <= 59");if(null==s||s<0)throw w.thrown("[Schedule.WEEKLY.second] must be between >= 0 and <= 59")}return t},$i.firstRunAt=function(t){switch((t=$i.assertValid(t))._hx_index){case 0:case 1:case 2:return Date.now()+t.initialDelayMS;case 3:var e=Date.now(),i=new Date(e),s=60*t.minute+t.second,n=60*i.getMinutes()+i.getSeconds();return e+1e3*(s-n)+(n>s?36e5:0);case 4:return e=Date.now(),i=new Date(e),e+1e3*((r=60*t.hour*60+60*t.minute+t.second)-(a=60*i.getHours()*60+60*i.getMinutes()+i.getSeconds()))+(a>r?864e5:0);case 5:e=Date.now(),i=new Date(e);var r=60*t.hour*60+60*t.minute+t.second,a=60*i.getHours()*60+60*i.getMinutes()+i.getSeconds(),o=t.day;return o==i.getDay()?e+1e3*(r-a)+(a>r?6048e5:0):i.getDate()<o?e+1e3*(r-a)+864e5*(o-i.getDate()):e+1e3*(r-a)+864e5*(7-(o-i.getDate()))}};var ts=function(t,e,i){Ji.call(this,t,e,i);var s=$i.firstRunAt(this.schedule)-Date.now()|0;s<0&&(s=0),Li.delay(os(this,this.run),s)};ts.__name__="hx.concurrent.executor._TimerExecutor.TaskFutureImpl",ts.__super__=Ji,ts.prototype=l(Ji.prototype,{run:function(){if(!this.isStopped){if(null==this._timer){var t=null;switch((i=this.schedule)._hx_index){case 2:(t=new Li(i.intervalMS)).run=os(this,this.run);break;case 3:(t=new Li(36e5)).run=os(this,this.run);break;case 4:(t=new Li(864e5)).run=os(this,this.run);break;case 5:(t=new Li(6048e5)).run=os(this,this.run)}this._timer=t}var e;try{var i;switch((i=this._task)._hx_index){case 0:e=es.a(i.v());break;case 1:i.v(),e=null}}catch(i){e=es.b(new Wi(w.caught(i)))}switch((i=this.schedule)._hx_index){case 0:this.isStopped=!0;break;case 1:this._timer=Li.delay(os(this,this.run),i.intervalMS)}this.complete(e,!0),this._executor.notifyResult(this.result)}},cancel:function(){var t=this._timer;null!=t&&t.stop(),Ji.prototype.cancel.call(this)},__class__:ts});var es=a["hx.concurrent.internal._Either2._Either2"]={__ename__:!0,__constructs__:null,a:(e=function(t){return{_hx_index:0,v:t,__enum__:"hx.concurrent.internal._Either2._Either2",toString:r}},e._hx_name="a",e.__params__=["v"],e),b:(e=function(t){return{_hx_index:1,v:t,__enum__:"hx.concurrent.internal._Either2._Either2",toString:r}},e._hx_name="b",e.__params__=["v"],e)};es.__constructs__=[es.a,es.b];var is=a["hx.concurrent.internal._Either3._Either3"]={__ename__:!0,__constructs__:null,a:(e=function(t){return{_hx_index:0,v:t,__enum__:"hx.concurrent.internal._Either3._Either3",toString:r}},e._hx_name="a",e.__params__=["v"],e),b:(e=function(t){return{_hx_index:1,v:t,__enum__:"hx.concurrent.internal._Either3._Either3",toString:r}},e._hx_name="b",e.__params__=["v"],e),c:(e=function(t){return{_hx_index:2,v:t,__enum__:"hx.concurrent.internal._Either3._Either3",toString:r}},e._hx_name="c",e.__params__=["v"],e)};is.__constructs__=[is.a,is.b,is.c];var ss=function(){};ss.__name__="hx.concurrent.thread.Threads",ss.get_current=function(){return"MainThread"},ss.get_isSupported=function(){return!1};var ns=function(){};function rs(t){return t instanceof Array?function(){return d.keyValueIter(t)}:"function"==typeof t.keyValueIterator?os(t,t.keyValueIterator):t.keyValueIterator}function as(t){return t instanceof Array?new Bi(t):t.iterator()}function os(e,i){return null==i?null:(null==i.__id__&&(i.__id__=t.$haxeUID++),null==e.hx__closures__?e.hx__closures__={}:s=e.hx__closures__[i.__id__],null==s&&(s=i.bind(e),e.hx__closures__[i.__id__]=s),s);var s}ns.__name__="js.Boot",ns.getClass=function(t){if(null==t)return null;if(t instanceof Array)return Array;var e=t.__class__;if(null!=e)return e;var i=ns.__nativeClassName(t);return null!=i?ns.__resolveNativeClass(i):null},ns.__string_rec=function(t,e){if(null==t)return"null";if(e.length>=5)return"<...>";var i=typeof t;switch("function"==i&&(t.__name__||t.__ename__)&&(i="object"),i){case"function":return"<function>";case"object":if(t.__enum__){var s=a[t.__enum__].__constructs__[t._hx_index],n=s._hx_name;return s.__params__?(e+="\t",n+"("+function(i){for(var n=[],r=0,a=s.__params__;r<a.length;){var o=a[r];r+=1,n.push(ns.__string_rec(t[o],e))}return n}().join(",")+")"):n}if(t instanceof Array){var r="[";e+="\t";for(var o=0,h=t.length;o<h;){var l=o++;r+=(l>0?",":"")+ns.__string_rec(t[l],e)}return r+="]"}var u;try{u=t.toString}catch(o){return Ci.lastError=o,"???"}if(null!=u&&u!=Object.toString&&"function"==typeof u){var c=t.toString();if("[object Object]"!=c)return c}r="{\n",e+="\t";var d=null!=t.hasOwnProperty,_=null;for(_ in t)d&&!t.hasOwnProperty(_)||"prototype"!=_&&"__class__"!=_&&"__super__"!=_&&"__interfaces__"!=_&&"__properties__"!=_&&(2!=r.length&&(r+=", \n"),r+=e+_+" : "+ns.__string_rec(t[_],e));return r+="\n"+(e=e.substring(1))+"}";case"string":return t;default:return String(t)}},ns.__interfLoop=function(t,e){for(;;){if(null==t)return!1;if(t==e)return!0;var i=t.__interfaces__;if(null!=i)for(var s=0,n=i.length;s<n;){var r=i[s++];if(r==e||ns.__interfLoop(r,e))return!0}t=t.__super__}},ns.__instanceof=function(t,e){if(null==e)return!1;switch(e){case Array:return t instanceof Array;case cs:return"boolean"==typeof t;case ls:return null!=t;case us:return"number"==typeof t;case hs:return"number"==typeof t&&(0|t)===t;case String:return"string"==typeof t;default:if(null==t)return!1;if("function"==typeof e){if(ns.__downcastCheck(t,e))return!0}else if("object"==typeof e&&ns.__isNativeObj(e)&&t instanceof e)return!0;return e==ds&&null!=t.__name__||e==_s&&null!=t.__ename__||null!=t.__enum__&&a[t.__enum__]==e}},ns.__downcastCheck=function(t,e){return t instanceof e||!!e.__isInterface__&&ns.__interfLoop(ns.getClass(t),e)},ns.__cast=function(t,e){if(null==t||ns.__instanceof(t,e))return t;throw w.thrown("Cannot cast "+m.string(t)+" to "+m.string(e))},ns.__nativeClassName=function(t){var e=ns.__toStr.call(t).slice(8,-1);return"Object"==e||"Function"==e||"Math"==e||"JSON"==e?null:e},ns.__isNativeObj=function(t){return null!=ns.__nativeClassName(t)},ns.__resolveNativeClass=function(e){return t[e]},t.$haxeUID|=0,"undefined"!=typeof performance&&"function"==typeof performance.now&&(d.now=performance.now.bind(performance)),null==String.fromCodePoint&&(String.fromCodePoint=function(t){return t<65536?String.fromCharCode(t):String.fromCharCode(55232+(t>>10))+String.fromCharCode(56320+(1023&t))}),Object.defineProperty(String.prototype,"__class__",{value:String,enumerable:!1}),String.__name__="String",Array.__name__="Array",Date.prototype.__class__=Date,Date.__name__="Date";var hs={},ls={},us=Number,cs=Boolean,ds={},_s={};ns.__toStr={}.toString;var ps,fs=!y.get_supported()||"http:"!=(null!=(ps=t.location)?ps.protocol:null)&&"https:"!=(null!=(ps=t.location)?ps.protocol:null)?null:E.fromString(t.location.protocol+"//"+t.location.hostname+(""!=t.location.port?":"+t.location.port:"")+"/"),ms="TLCP-2.5.0",gs=ms+".lightstreamer.com",vs="9.0.0 build 20230711",Ss="pcYgxn8m8 feOojyA1V661f3g2.pz482h95IL5h",bs="javascript_client",ys="";C.LIB_NAME=bs,C.LIB_VERSION=vs;var Es="Cannot subscribe to an active MPNSubscription",ws="No MPNDevice Registered",Ts="Specify property 'notificationFormat'";It.EOL_LEN=It.lengthOfBytes("\r\n");var Rs="The Subscription was initiated using a Field Schema: the field names are not available",xs="The field position is out of bounds",Is="The field name is unknown";le.Merge="MERGE",le.Distinct="DISTINCT",ke._ids=new Pe(0),Ae.NOW_ONCE=Fe.ONCE(0);var Cs=Be(),Ls=Be();Ye.ZERO=0,Ke.WS="WS",Ke.WS_STREAMING="WS-STREAMING",Ke.WS_POLLING="WS-POLLING",Ke.HTTP="HTTP",Ke.HTTP_STREAMING="HTTP-STREAMING",Ke.HTTP_POLLING="HTTP-POLLING",ni.Merge="MERGE",ni.Distinct="DISTINCT",ni.Command="COMMAND",ni.Raw="RAW",di.VARINT_RADIX=26,mi.TRACE=0,mi.DEBUG=10,mi.INFO=20,mi.WARN=30,mi.ERROR=40,mi.FATAL=50,Ei.isSupported=!1,wi.lock=new Ei,wi.logInstances=new ki,wi.emptyLogger=new Si;var Ms=wi.getLogger("lightstreamer.stream"),Ns=wi.getLogger("lightstreamer.protocol"),Ds=wi.getLogger("lightstreamer.internal"),Os=wi.getLogger("lightstreamer.session"),Ps=wi.getLogger("lightstreamer.actions"),ks=wi.getLogger("lightstreamer.reachability"),Fs=wi.getLogger("lightstreamer.subscriptions"),As=wi.getLogger("lightstreamer.messages");wi.getLogger("lightstreamer.cookies");var qs=wi.getLogger("lightstreamer.mpn.device"),Bs=wi.getLogger("lightstreamer.mpn.subscriptions");Wi.INDENT="  ",$i.HOUR_IN_MS=36e5,$i.DAY_IN_MS=864e5,$i.WEEK_IN_MS=6048e5}("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:void 0);var d=c.LSLightstreamerClient,_=c.LSSubscription,p=c.LSFirebaseMpnBuilder,f=c.LSMpnDevice,m=c.LSMpnSubscription,g=c.LSSafariMpnBuilder,v=c.LSConsoleLogLevel,S=c.LSConsoleLoggerProvider,b=function(){var t=function(t){this.name="IllegalStateException",this.message=t};return t.prototype={toString:function(){return["[",this.name,this.message,"]"].join("|")}},t}(),y=function(){function t(t,e,i){if(e)return i?e.apply(t,i):e.apply(t)}function e(t,e){for(var i in t)if(t[e]==t[i]&&e!=i)return i;return null}var i={Inheritance:function(t,s,n,r){for(var a in s.prototype)if(t.prototype[a]){if(r){var o=e(s.prototype,a);if(o){if(t.prototype[o]&&t.prototype[o]!==t.prototype[a]&&s.prototype[o]!=s.prototype[o])throw new b("Can't solve alias collision, try to minify the classes again ("+o+", "+a+")");t.prototype[o]=t.prototype[a]}}}else t.prototype[a]=s.prototype[a];return n||(t.prototype._super_=s,t.prototype._callSuperConstructor=i._callSuperConstructor,t.prototype._callSuperMethod=i._callSuperMethod),t},_callSuperMethod:function(e,i,s){return t(this,e.prototype._super_.prototype[i],s)},_callSuperConstructor:function(e,i){t(this,e.prototype._super_,i)}};return i.Inheritance}(),E=function(){var t=function(t){this.matrix=t||{}};return t.prototype={insert:function(t,e,i){e in this.matrix||(this.matrix[e]={}),this.matrix[e][i]=t},get:function(t,e){return t in this.matrix&&e in this.matrix[t]?this.matrix[t][e]:null},del:function(t,e){if(!(!t in this.matrix)){for(var i in e in this.matrix[t]&&delete this.matrix[t][e],this.matrix[t])return;delete this.matrix[t]}},insertRow:function(t,e){this.matrix[e]=t},getRow:function(t){return t in this.matrix?this.matrix[t]:null},delRow:function(t){t in this.matrix&&delete this.matrix[t]},getEntireMatrix:function(){return this.matrix},isEmpty:function(){for(var t in this.matrix)return!1;return!0},forEachElement:function(t){for(var e in this.matrix)this.forEachElementInRow(e,t)},forEachRow:function(t){for(var e in this.matrix)t(e)},forEachElementInRow:function(t,e){var i=this.matrix[t];for(var s in i)e(i[s],t,s)}},t.prototype.insert=t.prototype.insert,t.prototype.get=t.prototype.get,t.prototype.del=t.prototype.del,t.prototype.insertRow=t.prototype.insertRow,t.prototype.getRow=t.prototype.getRow,t.prototype.delRow=t.prototype.delRow,t.prototype.getEntireMatrix=t.prototype.getEntireMatrix,t.prototype.forEachElement=t.prototype.forEachElement,t.prototype.forEachElementInRow=t.prototype.forEachElementInRow,t.prototype.forEachRow=t.prototype.forEachRow,t.prototype.isEmpty=t.prototype.isEmpty,t}(),w=function(){var t="undefined"!=typeof window&&"undefined"!=typeof navigator&&"undefined"!=typeof document,e="undefined"!=typeof importScripts,i="object"==typeof process&&(/node(\.exe)?$/.test(process.execPath)||process.node&&process.v8||process.versions&&process.versions.node&&process.versions.v8);if(t&&!document.getElementById)throw new b("Not supported browser");var s={isBrowserDocument:function(){return t},isBrowser:function(){return!i&&(t||e)},isNodeJS:function(){return!t&&i},isWebWorker:function(){return!t&&!i&&e},isOther:function(){return!t&&!i&&!e},browserDocumentOrDie:function(){if(!this.isBrowserDocument())throw new b("Trying to load a browser-only module on non-browser environment")}};return s.isBrowserDocument=s.isBrowserDocument,s.isBrowser=s.isBrowser,s.isNodeJS=s.isNodeJS,s.isWebWorker=s.isWebWorker,s.browserDocumentOrDie=s.browserDocumentOrDie,s}(),T=function(){var t=new RegExp("^\\s*([\\s\\S]*?)\\s*$"),e=new RegExp(",","g"),i=new RegExp("\\.","g"),s={getTimeStamp:function(){return(new Date).getTime()},randomG:function(t){return t=t||1e3,Math.round(Math.random()*t)},trim:function(e){return e.replace(t,"$1")},getNumber:function(t,s){return t?t.replace?(t=s?(t=t.replace(i,"")).replace(e,"."):t.replace(e,""),new Number(t)):t:0},isArray:function(t){return t&&t.join&&"function"==typeof t.join},addEvent:function(t,e,i){return!!w.isBrowserDocument()&&(void 0!==t.addEventListener?t.addEventListener(e,i,!1):void 0!==t.attachEvent&&t.attachEvent("on"+e,i),!0)},removeEvent:function(t,e,i){return!!w.isBrowserDocument()&&(void 0!==t.removeEventListener?t.removeEventListener(e,i,!1):void 0!==t.detachEvent&&t.detachEvent("on"+e,i),!0)}};return s.getTimeStamp=s.getTimeStamp,s.randomG=s.randomG,s.trim=s.trim,s.getNumber=s.getNumber,s.isArray=s.isArray,s.addEvent=s.addEvent,s.removeEvent=s.removeEvent,s}(),R=function(){var t=function(){return!1},e={error:t,warn:t,info:t,debug:t,fatal:t,isDebugEnabled:t,isInfoEnabled:t,isWarnEnabled:t,isErrorEnabled:t,isFatalEnabled:t},i=function(t){this.setWrappedInstance(t)};return i.prototype={setWrappedInstance:function(t){this.wrappedLogger=t||e},logFatal:function(t){this.isFatalLogEnabled()&&(t+=this.logArguments(arguments,1),this.fatal(t))},fatal:function(t,e){this.wrappedLogger.fatal(t,e)},isFatalLogEnabled:function(){return!this.wrappedLogger.isFatalEnabled||this.wrappedLogger.isFatalEnabled()},logError:function(t){this.isErrorLogEnabled()&&(t+=this.logArguments(arguments,1),this.error(t))},logErrorExc:function(t,e){this.isErrorLogEnabled()&&(e+=this.logArguments(arguments,2),this.error(e,t))},error:function(t,e){this.wrappedLogger.error(t,e)},isErrorLogEnabled:function(){return!this.wrappedLogger.isErrorEnabled||this.wrappedLogger.isErrorEnabled()},logWarn:function(t){this.isWarnLogEnabled()&&(t+=this.logArguments(arguments,1),this.warn(t))},warn:function(t,e){this.wrappedLogger.warn(t,e)},isWarnLogEnabled:function(){return!this.wrappedLogger.isWarnEnabled||this.wrappedLogger.isWarnEnabled()},logInfo:function(t){this.isInfoLogEnabled()&&(t+=this.logArguments(arguments,1),this.info(t))},info:function(t,e){this.wrappedLogger.info(t,e)},isInfoLogEnabled:function(){return!this.wrappedLogger.isInfoEnabled||this.wrappedLogger.isInfoEnabled()},logDebug:function(t){this.isDebugLogEnabled()&&(t+=this.logArguments(arguments,1),this.debug(t))},debug:function(t,e){this.wrappedLogger.debug(t,e)},isDebugLogEnabled:function(){return!this.wrappedLogger.isDebugEnabled||this.wrappedLogger.isDebugEnabled()},logArguments:function(t,e){for(var i=" {",s=e=e||0;s<t.length;s++)try{var n=t[s];null===n?i+="NULL":n.length<0?i+="*":null!=n.charAt?i+=n:n.message?(i+=n.message,n.stack&&(i+="\n"+n.stack+"\n")):n[0]==n?i+=n:T.isArray(n)?(i+="(",i+=this.logArguments(n),i+=")"):i+=n,i+=" "}catch(t){i+="??? "}return i+"}"}},i.prototype.debug=i.prototype.debug,i.prototype.isDebugLogEnabled=i.prototype.isDebugLogEnabled,i.prototype.logDebug=i.prototype.logDebug,i.prototype.info=i.prototype.info,i.prototype.isInfoLogEnabled=i.prototype.isInfoLogEnabled,i.prototype.logInfo=i.prototype.logInfo,i.prototype.warn=i.prototype.warn,i.prototype.isWarnEnabled=i.prototype.isWarnEnabled,i.prototype.logWarn=i.prototype.logWarn,i.prototype.error=i.prototype.error,i.prototype.isErrorEnabled=i.prototype.isErrorEnabled,i.prototype.logError=i.prototype.logError,i.prototype.logErrorExc=i.prototype.logErrorExc,i.prototype.fatal=i.prototype.fatal,i.prototype.isFatalEnabled=i.prototype.isFatalEnabled,i.prototype.logFatal=i.prototype.logFatal,i}(),x=function(){var t=function(t){this.name="IllegalArgumentException",this.message=t};return t.prototype={toString:function(){return["[",this.name,this.message,"]"].join("|")}},t}(),I=function(){var t={},e=null,i="The given object is not a LoggerProvider",s={setLoggerProvider:function(s){if(s&&!s.getLogger)throw new x(i);for(var n in e=s,t)e?t[n].setWrappedInstance(e.getLogger(n)):t[n].setWrappedInstance(null)},getLoggerProxy:function(i){return t[i]||(t[i]=e?new R(e.getLogger(i)):new R),t[i]},resolve:function(t){return t}};return s.setLoggerProvider=s.setLoggerProvider,s.getLoggerProxy=s.getLoggerProxy,s.resolve=s.resolve,s}(),C=function(){var t="The given value is not valid. ",e="Use a number",i="Use an integer",s="Use a positive number",n=" or 0",r="Use true or false",a=function(){};function o(r,a,o){var h=new Number(r);if(isNaN(h))throw new x(t+e);if(!o&&h!=Math.round(h))throw new x(t+i);if(a){if(r<0)throw new x(t+s+n)}else if(r<=0)throw new x(t+s);return h}function h(e,i){if(!0===e||!1===e||i&&!e)return!0===e;throw new x(t+r)}return a.prototype.checkPositiveNumber=o,a.prototype.checkBool=h,a.prototype.checkPositiveNumber=o,a.prototype.checkBool=h,a}(),L=function(){var t=!!w.isBrowser()&&null,e=w.isBrowser()?navigator.userAgent.toLowerCase():null;function i(t,e,i){return!e||!t||(!0===i?t<=e:!1===i?t>=e:t==e)}function s(t){return e.indexOf(t)>-1}function n(e){var i=t;return function(){return null===i&&(i=s(e)),i}}function r(e){var i=t;return function(){if(null===i){i=!0;for(var t=0;t<e.length;t++)i=i&&e[t]()}return i}}function a(e){var i=t;return function(){if(null===i){i=!1;for(var t=0;t<e.length;t++)i=i||e[t]()}return i}}function o(e,s){var n=t,r=t;return function(t,a){return null===n&&(n=e(),r=n?s():null),!!n&&i(r,t,a)}}function h(i){var s=t;return function(){if(null===s){var t=i.exec(e);if(t&&t.length>=2)return t[1]}return null}}function l(){if(opera.version){var t=opera.version();return t=t.replace(new RegExp("[^0-9.]+","g"),""),parseInt(t)}return 7}function u(){return"undefined"!=typeof opera}function c(t){return function(){return!t()}}var d=t,_={isProbablyRekonq:n("rekonq"),isProbablyAWebkit:n("webkit"),isProbablyPlaystation:n("playstation 3"),isProbablyChrome:o(n("chrome/"),h(new RegExp("chrome/([0-9]+)","g"))),isProbablyAKhtml:function(){return null===d&&(d=document.childNodes&&!document.all&&!navigator.taintEnabled&&!navigator.accentColorName),d},isProbablyKonqueror:o(n("konqueror"),h(new RegExp("konqueror/([0-9.]+)","g"))),isProbablyIE:function(t,e){return!(!o(n("msie"),h(new RegExp("msie\\s([0-9]+)[.;]","g")))(t,e)&&!o(n("rv:11.0"),(function(){return"11"}))(t,e))},isProbablyEdge:n("edge"),isProbablyFX:o(n("firefox"),h(new RegExp("firefox\\/(\\d+\\.?\\d*)"))),isProbablyOldOpera:o(u,l)};return _.isProbablyAndroidBrowser=r([n("android"),_.isProbablyAWebkit,c(_.isProbablyChrome)]),_.isProbablyOperaMobile=r([_.isProbablyOldOpera,n("opera mobi")]),_.isProbablyApple=o(r([n("safari"),a([n("ipad"),n("iphone"),n("ipod"),r([c(_.isProbablyAndroidBrowser),c(_.isProbablyChrome),c(_.isProbablyRekonq)])])]),h(new RegExp("version\\/(\\d+\\.?\\d*)"))),_.isProbablyRekonq=_.isProbablyRekonq,_.isProbablyChrome=_.isProbablyChrome,_.isProbablyAWebkit=_.isProbablyAWebkit,_.isProbablyPlaystation=_.isProbablyPlaystation,_.isProbablyAndroidBrowser=_.isProbablyAndroidBrowser,_.isProbablyOperaMobile=_.isProbablyOperaMobile,_.isProbablyApple=_.isProbablyApple,_.isProbablyAKhtml=_.isProbablyAKhtml,_.isProbablyKonqueror=_.isProbablyKonqueror,_.isProbablyIE=_.isProbablyIE,_.isProbablyEdge=_.isProbablyEdge,_.isProbablyFX=_.isProbablyFX,_.isProbablyOldOpera=_.isProbablyOldOpera,_}(),M=function(){var t=function(){this.data=[]};return t.prototype={add:function(t){this.data.push(t)},remove:function(t){var e=this.find(t);return!(e<0||(this.data.splice(e,1),0))},contains:function(t){return this.find(t)>=0},find:function(t){for(var e=0;e<this.data.length;e++)if(this.data[e]===t)return e;return-1},forEach:function(t){for(var e=0;e<this.data.length;e++)t(this.data[e])},asArray:function(){return[].concat(this.data)},clean:function(){this.data=[]}},t.prototype.add=t.prototype.add,t.prototype.remove=t.prototype.remove,t.prototype.forEach=t.prototype.forEach,t.prototype.asArray=t.prototype.asArray,t.prototype.clean=t.prototype.clean,t}(),N=function(){var t=new M,e=new M,i=new M,s=1e3,n=!1,r={onloadDone:"onloadDone",onloadInprogress:"onloadInprogress",unloaded:"unloaded",unloading:"unloading",preunloading:"preunloading"},a={};for(var o in r)a[r[o]]=o;function h(t){return c(t,a.onloadDone,a.onloadInprogress,e,"onloadEvent")}function l(e){return c(e,a.unloaded,a.unloading,t,"unloadEvent")}function u(t){return c(t,a.preunloading,a.preunloading,i,"preUnloadEvent")}function c(t,e,i,s,n){return function(){t[e]||(t[i]=!0,s.forEach((function(t){try{d(t,n)}catch(t){}})),"preunloading"!=e&&s.clean(),t[e]=!0,t[i]=!1)}}function d(t,e){t[e]?t[e]():t()}function _(t,e){setTimeout((function(){d(t,e)}),0)}function p(t,e,i,s){setTimeout((function(){i?s?t.apply(i,s):t.apply(i):s?t.apply(null,s):t()}),e)}function f(){n=!0}var m={onloadDone:!1,onloadInprogress:!1,unloaded:!1,unloading:!1,preunloading:!1,isLoaded:function(){return this.onloadDone},isUnloaded:function(){return this.unloaded},isUnloading:function(){return this.unloading},addOnloadHandler:function(t){this.isPreOnload()?e.add(t):_(t,"onloadEvent")},addUnloadHandler:function(e){this.isPreUnload()?t.add(e):_(e,"unloadEvent")},addBeforeUnloadHandler:function(t){i.add(t),this.preunloading&&_(t,"preUnloadEvent")},removeOnloadHandler:function(t){e.remove(t)},removeUnloadHandler:function(e){t.remove(e)},removeBeforeUnloadHandler:function(t){i.remove(t)},isPreOnload:function(){return!(this.onloadDone||this.onloadInprogress)},isPreUnload:function(){return!(this.unloaded||this.unloading)},attachToWindow:function(){if(T.addEvent(window,"unload",this.closeFun),T.addEvent(window,"beforeunload",this.beforeCloseFun),document&&void 0!==document.readyState){if("COMPLETE"==document.readyState.toUpperCase())return void this.asynchExecution();p(this.controlReadyStateLoad,s,this)}else if(this.isInBody())return void this.asynchExecution();if(T.addEvent(window,"load",this.readyFun)){if(L.isProbablyOldOpera()){var t=!1;L.isProbablyOldOpera(9,!1)&&(t=!0,T.addEvent(document,"DOMContentLoaded",f)),p(this.controlOperaLoad,s,this,[t])}}else this.asynchExecution()},asynchExecution:function(){p(this.readyFun,0)},controlReadyStateLoad:function(){this.onloadDone||("COMPLETE"==document.readyState.toUpperCase()?this.readyFun():p(this.controlReadyStateLoad,s,this))},controlOperaLoad:function(t){this.onloadDone||(n||!t&&this.isInBody()?this.readyFun():p(this.controlOperaLoad,s,this,[t]))},isInBody:function(){return void 0!==document.getElementsByTagName&&void 0!==document.getElementById&&(null!=document.getElementsByTagName("body")[0]||null!=document.body)}};return m.readyFun=h(m),m.closeFun=l(m),m.beforeCloseFun=u(m),w.isBrowserDocument()?m.attachToWindow():m.asynchExecution(),m.addOnloadHandler=m.addOnloadHandler,m.addUnloadHandler=m.addUnloadHandler,m.addBeforeUnloadHandler=m.addBeforeUnloadHandler,m.removeOnloadHandler=m.removeOnloadHandler,m.removeUnloadHandler=m.removeUnloadHandler,m.removeBeforeUnloadHandler=m.removeBeforeUnloadHandler,m.isLoaded=m.isLoaded,m.isUnloaded=m.isUnloaded,m.isUnloading=m.isUnloading,m}(),D=function(){var t=50,e=!1,i=[],s=T.getTimeStamp(),n=108e5,r=s+n,a=[],o=null,h=0;function l(t,e){return t.time===e.time?t.orderId-e.orderId:t.time-e.time}var u=!w.isBrowserDocument()||"http:"!=document.location.protocol&&"https:"!=document.location.protocol?"*":document.location.protocol+"//"+document.location.hostname+(document.location.port?":"+document.location.port:""),c=function(){},d=c,_=!1;function p(){_=!1,g()}function f(){_||(_=!0,d())}function m(){if(o)clearInterval(o);else if(w.isBrowserDocument()&&"undefined"!=typeof postMessage){d=function(){try{window.postMessage("Lightstreamer.run",u)}catch(t){try{window.postMessage("Lightstreamer.run",u)}catch(t){}}};var e=function(t){("Lightstreamer.run"==t.data&&"*"==u||t.origin==u)&&p()};T.addEvent(window,"message",e),f(),0==_&&(T.removeEvent(window,"message",e),d=c)}else w.isNodeJS()&&"undefined"!=typeof process&&process.nextTick&&(d=function(){process.nextTick(p)});o=setInterval(g,t)}function g(){if(N.unloaded)clearInterval(o);else{var t,u,c=s;if((s=T.getTimeStamp())<c&&(s=c),i.length>0)for(e&&(i.sort(l),e=!1);i.length>0&&i[0].time<=s&&!N.unloaded;)(t=i.shift()).fun&&(v.executeTask(t),t.step&&a.push(t));for(i.length<=0&&(h=0);a.length>0;)(u=a.shift()).step&&(u.orderId=h++,v.addPackedTimedTask(u,u.step,!0));s>=r&&(r=s+n,i=[].concat(i))}}var v={toString:function(){return["[","Executor",t,i.length,"]"].join("|")},getQueueLength:function(){return i.length},packTask:function(t,e,i){return{fun:t,context:e||null,params:i||null,orderId:h++}},addPackedTimedTask:function(t,n,r){if(t.step=r?n:null,t.time=s+parseInt(n),isNaN(t.time))try{throw new Error}catch(t){var a="Executor error for time: "+n;throw t.stack&&(a+=" "+t.stack),a}i.push(t),e=!0},addRepetitiveTask:function(t,e,i,s){return this.addTimedTask(t,e,i,s,!0)},stopRepetitiveTask:function(t){t&&(t.fun=null,t.step=null)},addTimedTask:function(t,e,i,s,n){var r=this.packTask(t,i,s);return this.addPackedTimedTask(r,e,n),0==e&&f(),r},modifyTaskParam:function(t,e,i){t.params[e]=i},modifyAllTaskParams:function(t,e){t.params=e},delayTask:function(t,i){t.time+=i,e=!0},executeTask:function(t,e){try{var i=e||t.params;t.context?i?t.fun.apply(t.context,i):t.fun.apply(t.context):i?t.fun.apply(null,i):t.fun()}catch(e){try{t.fun.name||t.fun.toString()}catch(t){}}}};return w.isWebWorker()?setTimeout(m,1):m(),v.getQueueLength=v.getQueueLength,v.packTask=v.packTask,v.addPackedTimedTask=v.addPackedTimedTask,v.addRepetitiveTask=v.addRepetitiveTask,v.stopRepetitiveTask=v.stopRepetitiveTask,v.addTimedTask=v.addTimedTask,v.modifyTaskParam=v.modifyTaskParam,v.modifyAllTaskParams=v.modifyAllTaskParams,v.delayTask=v.delayTask,v.executeTask=v.executeTask,v}(),O=function(){var t=function(){this.initDispatcher()};t.prototype={initDispatcher:function(){this.theListeners=new e,this.synchEvents=!1},addListener:function(t){if(t&&!this.theListeners.contains(t)){var e={handler:t,listening:!0};this.theListeners.add(e),this.dispatchToOneListener("onListenStart",[this],e,!0)}},removeListener:function(t){if(t){var e=this.theListeners.remove(t);e&&this.dispatchToOneListener("onListenEnd",[this],e,!0)}},getListeners:function(){return this.theListeners.asArray()},useSynchEvents:function(t){this.synchEvents=!0===t},dispatchToOneListener:function(t,e,i,s){this.synchEvents?this.dispatchToOneListenerExecution(t,e,i,!0):D.addTimedTask(this.dispatchToOneListenerExecution,0,this,[t,e,i,s])},dispatchToOneListenerExecution:function(t,e,i,s){if(i&&i.handler[t]&&(s||i.listening))try{e?i.handler[t].apply(i.handler,e):i.handler[t].apply(i.handler)}catch(t){}},dispatchEvent:function(t,e){var i=this;this.theListeners.forEach((function(s){i.dispatchToOneListener(t,e,s,!1)}))}},t.prototype.initDispatcher=t.prototype.initDispatcher,t.prototype.addListener=t.prototype.addListener,t.prototype.removeListener=t.prototype.removeListener,t.prototype.getListeners=t.prototype.getListeners,t.prototype.useSynchEvents=t.prototype.useSynchEvents,t.prototype.dispatchEvent=t.prototype.dispatchEvent;var e=function(){this._callSuperConstructor(e)};return e.prototype={remove:function(t){var e=this.find(t);if(e<0)return!1;var i=this.data[e];return i.listening=!1,this.data.splice(e,1),i},find:function(t){for(var e=0;e<this.data.length;e++)if(this.data[e].handler==t)return e;return-1},asArray:function(){var t=[];return this.forEach((function(e){t.push(e.handler)})),t}},y(e,M),t}(),P=function(){return{CONNECTING:"CONNECTING",CONNECTED:"CONNECTED:",SENSE:"STREAM-SENSING",WS_STREAMING:"WS-STREAMING",HTTP_STREAMING:"HTTP-STREAMING",STALLED:"STALLED",WS_POLLING:"WS-POLLING",HTTP_POLLING:"HTTP-POLLING",DISCONNECTED:"DISCONNECTED",WILL_RETRY:"DISCONNECTED:WILL-RETRY",TRYING_RECOVERY:"DISCONNECTED:TRYING-RECOVERY",WS_ALL:"WS",HTTP_ALL:"HTTP",RAW:"RAW",DISTINCT:"DISTINCT",COMMAND:"COMMAND",MERGE:"MERGE"}}(),k=function(){var t=function(){this._callSuperConstructor(t),this.reverseIndex={}};return t.prototype={insert:function(e,i,s){void 0===this.reverseIndex[s]&&(this.reverseIndex[s]=i,this._callSuperMethod(t,"insert",[e,i,s]))},del:function(e,i){this._callSuperMethod(t,"del",[e,i]),delete this.reverseIndex[i]},delReverse:function(t){var e=this.reverseIndex[t];void 0!==e&&this.del(e,t)},delRow:function(e){var i=this.getRow(e);for(var s in i)delete this.reverseIndex[s];this._callSuperMethod(t,"delRow",[e])}},t.prototype.insert=t.prototype.insert,t.prototype.del=t.prototype.del,t.prototype.delReverse=t.prototype.delReverse,t.prototype.delRow=t.prototype.delRow,y(t,E),t}(),F=function(){var t=I.getLoggerProxy("lightstreamer.grids"),e="ITEM_IS_KEY",i="UPDATE_IS_KEY",s="KEY_IS_KEY",n="Please parse html before calling this method",r=1,a=2,o=100,h=function(){this._callSuperConstructor(h),this.kind=e,this.keyField=null,this.commandField=null,this.updateCount=0,this.fieldPosBased=null,this.values=new E,this.parsed=!1,this.id=arguments[0],this.useSynchEvents(!0),this.cleanOnFirstSubscribe=!1,this.cleanOnLastUnsubscribe=!1,this.activeSubscriptions=0,this.masterSubscription=null,this.forcedInterpretation=!1,this.updateInProgress=null,this.suspendedUpdates=[],this.fifoKeys=[],this.fifoMap={},this.fifoHoles=0,this.fifoHead=0,this.itemKeyMap=new k};return h.ITEM_IS_KEY=e,h.UPDATE_IS_KEY=i,h.prototype={getId:function(){return this.id},checkParsed:function(){if(!this.parsed)throw new b(n)},onItemUpdate:function(t){var e,i=t.getItemName(),s=t.getItemPos();this.updateCount++;var n=null==i?s:i;e=this.itemIsKey()?n:this.updateIsKey()?this.updateCount:n+" "+t.getValue(this.keyField);var r={};this.updateIsKey()?t.forEachField(this.getForeachHandler(r)):t.forEachChangedField(this.getForeachHandler(r)),this.keyIsKey()&&"DELETE"==r[this.commandField]?this.removeRow(e):(this.updateRow(e,r),this.itemKeyMap.insert(!0,n,e))},onClearSnapshot:function(t,e){var i=null==t?e:t,s=this.itemKeyMap.getRow(i);for(var n in this.itemKeyMap.delRow(i),s)this.removeRow(n)},onSubscription:function(){0==this.activeSubscriptions&&this.cleanOnFirstSubscribe&&this.clean(),this.keyIsKey()&&!this.keyField&&(this.keyField=this.masterSubscription.getKeyPosition(),this.commandField=this.masterSubscription.getCommandPosition()),this.activeSubscriptions++},onUnsubscription:function(){this.activeSubscriptions--,0==this.activeSubscriptions&&this.cleanOnLastUnsubscribe&&this.clean()},onListenStart:function(t){this.masterSubscription||(this.masterSubscription=t,this.forcedInterpretation||this.chooseInterpretation()),t.isSubscribed()&&this.onSubscription()},onListenEnd:function(t){t.isSubscribed()&&this.onUnsubscription()},chooseInterpretation:function(){if(this.masterSubscription){var t=this.masterSubscription;if(t.getMode()==P.MERGE||t.getMode()==P.RAW)this.kind=e;else if(t.getMode()==P.DISTINCT)this.kind=i;else{this.kind=s;try{t.getFields(),this.keyField="key",this.commandField="command"}catch(t){}}}else this.kind=e},getForeachHandler:function(t){var e=this;return function(i,s,n){null===e.fieldPosBased&&(e.fieldPosBased=null==i);var r=e.fieldPosBased?s:i;t[r]=n}},itemIsKey:function(){return this.kind==e},updateIsKey:function(){return this.kind==i},keyIsKey:function(){return this.kind==s},getOldestKey:function(){return this.fifoHead>=this.fifoKeys.length?null:this.fifoKeys[this.fifoHead]},removeFromFifo:function(t){var e=this.fifoMap[t];if(delete this.fifoMap[t],this.fifoKeys[e]=null,this.fifoHoles++,e==this.fifoHead){for(;null===this.fifoKeys[this.fifoHead]&&this.fifoHead<this.fifoKeys.length;)this.fifoHead++;if(this.fifoHead>=this.fifoKeys.length)return this.fifoKeys=[],this.fifoMap={},this.fifoHoles=0,void(this.fifoHead=0)}if(this.fifoHoles>=o){this.fifoMap={};var i=this.fifoKeys;this.fifoKeys=[],this.fifoHead=0,this.fifoHoles=0;for(var s=0;s<i.length;s++)null!==i[s]&&this.newKey(i[s])}},newKey:function(t){this.fifoMap[t]=this.fifoKeys.length,this.fifoKeys.push(t)},removeRow:function(e){if(this.checkParsed(),this.updateInProgress)this.deleteLater(e);else if(this.values.getRow(e)){t.isDebugLogEnabled()&&t.logDebug("Removing row",e,this),this.updateInProgress={};var i=null;try{this.removeRowExecution(e),this.values.delRow(e),this.itemKeyMap.delReverse(e),this.updateIsKey()&&this.removeFromFifo(e)}catch(t){i=t}if(this.updateInProgress=null,this.dequeuePostponedUpdates(),null!==i)throw i}else t.logWarn("Can't remove row that does not exist",e,this)},updateLater:function(e,i){t.isDebugLogEnabled()&&t.logDebug("Postpone new update until the current update/remove is completed",this),this.suspendedUpdates.push({type:a,key:e,obj:i})},deleteLater:function(e){t.isDebugLogEnabled()&&t.logDebug("Postpone new remove until the current update/remove is completed",this),this.suspendedUpdates.push({type:r,key:e})},dequeuePostponedUpdates:function(){for(;this.suspendedUpdates.length>0;){var t=this.suspendedUpdates.shift();t.type==r?this.removeRow(t.key):this.updateRow(t.key,t.obj)}},updateRow:function(e,i){if(this.checkParsed(),this.updateInProgress)e==this.updateInProgress?this.mergeUpdate(e,i):this.updateLater(e,i);else{this.updateInProgress=e;var s=null;try{if(this.updateRowExecution(e,i),this.values.getRow(e))for(var n in t.isDebugLogEnabled()&&t.logDebug("Updating row",e,this),i)this.values.insert(i[n],e,n);else t.isDebugLogEnabled()&&t.logDebug("Inserting new row",e,this),this.updateIsKey()&&this.newKey(e),this.values.insertRow(i,e)}catch(t){s=t}if(this.updateInProgress=null,this.dequeuePostponedUpdates(),null!==s)throw s}},clean:function(){t.logInfo("Cleaning the model",this);var e=[];this.values.forEachRow((function(t){e.push(t)}));for(var i=0;i<e.length;i++)this.removeRow(e[i])},getValue:function(t,e){return this.values.get(t,e)},setAutoCleanBehavior:function(t,e){this.cleanOnFirstSubscribe=this.checkBool(t),this.cleanOnLastUnsubscribe=this.checkBool(e)},parseHtml:function(){},updateRowExecution:function(t,e){},removeRowExecution:function(t){},mergeUpdate:function(t,e){}},h.prototype.onItemUpdate=h.prototype.onItemUpdate,h.prototype.onClearSnapshot=h.prototype.onClearSnapshot,h.prototype.onSubscription=h.prototype.onSubscription,h.prototype.onUnsubscription=h.prototype.onUnsubscription,h.prototype.onListenStart=h.prototype.onListenStart,h.prototype.onListenEnd=h.prototype.onListenEnd,h.prototype.removeRow=h.prototype.removeRow,h.prototype.updateRow=h.prototype.updateRow,h.prototype.clean=h.prototype.clean,h.prototype.getValue=h.prototype.getValue,h.prototype.setAutoCleanBehavior=h.prototype.setAutoCleanBehavior,h.prototype.parseHtml=h.prototype.parseHtml,h.prototype.updateRowExecution=h.prototype.updateRowExecution,h.prototype.removeRowExecution=h.prototype.removeRowExecution,h.prototype.mergeUpdate=h.prototype.mergeUpdate,y(h,O,!1,!0),y(h,C,!0,!0),h}(),A=function(){w.browserDocumentOrDie();var t="field",e="grid",i="row",s="item",n="update",r="value",a="replica",o="fieldtype",h={extra:!0,"first-level":!0,"second-level":!0},l="first-level",u="second-level",c=1,d=2,_="",p="source",f="lightstreamer",m={input:!0,textarea:!0};function g(t,e){if(!1===D.useOldNames)return v(t,e);if(!0===D.useOldNames)return S(t,e);var i=v(t,e);return i?(D.useOldNames=!1,i):((i=S(t,e))&&(D.useOldNames=!0),i)}function v(t,e){return t.dataset&&t.dataset[e]?t.dataset[e]:t.getAttribute("data-"+e)}function S(t,e){return t.getAttribute(e)}function b(t,e){if(!t)return e;for(var i in e)if(!t[i]){if(null===t[i]||""===t[i])continue;t[i]=e[i]}return t}function y(t){var e=g(t,p);return e&&e.toLowerCase()==f}function E(t){return function(e){this.el.style[t]=e===_?null:e}}function T(t){return function(){return this.el.style[t]||""}}function R(t){this.el.value=t&&t!==_?t:""}function x(){return this.el.value}function I(t,e){e?this.el.innerHTML=t:1!=this.el.childNodes.length||3!=this.el.firstChild.nodeType?(null!=this.el.firstChild&&(this.el.innerHTML=""),this.el.appendChild(document.createTextNode(t))):this.el.firstChild.nodeValue=t}function C(t){return t?this.el.innerHTML:this.el.firstChild?this.el.firstChild.nodeValue:""}function L(t){return t===r?R:function(e){e&&e!==_?this.el.setAttribute(t,e):this.el.removeAttribute(t)}}function M(t){return t===r?x:function(){return this.el.getAttribute(t)}}var N=0,D=function(t,e){if(this.el=t,this.isCell=!0,this.fadePhase=0,e||(e=this.getUpdateWhat()),e)if(0==e.toLowerCase().indexOf("style.")){var i=e.slice(6);this.updateValue=E(i),this.retrieveValue=T(i)}else this.updateValue=L(e),this.retrieveValue=M(e);else t.nodeName.toLowerCase()in m?(this.updateValue=R,this.retrieveValue=x):(this.updateValue=I,this.retrieveValue=C);this.cellId=N++,this.updateCount=0,this.nextFormattedValue=null,this.newHotArray=null,this.newColdArray=null,this.initialValue=this.retrieveValue(!0),this.initialClass=this.extractCSSClass(),this.initialStyles=this.extractStyles()};return D.HOT=c,D.COLD=d,D.FIRST_LEVEL=l,D.SECOND_LEVEL=u,D.useOldNames=null,D.getLSTags=function(t,e){var i=[];e||(e=["*"]);for(var s=0;s<e.length;s++)for(var n=t.getElementsByTagName(e[s]),r=0;r<n.length;r++)y(n[r])&&i.push(new D(n[r]));return i},D.verifyTag=y,D.isAttachedToDOM=function(t){for(var e=null,i=t;null!=i&&i!=document;)e=i,i=i.parentNode;return null!=i||null!=e&&"HTML"==e.nodeName},D.prototype={scrollHere:function(t,e){this.updateValue(t.retrieveValue(),e),this.nextFormattedValue=t.nextFormattedValue,this.newHotArray=t.newHotArray,this.newColdArray=t.newColdArray,this.updateCount=t.updateCount,this.setAttributes(t.extractStyles()),this.updateCSSClass(t.extractCSSClass()),this.fadePhase=t.fadePhase},getEl:function(){return this.el},extractStyles:function(){var t={};for(var e in this.el.style)t[e]=this.el.style[e];return t},extractCSSClass:function(){return this.el.className},updateCSSClass:function(t){null!==t&&this.el.className!=t&&(this.el.className=t)},setAttributes:function(t){if(t)for(var e in t){"CLASS"==e&&this.updateCSSClass(t[e]);try{null!==t[e]&&(this.el.style[e]=t[e])}catch(t){}}},asynchUpdateStyles:function(t,e){t==this.updateCount&&(e==c?(this.setAttributes(this.newHotArray),this.newHotArray=null):(this.setAttributes(this.newColdArray),this.newColdArray=null))},asynchUpdateValue:function(t,e){t==this.updateCount&&(this.updateValue(this.nextFormattedValue,e),this.nextFormattedValue=null,this.asynchUpdateStyles(t,c))},setUpdating:function(){return this.updateCount++,this.updateCount},getField:function(){var e=g(this.el,t);return e||null},getNum:function(){var t=g(this.el,a);return t||null},getFieldType:function(){var t=g(this.el,o);return t?(t=t.toLowerCase(),h[t]?t:l):l},getTable:function(){return g(this.el,e)},getRow:function(){var t=g(this.el,s);return t||(t=g(this.el,i)),t},getUpdateWhat:function(){return g(this.el,n)},incFadePhase:function(){return++this.fadePhase},getFadePhase:function(){return this.fadePhase},getCellId:function(){return this.cellId},isSameEl:function(t){return t.el===this.el},getTagName:function(){return this.el.tagName},isAttachedToDOM:function(){return D.isAttachedToDOM(this.el)},isAttachedToDOMById:function(){return this.el.id?document.getElementById(this.el.id)===this.el:this.isAttachedToDOM(this.el)},setNextFormattedValue:function(t){this.nextFormattedValue=""===t?_:t},getNextFormattedValue:function(){return this.nextFormattedValue},addStyle:function(t,e,i){this.newHotArray||(this.newHotArray={}),this.newColdArray||(this.newColdArray={}),this.newHotArray[i]=t||"",this.newColdArray[i]=e||""},getNextHotArray:function(t){return t&&(this.newHotArray=b(this.newHotArray,t)),this.newHotArray},getNextColdArray:function(t){return t&&(this.newColdArray=b(this.newColdArray,t)),this.newColdArray},clean:function(){this.updateValue(this.initialValue,!0),this.updateCSSClass(this.initialClass),this.setAttributes(this.initialStyles)}},D}(),q=function(){function t(t,e,i){var s=(new Number(t)-e)/i;return Math.round(s)}var e="black",i=I.getLoggerProxy("lightstreamer.charts"),s=0,n=function(){this.parent=arguments[1],this.yField=arguments[3],this.pointColor=e,this.lineColor=e,this.pointSize=1,this.lineSize=1,this.yMin=null,this.yMax=null,this.yUnit=null,this.numYLabels=0,this.labelsFormatter=null,this.xArray=[],this.yArray=[],this.labels=[],this.chartId=s++,i.logDebug("New ChartLine",this)};return n.prototype={toString:function(){return["[","ChartLine",this.parent,"]"].join("|")},getId:function(){return this.chartId},emptyHistory:function(){i.logDebug("Clearing ChartLine",this),this.yArray=[],this.xArray=[]},isEmpty:function(){return this.xArray.length<=0},reset:function(){this.emptyHistory(),this.parent.clearLine(this)},repaint:function(){i.logDebug("Repainting ChartLine",this);var t=this.xArray,e=this.yArray;for(this.reset();t.length>0;)(t.length>1&&t[1]>=this.parent.xMin||t[0]>=this.parent.xMin)&&this.addPoint(t[0],e[0]),t.shift(),e.shift();i.logDebug("ChartLine re-painted",this)},addPoint:function(t,e){this.xArray.push(t),this.yArray.push(e),this.parent.drawLine(t,e,this)},calcYUnit:function(){this.yUnit=(this.yMax-this.yMin)/this.parent.screenY,i.logDebug("Calculated Y unit",this,this.yUnit)},isYAxisPositioned:function(){return null!==this.yMax},isPointInRange:function(t){return t<this.yMax&&t>this.yMin},getMin:function(){return this.yMin},getMax:function(){return this.yMax},paintYLabels:function(){this.clearLabels();var t="",e=-1;if(!(this.numYLabels<=0)){if(this.numYLabels>0&&(t=this.labelsFormatter?this.labelsFormatter(this.yMin):this.yMin,e=this.getRelativeY(this.yMin),this.labels[this.labels.length]=this.parent.createLabel(this.classYLabels,t,e,"Y")),this.numYLabels>1&&(t=this.labelsFormatter?this.labelsFormatter(this.yMax):this.yMax,e=this.getRelativeY(this.yMax),this.labels[this.labels.length]=this.parent.createLabel(this.classYLabels,t,e,"Y")),this.numYLabels>2)for(var s=this.numYLabels-1,n=(this.yMax-this.yMin)/s,r=this.yMin,a=1;a<s;a++)r+=n,t=this.labelsFormatter?this.labelsFormatter(r):r,e=this.getRelativeY(r),this.labels[this.labels.length]=this.parent.createLabel(this.classYLabels,t,e,"Y");i.logDebug("Y labels generated",this)}},getRelativeY:function(e){return t(e,this.yMin,this.yUnit)},clearLabels:function(){for(var t=0;t<this.labels.length;t++)this.labels[t]&&A.isAttachedToDOM(this.labels[t])&&this.labels[t].parentNode.removeChild(this.labels[t]);this.labels=[],i.logDebug("Y labels cleared",this)},setYLabels:function(t,e,s){this.numYLabels=this.checkPositiveNumber(t,!0),this.classYLabels=e,this.labelsFormatter=s||null,i.logDebug("Y labels now configured",this),null!=this.yUnit&&this.parent&&this.parent.painter&&this.paintYLabels()},setStyle:function(t,e,s,n){this.pointColor=t,this.lineColor=e,this.pointSize=this.checkPositiveNumber(s),this.lineSize=this.checkPositiveNumber(n),i.logDebug("Line style configured",this)},positionYAxis:function(t,e){if(this.yMax=Number(e),this.yMin=Number(t),isNaN(this.yMax)||isNaN(this.yMin))throw new x("Min and max must be numbers");if(this.yMin>this.yMax)throw new x("The maximum value must be greater than the minimum value");this.parent&&null!=this.parent.screenY&&this.parent.painter&&(this.calcYUnit(),this.paintYLabels(),this.isEmpty()||this.repaint()),i.logDebug("Y axis is now positioned",this)},getYField:function(){return this.yField}},n.prototype.setYLabels=n.prototype.setYLabels,n.prototype.setStyle=n.prototype.setStyle,n.prototype.positionYAxis=n.prototype.positionYAxis,n.prototype.getYField=n.prototype.getYField,y(n,C,"O"),n}(),B=function(){var t=function(t){var e=!1;if(!t)try{document.createElement("canvas").getContext&&(e=!0)}catch(t){}this.useCanvas=e,this.chartArea,this.lines={}};t.prototype={setContainer:function(t){this.chartArea=document.createElement("div"),this.chartArea.style.position="absolute",this.chartArea.style.overflow="hidden",t.appendChild(this.chartArea)},clean:function(){this.chartArea&&A.isAttachedToDOM(this.chartArea)&&this.chartArea.parentNode.removeChild(this.chartArea)},setSize:function(t,e){this.chartArea.style.width=t+"px",this.chartArea.style.height=e+"px",this.areaHeight=e,this.areaWidth=t},setOffset:function(t,e){this.chartArea.style.top=e+"px",this.chartArea.style.left=t+"px"},setAreaStyle:function(t){this.chartArea.className=t},addLine:function(t){var s=t.getId();this.lines[s]=this.useCanvas?new e(t,this):new i(t,this)},removeLine:function(t){var e=t.getId();this.lines[e]&&(this.lines[e].remove(),delete this.lines[e])},clearLine:function(t){var e=t.getId();this.lines[e]&&this.lines[e].clear()},paintLine:function(t,e,i){var s=t.getId();this.lines[s]||this.addLine(t),this.lines[s].drawTo(e,i)}};var e=function(t,e){this.chartLine=t,this.lastX=null,this.lastY=null,this.painter=e,this.canvasObj=null,this.canvasEl=null};e.prototype={initCanvas:function(){if(!this.canvasEl){var t=document.createElement("canvas");t.style.position="absolute",t.style.overflow="hidden";var e=t.getContext("2d");this.painter.chartArea.appendChild(t),this.canvasEl=t,this.canvasObj=e}this.canvasEl.width=this.painter.areaWidth,this.canvasEl.height=this.painter.areaHeight},drawTo:function(t,e){if(e=this.painter.areaHeight-e,null===this.lastX)return this.initCanvas(),void this.drawPoint(t,e);this.canvasObj.beginPath(),this.canvasObj.strokeStyle=this.chartLine.lineColor,this.canvasObj.lineWidth=this.chartLine.lineSize,this.canvasObj.moveTo(this.lastX,this.lastY),this.canvasObj.lineTo(t,e),this.canvasObj.stroke(),this.drawPoint(t,e)},drawPoint:function(t,e){this.lastX=t,this.lastY=e;var i=Math.round(this.chartLine.pointSize/2);this.canvasObj.fillStyle=this.chartLine.pointColor,this.canvasObj.fillRect(t-i,e-i,this.chartLine.pointSize,this.chartLine.pointSize)},clear:function(){this.lastX=null,this.lastY=null,this.canvasObj.clearRect(0,0,this.canvasEl.width,this.canvasEl.height)},remove:function(){this.lastX=null,this.lastY=null,this.painter.chartArea.removeChild(this.canvasEl),this.canvasEl=null}};var i=function(t,e){this.chartLine=t,this.lastX=null,this.lastY=null,this.painter=e,this.pointArray=[]};return i.prototype={drawTo:function(t,e){if(null!==this.lastX){var i=t-this.lastX,s=e-this.lastY,n=Math.abs(i),r=Math.abs(s),a=null,o=0,h=0,l=0;n>=r?(l=s/i,o=i,h=i>=0?1:-1):(l=i/s,o=s,h=s>=0?1:-1);var u=0,c=0,d=null,_=null,p=!0,f=!0;n<r&&(f=!1);for(var m=0;m!=o;m+=h){var g=0,v=0,S=0,b=0,y=!1;if(m+h==o&&(y=!0,p=!0),a=document.createElement("div"),y?(a.style.backgroundColor=this.chartLine.pointColor,a.style.width=this.chartLine.pointSize+"px",a.style.height=this.chartLine.pointSize+"px"):(a.style.backgroundColor=this.chartLine.lineColor,a.style.width=this.chartLine.lineSize+"px",a.style.height=this.chartLine.lineSize+"px"),a.style.position="absolute",a.style.fontSize="0px",this.painter.chartArea.appendChild(a),this.pointArray.push(a),p&&(p=!1,d=Math.ceil(a.offsetWidth/2),_=Math.ceil(a.offsetHeight/2),u=a.offsetWidth,c=a.offsetHeight),S=u,b=c,f){if(g=Math.round(m+this.lastX),v=Math.round(this.painter.areaHeight-(l*m+this.lastY)),!y){for(var E=0;m+h!=o-h&&v==Math.round(this.painter.areaHeight-(l*(m+h)+this.lastY));)m+=h,E++;S=u+(w=d*E),h<0&&(g-=w)}}else if(g=Math.round(l*m+this.lastX),v=Math.round(this.painter.areaHeight-(m+this.lastY)),!y){for(E=0;m+h!=o-h&&g==Math.round(l*(m+h)+this.lastX);)m+=h,E++;var w;b=c+(w=_*E),h>0&&(v-=w)}g-=Math.floor(d/2),v-=Math.floor(_/2),a.style.left=g+"px",a.style.top=v+"px",a.style.width=S+"px",a.style.height=b+"px"}this.drawPoint(t,e)}else this.drawPoint(t,e)},drawPoint:function(t,e){this.lastX=t,this.lastY=e},clear:function(){if(this.pointArray[0]&&A.isAttachedToDOM(this.pointArray[0]))for(var t=0;t<this.pointArray.length;t++)this.pointArray[t].parentNode.removeChild(this.pointArray[t]);this.pointArray=[],this.lastX=null,this.lastY=null},remove:function(){this.clear()}},t}(),U=function(){w.browserDocumentOrDie();var t="A DOM element must be provided as an anchor for the chart";function e(t,e,i){var s=(new Number(t)-e)/i;return Math.round(s)}var i=I.getLoggerProxy("lightstreamer.charts"),s=function(t){this._callSuperConstructor(s,arguments),this.caContainer=document.createElement("div"),this.caContainer.style.position="relative",this.caContainer.style.overflow="visible",this.areaClass="",this.offsetY=0,this.offsetX=0,this.screenX=null,this.screenY=null,this.labels=[],this.labelsFormatter=null,this.numXLabels=0,this.xFieldCode=null,this.xMin=null,this.xMax=null,this.xUnit=null,this.xParser=null,this.chartArray={},this.yParsers={},this.forcedDivPainting=!1,this.painter=null,this.parseHtml()};return s.prototype={toString:function(){return["[","Chart",this.id,"]"].join("|")},forceDivPainting:function(t){this.forcedDivPainting=!0===t},initPainter:function(){this.painter=new B(this.forcedDivPainting),this.painter.setContainer(this.caContainer),this.configurePainter()},configurePainter:function(){this.painter&&(this.painter.setSize(this.screenX,this.screenY),this.painter.setOffset(this.offsetX,this.offsetY),this.painter.setAreaStyle(this.areaClass),i.logDebug("Painter configured"))},setChartAnchor:function(t,e){if(!this.painter)if(t&&t.appendChild){for(var s in t.appendChild(this.caContainer),null==this.screenX&&(this.screenX=t.offsetWidth),null==this.screenY&&(this.screenY=t.offsetHeight),this.initPainter(),null!=this.xMax&&(this.calcXUnit(),this.paintXLabels()),this.chartArray)for(var n in this.chartArray[s]){var r=this.chartArray[s][n];r&&r.isYAxisPositioned()&&(r.calcYUnit(),r.paintYLabels())}i.logInfo("Chart is now ready to be used",this,t)}else e||i.logError("A DOM element must be provided as an anchor for the chart",this)},createLabel:function(t,e,s,n){i.logDebug("Creating a new label for the chart",this);var r=document.createElement("div");null!=t&&(r.className=t),r.style.position="absolute";var a=document.createTextNode(e);r.appendChild(a),this.caContainer.appendChild(r);var o=r.offsetWidth;return"X"==n.toUpperCase()?(r.style.top=this.screenY+5+this.offsetY+"px",r.style.left=s-r.offsetWidth/2+this.offsetX+"px"):"Y"==n.toUpperCase()&&(r.style.left=this.offsetX-o+"px",r.style.top=this.screenY-s-r.offsetHeight/2+this.offsetY+"px"),r},clearLine:function(t){this.painter.clearLine(t)},drawLine:function(t,e,s){i.isDebugLogEnabled()&&i.logDebug("Drawing line on the chart",this);var n=this.getRelativeX(t),r=s.getRelativeY(e);i.isDebugLogEnabled()&&i.logDebug("New line coordinates",n,r),this.painter.paintLine(s,n,r),i.isDebugLogEnabled()&&i.logDebug("New line was drawn")},repaintAll:function(t,e,s){for(var n in i.logDebug("Repaint All"),this.chartArray)for(var r in this.chartArray[n]){var a=this.chartArray[n][r];a&&!a.isEmpty()&&a.repaint()}},calcXUnit:function(){this.xUnit=(this.xMax-this.xMin)/this.screenX,i.isDebugLogEnabled()&&i.logDebug("Calculated X unit",this,this.xUnit)},paintXLabels:function(){this.clearLabels();var t="",e=-1;if(!(this.numXLabels<=0)){if(this.numXLabels>0&&(t=this.labelsFormatter?this.labelsFormatter(this.xMin):this.xMin,e=this.getRelativeX(this.xMin),this.labels[this.labels.length]=this.createLabel(this.classXLabels,t,e,"X")),this.numXLabels>1&&(t=this.labelsFormatter?this.labelsFormatter(this.xMax):this.xMax,e=this.getRelativeX(this.xMax),this.labels[this.labels.length]=this.createLabel(this.classXLabels,t,e,"X")),this.numXLabels>2)for(var s=this.numXLabels-1,n=(this.xMax-this.xMin)/s,r=this.xMin,a=1;a<s;a++)r+=n,t=this.labelsFormatter?this.labelsFormatter(r):r,e=this.getRelativeX(r),this.labels[this.labels.length]=this.createLabel(this.classXLabels,t,e,"X");i.logDebug("X labels generated",this)}},getRelativeX:function(t){return e(t,this.xMin,this.xUnit)},clearLabels:function(){for(var t=0;t<this.labels.length;t++)this.labels[t]&&A.isAttachedToDOM(this.labels[t])&&this.labels[t].parentNode.removeChild(this.labels[t]);this.labels=[],i.logDebug("X labels cleared",this)},onListenStart:function(t){this._callSuperMethod(s,"onListenStart",[t]),this.updateIsKey()&&(this.kind=F.ITEM_IS_KEY)},parseValue:function(t,e,i,s){var n=null===e[i]||void 0===e[i]?this.values.get(t,i):e[i];return null===(n=s?s(n,t):n)?null:T.getNumber(n)},mergeUpdate:function(t,e){this.updateLater(t,e)},updateRowExecution:function(t,e){var s=this.parseValue(t,e,this.xFieldCode,this.xParser);if(null!==s&&!(isNaN(s)||null!==s&&s<this.xMin))for(var n in s>this.xMax&&this.dispatchEvent("onXOverflow",[t,s,this.xMin,this.xMax]),this.chartArray){var r=this.parseValue(t,e,n,this.yParsers[n]);if(!isNaN(r)){var a=this.chartArray[n][t];if(null!=s&&null!=r){if(!a){if(a=new q(t,this,this.xFieldCode,n),this.dispatchEvent("onNewLine",[t,a,s,r]),!a.isYAxisPositioned())return void i.logError("Cannot create line. Please declare the Y axis",this);a.calcYUnit(),a.paintYLabels(),this.chartArray[n][t]=a}a.isPointInRange(r)||this.dispatchEvent("onYOverflow",[t,a,r,a.getMin(),a.getMax()]),a.addPoint(s,r)}else{if(a&&null==s&&null==r){i.logInfo("Got double nulls, clear line",this,a),a.reset();continue}i.logDebug("Got a null, ignore point",this,a)}}}},removeRowExecution:function(t){for(var e in this.chartArray)this.deleteChartLine(t,e)},deleteChartLine:function(t,e){if(this.chartArray[e]){var s=this.chartArray[e][t];s.reset(),s.clearLabels(),this.painter.removeLine(s),delete this.chartArray[e][t],this.dispatchEvent("onRemovedLine",[t,s]),i.logDebug("Line removed",this,t,e)}},clean:function(){this._callSuperMethod(s,"clean"),this.clearLabels(),this.painter&&this.painter.clean(),delete this.painter,this.setChartAnchor(this.caContainer.parentNode,!0),i.logDebug("Cleaned all",this)},parseHtml:function(){i.logInfo("Parse html for Chart",this);var e=document.getElementById(this.id);if(e){if(!A.verifyTag(e))throw new b(t);this.setChartAnchor(e),this.parsed=!0}},configureArea:function(t,e,i,s,n){if(t&&(this.areaClass=t),s&&(this.offsetY=this.checkPositiveNumber(s,!0)),n&&(this.offsetX=this.checkPositiveNumber(n,!0)),e&&(this.screenY=this.checkPositiveNumber(e,!0)),i&&(this.screenX=this.checkPositiveNumber(i,!0)),this.configurePainter(),i||e)for(var r in i&&null!=this.xMax&&(this.calcXUnit(),this.paintXLabels()),this.chartArray)for(var a in this.chartArray[r]){var o=this.chartArray[r][a];o&&o.isYAxisPositioned()&&null!=this.xMax&&(e&&(o.calcYUnit(),o.paintYLabels()),o&&!o.isEmpty()&&o.repaint())}},setXAxis:function(t,e){this.xFieldCode=t,this.xParser=e,this.clean(),i.logDebug("X axis is now configured on field",t,this)},addYAxis:function(t,e){if(T.isArray(t)){i.logDebug("Configuring multiple Y axis",this);for(var s=0;s<t.length;s++)T.isArray(e)?this.addYAxis(t[s],e[s]):this.addYAxis(t[s],e)}else this.chartArray[t]||(this.chartArray[t]={}),this.yParsers[t]=e,i.logDebug("Y axis is now configured on field",t,this)},removeYAxis:function(t){if(T.isArray(t)){i.logDebug("removing multiple Y axis",this);for(var e=0;e<t.length;e++)this.removeYAxis(t[e])}else{if(!this.chartArray[t])return;for(var s in this.chartArray[t])this.deleteChartLine(s,t);delete this.chartArray[t],delete this.yParsers[t],i.logDebug("Y axis is now removed",t,this)}},positionXAxis:function(t,e){if(this.xMax=Number(e),this.xMin=Number(t),isNaN(this.xMax)||isNaN(this.xMin))throw new x("Min and max must be numbers");if(this.xMin>this.xMax)throw new x("The maximum value must be greater than the minimum value");null!=this.screenX&&(this.calcXUnit(),this.paintXLabels()),this.repaintAll(),i.logDebug("X axis is now positioned",this)},setXLabels:function(t,e,s){this.numXLabels=this.checkPositiveNumber(t,!0),this.classXLabels=e,this.labelsFormatter=s||null,null!=this.xUnit&&this.paintXLabels(),i.logDebug("X labels now configured",this)},addListener:function(t){this._callSuperMethod(s,"addListener",[t])},removeListener:function(t){this._callSuperMethod(s,"removeListener",[t])},getListeners:function(){return this._callSuperMethod(s,"getListeners")}},s.prototype.parseHtml=s.prototype.parseHtml,s.prototype.configureArea=s.prototype.configureArea,s.prototype.setXAxis=s.prototype.setXAxis,s.prototype.addYAxis=s.prototype.addYAxis,s.prototype.removeYAxis=s.prototype.removeYAxis,s.prototype.positionXAxis=s.prototype.positionXAxis,s.prototype.setXLabels=s.prototype.setXLabels,s.prototype.addListener=s.prototype.addListener,s.prototype.removeListener=s.prototype.removeListener,s.prototype.getListeners=s.prototype.getListeners,s.prototype.clean=s.prototype.clean,s.prototype.onListenStart=s.prototype.onListenStart,s.prototype.updateRowExecution=s.prototype.updateRowExecution,s.prototype.removeRowExecution=s.prototype.removeRowExecution,y(s,F),s}(),W=function(){function t(t){var i=!1;for(var s in t)e(t[s])?i=!0:delete t[s];return i}function e(t){if(t.isCell)return t.isAttachedToDOMById();for(var e=!1,i=0;i<t.length;)t[i].isAttachedToDOMById()?(e=!0,i++):t.splice(i,1);return e}function i(t,e){var i=new A(document.createElement("p"));i.scrollHere(t,e);var s=t.getNum();return i.getNum=function(){return s},i}function s(t){if(t.isCell)t.clean();else for(var e=0;e<t.length;e++)t[e].clean()}function n(t,e){if(t.isCell)return i(t,e);for(var s=[],n=0;n<t.length;n++)s[n]=i(t[n],e);return s}var r=function(t){this._callSuperConstructor(r,[t])};return r.scrollRow=function(t,e,r){var a={};for(var o in t)a[o]=!0;if(e)for(var o in e)a[o]=!0;else e={};for(var h in a)if(t[h])if(e[h])if(e[h].isCell&&t[h].isCell)e[h].scrollHere(t[h],r);else{var l=t[h].isCell?[t[h]]:t[h];if(e[h].isCell){var u=e[h];e[h]=[u]}for(var c=[].concat(e[h]),d=0;d<l.length;d++){for(var _=!1,p=0;p<c.length;p++)if(c[p].getNum()===l[d].getNum()){c[p].scrollHere(l[d],r),_=!0,c.splice(p,1);break}_||e[h].push(i(l[d],r))}s(c)}else e[h]=n(t[h],r);else s(e[h]);return e},r.prototype={alreadyInList:function(t){var e=this.getCell(t.getRow(),t.getField());if(!e)return!1;if(e.isCell)return e.isSameEl(t);for(var i=0;i<e.length;i++)if(e[i].isSameEl(t))return!0;return!1},addCell:function(t,e,i){e=e||t.getRow(),i=i||t.getField();var s=this.getCell(e,i);if(s)if(s.isCell){var n=[s,t];this.insert(n,e,i)}else s.push(t);else this.insert(t,e,i)},forEachCell:function(t){var e=this;this.forEachElement((function(i,s,n){e.forEachCellInElement(i,s,n,t)}))},forEachCellInRow:function(t,e){var i=this;this.forEachElementInRow(t,(function(t,s,n){i.forEachCellInElement(t,s,n,e)}))},forEachCellInPosition:function(t,e,i){var s=this.get(t,e);s&&this.forEachCellInElement(s,t,e,i)},forEachCellInElement:function(t,e,i,s){if(t.isCell)s(t,e,i);else for(var n=0;n<t.length;n++)s(t[n],e,i,t[n].getNum())},getCell:function(t,e,i){if(i){var s=this.get(t,e);if(s)if(s.isCell){if(s.getNum()==i)return s}else for(var n=0;n<s.length;n++)if(s[n].getNum()==i)return s[n];return null}return this.get(t,e)},cellsGarbageCollection:function(){var e=this.getEntireMatrix();for(var i in e)t(e[i])||delete e[i]}},y(r,E,!1,!0),r}(),H=function(){var t=L.isProbablyAWebkit()&&L.isProbablyChrome(32,!0)?null:"about:blank",e={},i={createFrame:function(i,s){if(!w.isBrowserDocument())return null;var n=document.getElementsByTagName("BODY")[0];if(!n)return null;s=s||t;var r=document.createElement("iframe");r.style.visibility="hidden",r.style.height="0px",r.style.width="0px",r.style.display="none",r.name=i,r.id=i,L.isProbablyIE()||L.isProbablyOldOpera()?(r.src=s,n.appendChild(r)):(n.appendChild(r),r.src=s);try{if(r.contentWindow){try{r.contentWindow.name=i}catch(t){}return e[i]=r.contentWindow,e[i]}return document.frames&&document.frames[i]?(e[i]=document.frames[i],e[i]):null}catch(t){return null}},getFrameWindow:function(t,i,s){return i&&!e[t]&&this.createFrame(t,s),e[t]||null},disposeFrame:function(t){if(e[t]){try{document.getElementsByTagName("BODY")[0].removeChild(document.getElementById(t))}catch(t){}delete e[t]}},removeFrames:function(){for(var t in e)try{document.getElementsByTagName("BODY")[0].removeChild(document.getElementById(t))}catch(t){}e={}}};return i.createFrame=i.createFrame,i.getFrameWindow=i.getFrameWindow,i.disposeFrame=i.disposeFrame,i.removeFrames=i.removeFrames,N.addUnloadHandler(i.removeFrames),i}(),V=function(){w.browserDocumentOrDie();var t=I.getLoggerProxy("lightstreamer.grids");function e(e){if(0==e.indexOf("#")&&(e=e.substring(1,e.length)),3==e.length)e=e.charAt(0)+e.charAt(0)+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2);else if(6!=e.length)return t.warn("A hexadecimal color value must be 3 or 6 character long. An invalid value was specified, will be ignored"),null;var i=e.substring(0,2),s=e.substring(2,4),r=e.substring(4,6),a=n(i),o=n(s),h=n(r);return null==a||null==o||null==h?null:[a,o,h]}var i={A:10,B:11,C:12,D:13,E:14,F:15};function s(e){return e>=0&&e<=9?new Number(e):(e=e.toUpperCase(),i[e]?i[e]:(t.warn("A hexadecimal number must contain numbers between 0 and 9 and letters between A and F. An invalid value was specified, will be ignored"),null))}function n(t){var e,i=0,n=0;for(e=t.length;e>=1;e--){var r,a=s(t.substring(e-1,e));if(null==a)return null;for(r=1;r<=n;r++)a*=16;n++,i+=a}return i}function r(e){if(e.indexOf("%")==e.length-1){if((e=parseFloat(e.substring(0,e.length-1)))>100||e<0)return t.warn("A RGB element must be a number >=0 and <=255 or a percentile >=0 and <=100. An invalid value was specified, will be ignored"),null;e*=2.55}return e}function a(t,e){return!(!t||""==t||e&&t==e)}function o(t){var e=document.createElement("DIV");e.style.backgroundColor=t;var i=f.getStyle(e,c,t);if(null==i)return null;if(255==i[0]&&255==i[1]&&255==i[2]&&"WHITE"!=t.toUpperCase()){var s=document.getElementsByTagName("BODY")[0];s&&(s.appendChild(e),i=f.getStyle(e,c,t),s.removeChild(e))}return _[t]=i,_[t]}function h(t){var i="";if(_[t])return _[t];if(!L.isProbablyIE())return o(t);try{(p=H.getFrameWindow("weswit__ColorFrame",!0))&&(p.document.bgColor=t,i=p.document.bgColor)}catch(t){i=null}if(!i||i==t){var s=document.bgColor;document.bgColor=t,i=document.bgColor,document.bgColor=s}return i&&i!=t?(_[t]=e(i),_[t]):o(t)}function l(e){var i,s;if(0==e.indexOf("rgb("))i=4,s=")";else{if(0!=e.indexOf("rgba("))return t.warn("A RGB color value must be in the form 'rgb(x, y, z)' or 'rgba(x, y, z, a)'. An invalid value was specified, will be ignored"),null;i=5,s=","}var n=(e=e.substring(i,e.length)).indexOf(","),a=r(e.substring(0,n)),o=e.indexOf(",",n+1),h=r(e.substring(n+1,o)),l=e.indexOf(s,o+1),u=r(e.substring(o+1,l));return null==a||null==h||null==u?null:[a,h,u]}var u="background-color",c="backgroundColor",d="transparent",_={},p=null,f={translateToRGBArray:function(t){return 0==t.indexOf("rgb")?l(t):0==t.indexOf("#")?e(t):h(t)},getStyle:function(t,e,i){if(null==t)return[255,255,255];var s="";try{if(window.getComputedStyle||document.defaultView&&document.defaultView.getComputedStyle){var n=document.defaultView.getComputedStyle(t,null);if(n){var r=e==c?u:e;s=n.getPropertyValue(r)}}}catch(t){}try{!a(s,i)&&t.currentStyle&&(r=e==u?c:e,s=t.currentStyle[r])}catch(t){}try{if(!a(s,i)){var o=e==u?c:e;if(""==t.style[o])return[255,255,255];s=t.style[o]}}catch(t){}return s==d&&t.parentNode?this.getStyle(t.parentNode,e):s==d?[255,255,255]:a(s,i)?this.translateToRGBArray(s):[255,255,255]}};return f}(),Y=function(){w.browserDocumentOrDie();var t=function(t){this.fadeInterval=t,this.freeFaders=new i,this.faderId=0,this.faderList={},this.fadeThread=!1,this.runningFaders={}};function e(t){return function(){t.style.backgroundColor="transparent"}}t.prototype={getNewFaderId:function(t,e,i,n,r,a){var o=this.getHowManySteps(r),h=t.incFadePhase();if(h){var l=this.freeFaders.get();return null==l?(this.faderList[this.faderId]=new s(t,e,i,n,o,h,a),this.faderId++):(this.faderList[l].init(t,e,i,n,o,h,a),l)}},getHowManySteps:function(t){var e=t/this.fadeInterval;return e>1?e:1},launchFader:function(t){var e=this.faderList[t],i=e.cell.getFadePhase();if(i){if(!(e.phase<i)){var s=this.runningFaders[e.cell.getCellId()],n=this.faderList[s];n&&(n.goingDown||(e.goingDown?n.endCommand&&D.executeTask(n.endCommand):(e.actStep=n.actStep,e.steps<n.steps&&(e.steps=n.steps))),this.freeFaders.put(s)),this.runningFaders[e.cell.getCellId()]=t,e.endBack&&(e.startBack=V.getStyle(e.cell.getEl(),"backgroundColor")),e.endFore&&(e.startFore=V.getStyle(e.cell.getEl(),"color")),this.fadeThread||this.fadeThreadStart(this.fadeInterval)}}else this.stopFader(e.cell)},stopFader:function(t){var e=this.runningFaders[t.getCellId()];(e||0==e)&&(delete this.runningFaders[t.getCellId()],this.freeFaders.put(e))},doFade:function(t){var i=T.getTimeStamp(),s=0;t&&(s=i-(t+this.fadeInterval));var n=!1;for(var r in this.runningFaders){var a=this.runningFaders[r],o=this.faderList[a];if(o.actStep>o.steps)this.freeFaders.put(a),delete this.runningFaders[r],o.endCommand&&D.addPackedTimedTask(o.endCommand,0);else{var h=o.cell.getEl();if(!h){this.stopFader(o.cell);continue}if("transparent"==o.endBack)try{h.style.backgroundColor="rgba("+o.startBack[0]+","+o.startBack[1]+","+o.startBack[2]+","+this.easeInOut(100,0,o.steps,o.actStep)/100+")"}catch(t){var l=(o.steps-o.actStep)*this.fadeInterval;D.addTimedTask(e(h),l),o.endCommand&&D.addPackedTimedTask(o.endCommand,l),this.stopFader(o.cell);continue}else o.endBack&&(h.style.backgroundColor="rgb("+this.easeInOut(o.startBack[0],o.endBack[0],o.steps,o.actStep)+","+this.easeInOut(o.startBack[1],o.endBack[1],o.steps,o.actStep)+","+this.easeInOut(o.startBack[2],o.endBack[2],o.steps,o.actStep)+")");o.endFore&&(h.style.color="rgb("+this.easeInOut(o.startFore[0],o.endFore[0],o.steps,o.actStep)+","+this.easeInOut(o.startFore[1],o.endFore[1],o.steps,o.actStep)+","+this.easeInOut(o.startFore[2],o.endFore[2],o.steps,o.actStep)+")"),n=!0}o.actStep++}if(n){var u=T.getTimeStamp(),c=u-i+s;if(c>this.fadeInterval){var d=c/this.fadeInterval,_=Math.floor(d),p=d-_;this.recoverCycles(_),c=this.fadeInterval*p}this.nextFade(this.fadeInterval-c,u)}else this.fadeThread=!1},nextFade:function(t,e){D.addTimedTask(this.doFade,t,this,[e])},recoverCycles:function(t){for(var e in this.runningFaders){var i=this.runningFaders[e],s=this.faderList[i];s.actStep>s.steps||(s.actStep+t<s.steps?s.actStep+=t:s.actStep=s.steps)}},fadeThreadStart:function(t){1!=this.fadeThread&&(this.fadeThread=!0,this.nextFade(t))},easeInOut:function(t,e,i,s){var n=(t=new Number(t))+1/i*s*((e=new Number(e))-t);return Math.ceil(n)},fadeCell:function(t,e,i,s,n){var r=D.packTask(n),a=new A(t),o=this.getNewFaderId(a,!1,e,i,s,r);return this.launchFader(o),o}};var i=function(){this.length=0,this.pile={}};i.prototype={put:function(t){this.pile[this.length]=t,this.length++},get:function(){return this.length<=0?null:(this.length--,this.pile[this.length])}};var s=function(t,e,i,s,n,r,a){this.init(t,e,i,s,n,r,a)};return s.prototype={init:function(t,e,i,s,n,r,a){this.endCommand=a||null,this.goingDown=e,this.cell=t,this.endBack=""===i||"transparent"==i?"transparent":i?V.translateToRGBArray(i):null,this.endFore=s?V.translateToRGBArray(s):null,this.steps=n,this.phase=r,this.actStep=0}},t}(),G=function(){w.browserDocumentOrDie();var t="backgroundColor",e="color",i="The given array is not valid or empty",s="The given value is not valid, use UPDATE_IS_KEY or ITEM_IS_KEY.",n="This method can only be called while the grid is empty.",r=["div","span","input"];function a(t){return null===t?"":t}var o=I.getLoggerProxy("lightstreamer.grids"),h=function(){this._callSuperConstructor(h,arguments),this.useInner=!1,this.fieldSymbols=null,this.tagsToCheck=r,this.addOnTop=!1,this.sortField=null,this.descendingSort=!1,this.numericSort=!1,this.commaAsDecimalSeparator=!1,this.fader=new Y(50),this.currentUpdateKey=null,this.currentUpdateValues=null,this.rowCount=0,this.maxRow=0,this.grid=new W};return h.prototype={mergeUpdate:function(t,e){for(var i in o.isDebugLogEnabled()&&o.logDebug("Merging this update values with the values of the current update",this),e)this.currentUpdateValues[i]=e[i];this.fillFormattedValues(this.currentUpdateKey,e)},fillFormattedValues:function(t,e){for(var i in e)this.grid.forEachCellInPosition(t,i,(function(s){o.isDebugLogEnabled()&&o.logDebug("Filling formatted values in cell",t,i),s.setNextFormattedValue(a(e[i]))}))},isBefore:function(t,e){return null!=t&&null!=e||t==e?this.descendingSort?t>e:t<e:null==t?!this.descendingSort:this.descendingSort},setHtmlInterpretationEnabled:function(t){this.useInner=this.checkBool(t)},isHtmlInterpretationEnabled:function(){return this.useInner},setNodeTypes:function(t){if(!(t&&t.length>0))throw new x(i);this.tagsToCheck=t},getNodeTypes:function(){return this.tagsToCheck},setAddOnTop:function(t){null!=this.sortField&&o.logWarn("Scroll direction is ignored if sort is enabled"),this.addOnTop=this.checkBool(t)},isAddOnTop:function(){return this.addOnTop},setSort:function(t,e,i,s){t?(this.sortField=t,this.descendingSort=this.checkBool(e,!0),this.numericSort=this.checkBool(i,!0),this.commaAsDecimalSeparator=this.checkBool(s,!0),this.sortTable()):this.sortField=null},getSortField:function(){return this.sortField},isDescendingSort:function(){return null===this.sortField?null:this.descendingSort},isNumericSort:function(){return null===this.sortField?null:this.numericSort},isCommaAsDecimalSeparator:function(){return null!==this.sortField&&this.numericSort?this.commaAsDecimalSeparator:null},extractFieldList:function(){return this.extractTypedFieldList(A.FIRST_LEVEL)},extractCommandSecondLevelFieldList:function(){return this.extractTypedFieldList(A.SECOND_LEVEL)},parseHtml:function(){},forceSubscriptionInterpretation:function(t){if(this.rowCount>0)throw new b(n);if(t){if(t!=F.UPDATE_IS_KEY&&t!=F.ITEM_IS_KEY)throw new x(s);this.kind=t,this.forcedInterpretation=!0}else this.forcedInterpretation=!1,this.chooseInterpretation()},extractTypedFieldList:function(t){var e=this.computeFieldSymbolsSet(t),i=[];for(var s in e)i.push(s);return i},makeSortValue:function(t){return this.numericSort?T.getNumber(t,this.commaAsDecimalSeparator):null===t?t:new String(t).toUpperCase()},visualUpdateExecution:function(i,s,n){n=n||i;var r=s.coldToHotTime,a=r+s.hotTime,o=a+s.hotToColdTime,h=s.hotRowStyle,l=s.coldRowStyle,u=[],c=this.grid.getRow(i);for(var d in c)for(var _=-1,p=c[d],f=0;p&&(p.isCell||f<p.length);f++){var m=p.isCell?p:p[f];p=p.isCell?null:p,null===m.getNum()&&_++;var g=this.getSlidingCell?this.getSlidingCell(m,n,d,m.getNum(),_):m;if(null!=m.getNextFormattedValue()){var v=m.setUpdating(),S=m.getNextColdArray(l),b=m.getNextHotArray(h);if(b){var y=!1,E=!1,w=!1,T=null,R=null,x=null,I=null;if(b&&(b[t]&&(y=!0,T=b[t],R=S[t]),b[e]&&(y=!0,x=b[e],I=S[e])),y){if(r>0){var C=D.packTask(g.asynchUpdateValue,g,[v,this.useInner]),L=this.fader.getNewFaderId(g,!1,T,x,r,C);this.fader.launchFader(L),E=!0}else this.fader.stopFader(g);if(s.hotToColdTime>0){var M=D.packTask(g.asynchUpdateStyles,g,[v,A.COLD]);L=this.fader.getNewFaderId(g,!0,R,I,s.hotToColdTime,M),D.addTimedTask(this.fader.launchFader,a,this.fader,[L]),w=!0}}if(!E)if(r>0)D.addTimedTask(g.asynchUpdateValue,r,g,[v,this.useInner]);else{var N=D.packTask(g.asynchUpdateValue,g,[v,this.useInner]);u.push(N)}w||D.addTimedTask(g.asynchUpdateStyles,o,g,[v,A.COLD])}else r>0?D.addTimedTask(g.asynchUpdateValue,r,g,[v,this.useInner]):(N=D.packTask(g.asynchUpdateValue,g,[v,this.useInner]),u.push(N)),S&&(s.hotToColdTime>0?(R=S[t],I=S[e],M=D.packTask(g.asynchUpdateStyles,g,[v,A.COLD]),L=this.fader.getNewFaderId(g,!0,R,I,s.hotToColdTime,M),D.addTimedTask(this.fader.launchFader,a,this.fader,[L])):D.addTimedTask(g.asynchUpdateStyles,o,g,[v,A.COLD]))}}for(var O=0;O<u.length;O++)D.executeTask(u[O])},updateRowExecution:function(t,e){},removeRowExecution:function(t){},sortTable:function(){},computeFieldSymbolsSet:function(t){}},h.prototype.setHtmlInterpretationEnabled=h.prototype.setHtmlInterpretationEnabled,h.prototype.isHtmlInterpretationEnabled=h.prototype.isHtmlInterpretationEnabled,h.prototype.setNodeTypes=h.prototype.setNodeTypes,h.prototype.getNodeTypes=h.prototype.getNodeTypes,h.prototype.setAddOnTop=h.prototype.setAddOnTop,h.prototype.isAddOnTop=h.prototype.isAddOnTop,h.prototype.setSort=h.prototype.setSort,h.prototype.getSortField=h.prototype.getSortField,h.prototype.isDescendingSort=h.prototype.isDescendingSort,h.prototype.isNumericSort=h.prototype.isNumericSort,h.prototype.isCommaAsDecimalSeparator=h.prototype.isCommaAsDecimalSeparator,h.prototype.extractFieldList=h.prototype.extractFieldList,h.prototype.extractCommandSecondLevelFieldList=h.prototype.extractCommandSecondLevelFieldList,h.prototype.parseHtml=h.prototype.parseHtml,h.prototype.forceSubscriptionInterpretation=h.prototype.forceSubscriptionInterpretation,h.prototype.updateRowExecution=h.prototype.updateRowExecution,h.prototype.removeRowExecution=h.prototype.removeRowExecution,y(h,F),h}(),K=function(){var t=function(){};return t.prototype={init:function(){this.length=0,this.hashMap={},this.oneMap||(this.map={})}},t}(),z=function(){var t=function(e,i,s){this._callSuperConstructor(t),this.domNode=e,this.toInsBefore=i,this.offsetIndex=s,this.oneMap=!0,this.topChild=this.toInsBefore,this.init()};return t.prototype={removeChild:function(t){if(!(this.length<=0)){this.length--,delete this.hashMap[t.getId()];var e=t.element();e==this.topChild&&(this.topChild=e.nextSibling),this.domNode.removeChild(e),t.setParentNode(null)}},insertBefore:function(t,e){e!=t&&t&&(e&&null!=this.hashMap[e.getId()]?(this.insertOperation(t),this.domNode.insertBefore(t.element(),e.element())):this.appendChild(t,!0))},appendChild:function(t,e){if(t){this.insertOperation(t);var i=t.element();e?(this.topChild||(this.topChild=i),this.toInsBefore?this.domNode.insertBefore(i,this.toInsBefore):this.domNode.appendChild(i)):(this.domNode.insertBefore(i,this.topChild),this.topChild=i)}},insertOperation:function(t){t.isSonOf(this)||(this.length++,this.hashMap[t.getId()]=t,t.isolation(),t.setParentNode(this))},getChild:function(t){if(this.length<=t)return null;t+=this.offsetIndex;var e=this.domNode.childNodes[t].getAttribute("id");return this.getElementById(e)},getElementById:function(t){return this.hashMap[t]},clean:function(){for(var t in this.domNode&&delete this.domNode,this.toInsBefore&&delete this.toInsBefore,this.hashMap)this.hashMap[t].clean()}},y(t,K),t}(),j=function(){var t=function(){this._callSuperConstructor(t),this.oneMap=!1,this.init()};return t.prototype={removeChild:function(t){if(!(this.length<=0)){var e;for(this.length--,e=this.hashMap[t.getId()];e<this.length;e++)this.map[e]=this.map[e+1],this.hashMap[this.map[e].getId()]=e;this.hashMap[t.getId()]=null,this.map[this.length]=null,t.setParentNode(null)}},insertBefore:function(t,e){if(e!=t&&t)if(e)if(null!=this.hashMap[e.getId()]){t.isolation();for(var i=this.hashMap[e.getId()],s=this.length;s>=i+1;s--)this.map[s]=this.map[s-1],this.hashMap[this.map[s].getId()]=s;this.insertOperation(t,i)}else this.appendChild(t,!0);else this.appendChild(t,!0)},appendChild:function(t,e){t&&(t.isolation(),e||0==this.length?this.insertOperation(t,this.length):this.insertBefore(t,this.map[0]))},insertOperation:function(t,e){this.length++,this.hashMap[t.getId()]=e,this.map[e]=t,t.setParentNode(this),t.invisible()},getChild:function(t){return this.map[t]},getElementById:function(t){return this.map[this.hashMap[t]]},clean:function(){for(var t=0;t<this.length;t++)this.map[t].clean()}},y(t,K),t}(),Q=function(){var t=function(t,e){this.key=t,this.ownerTable=e,this.myParent=null,this.node=null,this.id="hc6|"+e.getId()+"|"+t};return t.prototype={invisible:function(){this.node},getParentNode:function(){return this.myParent},setParentNode:function(t){this.myParent=t},isolation:function(){this.myParent&&this.myParent.removeChild(this)},isSonOf:function(t){return this.myParent==t},getKey:function(){return this.key},getId:function(){return this.id},element:function(){if(null!=this.node)return this.node;this.node=this.ownerTable.getTemplateClone(),this.node.setAttribute("id",this.id);for(var t=A.getLSTags(this.node,this.ownerTable.getNodeTypes()),e=0;e<t.length;e++){var i=t[e],s=i.getField();s&&this.ownerTable.onNewCell(i,this.key,s)}return this.node},clean:function(){this.node&&delete this.node}},t}(),X=function(){var t=I.getLoggerProxy("lightstreamer.grids"),e="No cell defined for this field",i=1200,s=function(){this.cellsGrid=arguments[0],this.updatingRow=arguments[1],this.key=arguments[2],this.coldToHotTime=0,this.hotToColdTime=0,this.hotTime=i,this.hotRowStyle=null,this.coldRowStyle=null};return s.prototype={getCellValue:function(t,i){var s=this.cellsGrid.getCell(this.key,t,i);if(!s)throw new x(e);return s.isCell||(s=s[0]),s.getNextFormattedValue()||s.retrieveValue()},setCellValue:function(t,i,s){var n=this.cellsGrid.getCell(this.key,t,s);if(!n)throw new x(e);if(n.isCell)n.setNextFormattedValue(i);else for(var r=0;r<n.length;r++)n[r].setNextFormattedValue(i)},getChangedFieldValue:function(t){return this.updatingRow[t]||null},setHotTime:function(t){this.hotTime=this.checkPositiveNumber(t,!0)},setColdToHotTime:function(t){this.coldToHotTime=this.checkPositiveNumber(t,!0)},setHotToColdTime:function(t){this.hotToColdTime=this.checkPositiveNumber(t,!0)},addStyle:function(t,i,s,n,r){var a=this.cellsGrid.getCell(this.key,t,r);if(!a)throw new x(e);if(a.isCell)a.addStyle(i,s,n);else for(var o=0;o<a.length;o++)a[o].addStyle(i,s,n)},addRowStyle:function(t,e,i){this.hotRowStyle||(this.hotRowStyle={},this.coldRowStyle={}),this.hotRowStyle[i]=t||"",this.coldRowStyle[i]=e||""},setAttribute:function(t,e,i){this.addRowStyle(t,e,i)},setStyle:function(t,e){this.addRowStyle(t,e,"CLASS")},setCellAttribute:function(t,e,i,s,n){this.addStyle(t,e,i,s,n)},setCellStyle:function(t,e,i,s){this.addStyle(t,e,i,"CLASS",s)},forEachChangedField:function(e){for(var i in this.updatingRow)try{e(i,this.updatingRow[i])}catch(e){t.logError("Exception thrown while executing the iterator Function",e)}}},s.prototype.getCellValue=s.prototype.getCellValue,s.prototype.setCellValue=s.prototype.setCellValue,s.prototype.getChangedFieldValue=s.prototype.getChangedFieldValue,s.prototype.setHotTime=s.prototype.setHotTime,s.prototype.setColdToHotTime=s.prototype.setColdToHotTime,s.prototype.setHotToColdTime=s.prototype.setHotToColdTime,s.prototype.setAttribute=s.prototype.setAttribute,s.prototype.setStyle=s.prototype.setStyle,s.prototype.setCellAttribute=s.prototype.setCellAttribute,s.prototype.setCellStyle=s.prototype.setCellStyle,s.prototype.forEachChangedField=s.prototype.forEachChangedField,y(s,C,!0,!0),s}(),Z=function(){var t=I.getLoggerProxy("weswit.test"),e=0,i={},s={VOID:i,getFailures:function(){return e},compareArrays:function(e,i,s){if(e.length!=i.length)return this.failInternal(),t.logError("Wong length!",e,i),!1;if(s){for(r=0;r<e.length;r++)if(e[r]!=i[r])return t.logError("Wrong  element",e[r],i[r]),this.failInternal(),!1}else{for(var n={},r=0;r<e.length;r++)n[e[r]]=1;for(var r=0;r<i.length;r++){if(!n[i[r]])return t.logError("Missing from first array",i[r]),this.failInternal(),!1;n[i[r]]++}for(var r in n)if(1==n[r])return t.logError("Missing from second array",n[r]),this.failInternal(),!1}return!0},verifySuccess:function(t,e,i,s,n){return this.verify(t,e,i,s,!1,n)},verifyException:function(t,e,i){return this.verify(t,e,i,null,!0)},verifyNotNull:function(e){return null!==e||(this.failInternal(),t.logError("Not expecting a NULL",e),!1)},verifyValue:function(e,i,s){var n=!1;if(!0===s)n=e===i;else if(s)n=s(e,i);else if(isNaN(e))n=e==i;else{var r=e&&e.charAt?e.charAt(0):null,a=i&&i.charAt?i.charAt(0):null;n="."==r||" "==r||"0"==r||"."==a||" "==a||"0"==a?String(e)==String(i):e==i}return!!n||(this.failInternal(),t.logError("Expecting a different value",e,i),!1)},verifyDiffValue:function(e,i,s){return!!(s?e!==i:e!=i)||(this.failInternal(),t.logError("Expecting 2 different values",e,i),!1)},verifyOk:function(e){return!!e||(this.failInternal(),t.logError("Expecting a valid value"),!1)},verifyNotOk:function(e){return!e||(this.failInternal(),t.logError("Expecting a not valid value"),!1)},fail:function(){return t.logError("ASSERT failed"),this.failInternal(),!1},failInternal:function(){e++},verify:function(e,s,n,r,a,o){var h=!1,l=null,u=null;try{l=n!==i?e[s].apply(e,n):e[s]()}catch(t){h=!0,u=t}var c=a?"succes":"failure";return a==h?!(!a&&r!==i)||this.verifyValue(l,r,o):(this.failInternal(),t.logError("Unexpected",c,"for",s,n,r,u),!1)}};return s.getFailures=s.getFailures,s.fail=s.fail,s.verifyNotOk=s.verifyNotOk,s.verifyOk=s.verifyOk,s.verifyDiffValue=s.verifyDiffValue,s.verifyNotNull=s.verifyNotNull,s.verifyValue=s.verifyValue,s.verifyException=s.verifyException,s.verifySuccess=s.verifySuccess,s.compareArrays=s.compareArrays,s}(),J=function(){w.browserDocumentOrDie();var t="ELEMENT",e="PAGE",i="OFF",s="The given value is not a valid scroll type. Admitted values are OFF, ELEMENT, PAGE",n="No template defined",r="The template defined for the grid does not define the 'data-source' attribute",a="No valid cells defined for grid",o="This grid is configured to no support pagination",h="Can't switch pages while 'no-page mode' is used",l="Please specify an element id in order to use ELEMENT autoscroll",u=I.getLoggerProxy("lightstreamer.grids"),c=function(t,e){this._callSuperConstructor(c,[t]),this.pageNumber=1,this.currentPages=0,this.autoScrollElement=null,this.autoScrollType=i,this.initDOM(),(e=this.checkBool(e,!0))&&this.parseHtml()};return c.prototype={toString:function(){return["[",this.id,this.rowCount,this.currentPages,"]"].join("|")},setMaxDynaRows:function(t){t&&"unlimited"!=new String(t).toLowerCase()?this.maxRow=this.checkPositiveNumber(t,!0):this.maxRow=0,this.updateIsKey()?this.limitRows():(this.calculatePages(),this.sortTable(),this.changePage(1))},getMaxDynaRows:function(){return 0==this.maxRow?"unlimited":this.maxRow},goToPage:function(t){if(this.updateIsKey())throw new b(o);if(0==this.maxRow)throw new b(h);t=this.checkPositiveNumber(t),this.changePage(t)},getCurrentPages:function(){return 0==this.maxRow?1:this.currentPages},setAutoScroll:function(n,r){if(!n)throw new x(s);if((n=new String(n).toUpperCase())==t){if(!r)throw new x(l);this.autoScrollElement=r}else if(n!=e&&n!=i)throw new x(s);this.autoScrollType=n,this.prepareAutoScroll()},parseHtml:function(){this.parsed=!0;var t=this.clonedNode;if(t){if(A.isAttachedToDOM(t))return!0;this.initDOM()}if(t=document.getElementById(this.id),!this.templateControl(t))return!1;this.template=t.cloneNode(!0),this.template.removeAttribute("id"),this.clonedNode=t;var e=t.parentNode;this.nodeContainer=e,t.style.display="none";var i=e.childNodes,s=0,n=0,r=null;for(s=0;s<i.length;s++)if(i[s]==t){i[s+1]&&(r=i[s+1]),n=s+1;break}return this.clonedContainer=new z(e,r,n),this.nextParent=new j,this.prevParent=new j,!0},computeFieldSymbolsSet:function(t){for(var e=this.clonedNode,i=A.getLSTags(e,this.tagsToCheck),s={},n=0;n<i.length;n++)if(i[n].getFieldType()==t){var r=i[n].getField();r&&(s[r]=!0)}return s},templateControl:function(t){if(!t)throw new x(n);if(!A.verifyTag(t))throw new x(r);for(var e=[],i=A.getLSTags(t,this.tagsToCheck),s=0;s<i.length;s++)i[s].getField()&&e.push(i[s]);if(e.length<=0)throw new x(a);return!0},prepareAutoScroll:function(){if(this.autoScrollType==t)if(this.autoScrollElement&&this.autoScrollElement.appendChild);else{var e=document.getElementById(this.autoScrollElement);e?this.autoScrollElement=e:(u.logError("Cannot find the scroll element",this),this.autoScrollType=i)}},initDOM:function(){this.clonedNode=null,this.template=null,this.nodeContainer=null,this.clonedContainer=null,this.nextParent=null,this.prevParent=null,this.clonesArray={}},getTemplateClone:function(){return this.template.cloneNode(!0)},onNewCell:function(t,e,i){this.grid.addCell(t,e,i)},clean:function(){this._callSuperMethod(c,"clean")},willAutoScroll:function(){if(this.autoScrollType==i)return!1;if(this.updateIsKey()){var e=this.autoScrollType==t?this.autoScrollElement:document.body;return this.addOnTop?0==e.scrollTop:!!L.isProbablyOldOpera()||Math.abs(e.clientHeight+e.scrollTop-e.scrollHeight)<=1}return!0},getNewScrollPosition:function(t){var i=this.autoScrollType==e?document.body:this.autoScrollElement;return this.updateIsKey()?this.addOnTop?0:i.scrollHeight-i.clientHeight:t.offsetTop-i.offsetTop},doAutoScroll:function(t){u.isDebugLogEnabled()&&u.logDebug("Perform auto-scroll",this,t),this.autoScrollType==e?window.scrollTo(0,t):this.autoScrollElement.scrollTop=t},sortTable:function(){for(var t=this.sortField,e=new j,i=1;this.rowCount>0;){var s=this.getNodeByIndex(i);if(s)if(null!=t){var n=s.getKey();if(""!=n){for(var r=this.makeSortValue(this.values.get(n,this.sortField)),a=0,o=e.length-1;a<o;){var h=Math.floor((a+o)/2),l=e.getChild(h),c=this.makeSortValue(this.values.get(l.getKey(),this.sortField));c||u.logWarn("Can't find value for sort key field",this),this.isBefore(r,c)?o=h-1:a=h+1}if(l=e.getChild(a),a==o){var d=this.makeSortValue(this.values.get(l.getKey(),this.sortField));if(this.isBefore(r,d))e.insertBefore(s,l);else{var _=e.getChild(o+1);_?e.insertBefore(s,_):e.appendChild(s,!0)}}else l?e.insertBefore(s,l):e.appendChild(s,!0);this.rowCount--}else this.rowCount--,i++}else e.appendChild(s,!0),this.rowCount--;else this.rowCount--,i++}for(var p=0;p<e.length;){this.rowCount++;var f=e.getChild(p);this.rowCount<=this.maxRow*(this.pageNumber-1)?this.prevParent.appendChild(f,!0):this.maxRow<=0||this.rowCount<=this.maxRow*this.pageNumber?this.clonedContainer.appendChild(f,!0):this.nextParent.appendChild(f,!0)}},changePage:function(t){if(!(this.rowCount<=0)){if(this.pageNumber>=t)for(;this.shiftDown(this.prevParent,this.clonedContainer,(t-1)*this.maxRow);)this.shiftDown(this.clonedContainer,this.nextParent,this.maxRow);else for(;this.fitFreeSpace(this.clonedContainer,this.prevParent,(t-1)*this.maxRow,!1);)this.fitFreeSpace(this.nextParent,this.clonedContainer,this.maxRow,!1);this.pageNumber=t}},calculatePages:function(){u.isDebugLogEnabled()&&u.logDebug("Calculate number of pages",this);var t=0;return t=this.maxRow<=0?1:Math.ceil(this.rowCount/this.maxRow),this.currentPages!=t&&(this.currentPages=t,this.dispatchEvent("onCurrentPagesChanged",[this.currentPages])),t},removeRowExecution:function(t){var e=this.clonesArray[t];if(e){this.rowCount--,this.calculatePages();var i=!1,s=this.prevParent,n=this.nextParent;this.dispatchEvent("onVisualUpdate",[t,null,e.element()]),this.updateIsKey()&&this.addOnTop&&null==this.sortField&&(i=this.addOnTop,s=this.nextParent,n=this.prevParent),e.isSonOf(this.clonedContainer)?(this.clonedContainer.removeChild(e),this.fitFreeSpace(n,this.clonedContainer,this.maxRow,i)):e.isSonOf(n)?n.removeChild(e):(this.prevParent.removeChild(e),this.fitFreeSpace(this.clonedContainer,s,this.maxRow*(this.pageNumber-1),i)&&this.fitFreeSpace(n,this.clonedContainer,this.maxRow,i)),this.grid.delRow(t),delete this.clonesArray[t]}},updateRowExecution:function(t,e){var i=!1,s=this.clonesArray[t];s||(s=new Q(t,this),this.clonesArray[t]=s,s.element()),Z.verifyOk(s),this.fillFormattedValues(t,e);var n=this.dispatchVisualUpdateEvent(t,e,s),r=this.willAutoScroll(),a=!this.values.getRow(t),o=null!=this.sortField?this.makeSortValue(this.values.get(t,this.sortField)):null,h=null!=this.sortField?this.makeSortValue(e[this.sortField]):null,l=o==h||!e[this.sortField]&&null!==e[this.sortField];if(null!=this.sortField&&0==l){var u=this.calculateSortedPosition(s,o,h);this.insertNodeAtIndex(u,s),a&&(this.rowCount++,i=!0)}else a&&(this.appendNode(s,!this.addOnTop),this.rowCount++,i=!0);if(this.visualUpdateExecution(t,n),this.updateInProgress=null,a&&this.updateIsKey()&&this.limitRows(),r&&s.isSonOf(this.clonedContainer)){var c=this.getNewScrollPosition(s.element());this.doAutoScroll(c)}i&&this.calculatePages()},dispatchVisualUpdateEvent:function(t,e,i){this.currentUpdateKey=t,this.currentUpdateValues=e;var s=new X(this.grid,e,t);return this.dispatchEvent("onVisualUpdate",[t,s,i.element()]),this.currentUpdateKey=null,this.currentUpdateValues=null,s},calculateSortedPosition:function(t,e,i){for(var s=1,n=this.rowCount,r=-1;s<n;){var a=null;(r=Math.floor((s+n)/2))<=this.rowCount&&(a=(o=this.getNodeByIndex(r))==t?e:this.makeSortValue(this.values.get(o.getKey(),this.sortField))),this.isBefore(i,a)?n=r-1:s=r+1}if(s==n){var o=this.getNodeByIndex(s),h=this.makeSortValue(this.values.get(o.getKey(),this.sortField));return this.isBefore(i,h)?s:s+1}return s},getNodeByIndex:function(t){return t>this.rowCount||t<=0?null:t<=this.prevParent.length?this.prevParent.getChild(t-1):(t-=this.prevParent.length)<=this.clonedContainer.length?this.clonedContainer.getChild(t-1):(t-=this.clonedContainer.length,this.nextParent.getChild(t-1))},appendNode:function(t,e){var i=e?this.prevParent:this.nextParent,s=e?this.nextParent:this.prevParent;return s.length>0||this.clonedContainer.length==this.maxRow&&this.maxRow>0?(s.appendChild(t,e),s):this.clonedContainer.length>0||i.length==this.maxRow*(this.pageNumber-1)?(this.clonedContainer.appendChild(t,e),this.clonedContainer):(i.appendChild(t,e),i)},insertNodeAtIndex:function(t,e){if(!(t>this.rowCount+1||t<=0)&&e!=this.getNodeByIndex(t)){var i,s=e.getParentNode(),n=this.clonedContainer,r=this.nextParent,a=this.prevParent,o=this.getNodeByIndex(t);null==o?i=this.appendNode(e,!0):(i=o.getParentNode()).insertBefore(e,o),i==n?s&&s!=r?s==a&&this.fitFreeSpace(n,a,this.maxRow*(this.pageNumber-1),!1):this.shiftDown(n,r,this.maxRow):i==a?s!=a&&this.shiftDown(a,n,this.maxRow*(this.pageNumber-1))&&this.shiftDown(n,r,this.maxRow):i==r&&(s==a&&this.fitFreeSpace(n,a,this.maxRow*(this.pageNumber-1),!1),this.fitFreeSpace(r,n,this.maxRow,!1))}},fitFreeSpace:function(t,e,i,s){if(this.maxRow<=0)return!1;if(e.length<i&&t.length>0){var n=t.getChild(0);return e.appendChild(n,!s),!0}return!1},shiftDown:function(t,e,i){if(this.maxRow<=0)return!1;if(t.length>i){var s=t.getChild(t.length-1);return e.insertBefore(s,e.getChild(0)),!0}return!1},limitRows:function(){for(;this.maxRow>0&&this.rowCount>this.maxRow;)this.removeRow(this.getOldestKey())},addListener:function(t){this._callSuperMethod(c,"addListener",[t])},removeListener:function(t){this._callSuperMethod(c,"removeListener",[t])},getListeners:function(){return this._callSuperMethod(c,"getListeners")}},c.prototype.setMaxDynaRows=c.prototype.setMaxDynaRows,c.prototype.getMaxDynaRows=c.prototype.getMaxDynaRows,c.prototype.goToPage=c.prototype.goToPage,c.prototype.getCurrentPages=c.prototype.getCurrentPages,c.prototype.setAutoScroll=c.prototype.setAutoScroll,c.prototype.parseHtml=c.prototype.parseHtml,c.prototype.clean=c.prototype.clean,c.prototype.addListener=c.prototype.addListener,c.prototype.removeListener=c.prototype.removeListener,c.prototype.getListeners=c.prototype.getListeners,c.prototype.updateRowExecution=c.prototype.updateRowExecution,c.prototype.removeRowExecution=c.prototype.removeRowExecution,y(c,G),c}(),$=function(){var t=function(t,e){this.xSpan=t||60,e=(e||20)/100,this.moreY=1+e,this.lessY=1-e,this.handledLines=new M,this.minY,this.maxY};return t.prototype={onListenStart:function(t){this.chartTable=t},onYOverflow:function(t,e,i,s,n){var r=(n-s)/2;if(i>n){var a=n+r;i>a&&(a=i),this.maxY=a,this.updateYAxis(s,a)}else if(i<s){var o=s-r;i<o&&(o=i),this.minY=o,this.updateYAxis(o,n)}},onXOverflow:function(t,e,i,s){if(e>s){var n=(s+i)/2,r=s-i;this.chartTable.positionXAxis(n,n+r)}},onNewLine:function(t,e,i,s){this.chartTable.positionXAxis(i,i+this.xSpan);var n=s*this.lessY,r=s*this.moreY;this.handledLines.add(e),this.minY=null!==this.minY&&this.minY<=n?this.minY:n,this.maxY=null!==this.maxY&&this.maxY>=r?this.maxY:r,this.updateYAxis(this.minY,this.maxY)},onRemovedLine:function(t,e){this.handledLines.remove(e)},updateYAxis:function(t,e){this.handledLines.forEach((function(i){i.positionYAxis(t,e)}))}},t.prototype.onListenStart=t.prototype.onListenStart,t.prototype.onYOverflow=t.prototype.onYOverflow,t.prototype.onXOverflow=t.prototype.onXOverflow,t.prototype.onNewLine=t.prototype.onNewLine,t.prototype.onRemovedLine=t.prototype.onRemovedLine,t}(),tt=function(){var t=0,e=function(e,i,s,n,r){this.ownerGrid=e,this.key=i,this.field=s,this.num=n||null,this.noNumIndex=r,this.cellId="s"+t++};return e.prototype={getCurrentCell:function(){var t=this.ownerGrid.getCellByKey(this.key,this.field,this.num);if(!t)return null;if(t.isCell){if(this.num===t.getNum()&&this.noNumIndex<=0)return t}else for(var e=-1,i=0;i<t.length;i++){var s=t[i].getNum();if(null===s&&e++,this.num===s&&this.noNumIndex==e)return t[i]}return null},incFadePhase:function(){var t=this.getCurrentCell();return t?t.incFadePhase():null},getCellId:function(){return this.cellId},getFadePhase:function(){var t=this.getCurrentCell();return t?t.getFadePhase():null},getEl:function(){var t=this.getCurrentCell();return t?t.getEl():null},asynchUpdateStyles:function(t,e){var i=this.getCurrentCell();i&&i.asynchUpdateStyles(t,e)},asynchUpdateValue:function(t,e){var i=this.getCurrentCell();i&&i.asynchUpdateValue(t,e)}},e}(),et=function(){function t(t){return null!=t}function e(e,i,s){var n=e[s];t(n)&&(delete e[s],delete i[n])}function i(e,i,n,r){if(!t(n)||!t(r))throw new x("values can't be null nor missing");var a=e[n],o=i[r];if(t(a)){if(a===r)return;t(o)?(e[o]=a,e[n]=r,i[r]=n,i[a]=o):s(e,i,n,r)}else t(o)?s(i,e,r,n):(e[n]=r,i[r]=n)}function s(t,e,i,s){delete e[t[i]],t[i]=s,e[s]=i}function n(t,e){for(var i in t)e(i,t[i])}var r=function(){this.map={},this.reverseMap={}};return r.prototype={set:function(t,e){i(this.map,this.reverseMap,t,e)},remove:function(t){e(this.map,this.reverseMap,t)},removeReverse:function(t){e(this.reverseMap,this.map,t)},get:function(t){return this.map[t]},getReverse:function(t){return this.reverseMap[t]},exist:function(t){return void 0!==this.get(t)},existReverse:function(t){return void 0!==this.getReverse(t)},forEach:function(t){n(this.map,t)},forEachReverse:function(t){n(this.reverseMap,t)}},r.prototype.set=r.prototype.set,r.prototype.remove=r.prototype.remove,r.prototype.removeReverse=r.prototype.removeReverse,r.prototype.get=r.prototype.get,r.prototype.getReverse=r.prototype.getReverse,r.prototype.exist=r.prototype.exist,r.prototype.existReverse=r.prototype.existReverse,r.prototype.forEach=r.prototype.forEach,r.prototype.forEachReverse=r.prototype.forEachReverse,r}(),it=function(){w.browserDocumentOrDie();var t="The given cell is null or undefined",e="The cell does not belong to the Grid",i="The given root element is not valid",s="Can't extract schema from cells declared with the data-row property; use data-item instead.",n="Can't mix data-item and data-row declarations on the same grid",r="Please specify at least one cell";function a(t,e,i){var s=t[e];t[e]=t[i],t[i]=s}var o=I.getLoggerProxy("lightstreamer.grids"),h=function(t,e,i,s){this._callSuperConstructor(h,[t]),this.explicitSetting=!1,this.rootEl=null,this.setRootNode(i||document),this.tableCells=[],s&&this.addCell(s),this.keyRowMap=new et,this.usingItems=null,(e=this.checkBool(e,!0))&&this.parseHtml()};return h.prototype={toString:function(){return["[",this.id,"]"].join("|")},addCell:function(i){if(!i)throw new x(t);if(T.isArray(i))for(var s=0;s<i.length;s++)this.addCell(i[s]);else{var n=new A(i),r=n.getTable();if(!r||r!=this.id)throw new x(e);this.explicitSetting=!0,this.tableCells.push(n)}},setRootNode:function(t){if(!t||!t.getElementsByTagName)throw new x(i);this.rootEl=t},extractItemList:function(){if(this.checkParsed(),!1===this.usingItems)throw new b(s);var t=this.computeItemSymbolsSet(),e=[];for(var i in t)e.push(i);return e},parseHtml:function(){var t;this.parsed=!0,this.grid.cellsGarbageCollection(),this.explicitSetting?(t=this.tableCells,this.tableCells=[]):t=A.getLSTags(this.rootEl,this.tagsToCheck);for(var e=0;e<t.length;e++){var i=t[e].getTable();if(i&&i==this.id){var s=t[e].getRow();if(s){if(isNaN(s)||(s=Number(s)),null===this.usingItems)this.usingItems=isNaN(s);else if(this.usingItems!=isNaN(s))throw b(n);this.usingItems||(this.maxRow=s>this.maxRow?s:this.maxRow),t[e].getField()&&(this.grid.alreadyInList(t[e])||this.grid.addCell(t[e]))}}}if(this.grid.isEmpty())throw new b(r)},computeFieldSymbolsSet:function(t){var e={};return this.grid.forEachCell((function(i,s,n){i.getFieldType()==t&&(e[n]=!0)})),e},computeItemSymbolsSet:function(){var t={};return this.grid.forEachRow((function(e){t[e]=!0})),t},updateRowExecution:function(t,e){var i,s=!this.values.getRow(t);if(this.usingItems)i=t;else{var n=null!=this.sortField?this.makeSortValue(this.values.get(t,this.sortField)):null,r=null!=this.sortField?this.makeSortValue(e[this.sortField]):null,a=n==r||void 0===e[this.sortField];if(i=null!=this.sortField&&0==a?this.calculateSortedPosition(t,n,r):s?this.addOnTop?1:this.updateIsKey()&&this.rowCount==this.maxRow?this.rowCount:this.rowCount+1:this.keyRowMap.get(t),this.updateIsKey()&&this.maxRow==this.rowCount&&s&&null!=this.sortField){var o=this.getOldestKey(),h=this.scrollOut(o);h<i&&i--,this.keyRowMap.set(t,h),this.rowCount++,s=!1}this.keyRowMap.existReverse(i)&&this.keyRowMap.getReverse(i)!=t&&this.makeRoom(i,t),this.keyRowMap.set(t,i)}if(s&&this.rowCount++,!this.updateIsKey()&&i>this.maxRow&&!this.grid.getRow(i)){var l=this.grid.getRow(i-1),u=W.scrollRow(l,null,this.useInner);this.grid.insertRow(u,i)}this.fillFormattedValues(i,e);var c=this.dispatchVisualUpdateEvent(t,i,e);this.visualUpdateExecution(i,c,t)},dispatchVisualUpdateEvent:function(t,e,i){this.currentUpdateKey=e,this.currentUpdateValues=i;var s=new X(this.grid,i,e);return this.dispatchEvent("onVisualUpdate",[t,s,e]),this.currentUpdateKey=null,this.currentUpdateValues=null,s},getSlidingCell:function(t,e,i,s,n){return this.usingItems?t:new tt(this,e,i,s,n)},getCellByKey:function(t,e,i){var s=this.keyRowMap.get(t);return this.grid.getCell(s,e,i)},removeRowExecution:function(t){var e=this.usingItems?t:this.keyRowMap.get(t);this.dispatchEvent("onVisualUpdate",[t,null,e]),this.usingItems||(e!=this.rowCount&&(this.makeRoom(this.rowCount,t),e=this.keyRowMap.get(t)),Z.verifyValue(this.rowCount,e)||o.logError("Unexpected position of row to be wiped")),this.grid.forEachCellInRow(e,(function(t){t.clean()})),this.rowCount--,this.usingItems||this.keyRowMap.remove(t)},scrollOut:function(t){var e=this.keyRowMap.get(t);return this.keyRowMap.remove(t),this.rowCount--,this.values.delRow(t),this.updateIsKey()&&this.removeFromFifo(t),e},makeRoom:function(t,e){var i=this.keyRowMap.get(e);if(t!=i){var s,n,r,a=i?W.scrollRow(this.grid.getRow(i),null,this.useInner):null,o=i?this.keyRowMap.getReverse(i):null;i?i>t?(n=i-1,r=t,s=-1):(n=i+1,r=t,s=1):null!=this.sortField||this.addOnTop?(r=t,n=this.rowCount,s=-1):(n=1,r=t,s=1);for(var h=n;h-s!=r;h+=s){var l=h-s,u=this.grid.getRow(h),c=this.grid.getRow(l);if(c||this.updateIsKey()||(c={},this.grid.insertRow(c,l),Z.verifyNotOk(i)),c)W.scrollRow(u,c,this.useInner),d=this.keyRowMap.getReverse(h),this.keyRowMap.set(d,l);else{Z.verifyOk(this.updateIsKey()),Z.verifyValue(h,n);var d=this.keyRowMap.getReverse(h);this.scrollOut(d)}}a?(W.scrollRow(a,this.grid.getRow(t),this.useInner),this.keyRowMap.set(o,t)):this.grid.forEachCellInRow(t,(function(t){t.clean()}))}},calculateSortedPosition:function(t,e,i){for(var s=1,n=this.rowCount,r=-1;s<n;){var a=null;(r=Math.floor((s+n)/2))<=this.rowCount&&(a=(o=this.keyRowMap.getReverse(r))==t?e:this.makeSortValue(this.values.get(o,this.sortField))),this.isBefore(i,a)?n=r-1:s=r+1}if(s==n){var o=this.keyRowMap.getReverse(s),h=this.makeSortValue(this.values.get(o,this.sortField));return this.isBefore(i,h)?s:s+1}return s},partition:function(t,e,i,s){var n=this.makeSortValue(this.values.get(t[s],this.sortField));a(t,i,s);for(var r=e,o=e;o<i;o++){var h=this.makeSortValue(this.values.get(t[o],this.sortField));this.isBefore(n,h)||(a(t,o,r),r++)}return a(t,r,i),r},quickSort:function(t,e,i){if(e<i){var s=Math.round(e+(i-e)/2),n=this.partition(t,e,i,s);this.quickSort(t,e,n-1),this.quickSort(t,n+1,i)}},sortTable:function(){if(!this.usingItems){var t={};this.keyRowMap.forEachReverse((function(e,i){t[e]=i})),this.quickSort(t,1,this.rowCount);var e={},i=new et;for(var s in t){i.set(t[s],s);var n=this.keyRowMap.getReverse(s);if(t[s]!=n){var r=this.grid.getRow(s);e[n]=W.scrollRow(r,null,this.useInner);var a=t[s],o=e[a]?e[a]:this.grid.getRow(this.keyRowMap.get(a));W.scrollRow(o,r,this.useInner)}}this.keyRowMap=i}},addListener:function(t){this._callSuperMethod(h,"addListener",[t])},removeListener:function(t){this._callSuperMethod(h,"removeListener",[t])},getListeners:function(){return this._callSuperMethod(h,"getListeners")}},h.prototype.addCell=h.prototype.addCell,h.prototype.setRootNode=h.prototype.setRootNode,h.prototype.extractItemList=h.prototype.extractItemList,h.prototype.parseHtml=h.prototype.parseHtml,h.prototype.addListener=h.prototype.addListener,h.prototype.removeListener=h.prototype.removeListener,h.prototype.getListeners=h.prototype.getListeners,h.prototype.updateRowExecution=h.prototype.updateRowExecution,h.prototype.removeRowExecution=h.prototype.removeRowExecution,y(h,G),h}(),st=function(){w.browserDocumentOrDie();var t="The given value is not valid. Admitted values are no, left and right",e="The given value is not valid. Admitted values are open, closed and dyna",i=L.isProbablyIE(6,!0);function s(){var t=E("div");return y(t,{textAlign:"center",textOverflow:"ellipsis",fontFamily:"Arial, Helvetica, sans-serif",fontSize:"10px",color:"#333333",verticalAlign:"middle",paddingTop:"3px",width:"32px",height:"32px",display:"none"}),t.innerHTML=u,t}function n(t){var e=E("img");return e.src=t,y(e,{display:"none",width:"28px",height:"28px"}),e}var r=n("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyBpZD0iTGl2ZWxsb18xIiBkYXRhLW5hbWU9IkxpdmVsbG8gMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmlld0JveD0iMCAwIDEyNi4xMDgxIDE2OS41MzgiPgogIDxkZWZzPgogICAgPGxpbmVhckdyYWRpZW50IGlkPSJTZnVtYXR1cmFfc2VuemFfbm9tZV83NyIgZGF0YS1uYW1lPSJTZnVtYXR1cmEgc2VuemEgbm9tZSA3NyIgeDE9IjUxLjQ2MTMiIHkxPSI3NC4wMDIyIiB4Mj0iLTM3LjgyMjkiIHkyPSI0OC43MTM2IiBncmFkaWVudFRyYW5zZm9ybT0idHJhbnNsYXRlKDYwLjE5MDkgMTEuNjQ2OCkgcm90YXRlKC0zLjc0MTUpIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CiAgICAgIDxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iI2ZmZiIvPgogICAgICA8c3RvcCBvZmZzZXQ9Ii4xNjQyIiBzdG9wLWNvbG9yPSIjZmZmIiBzdG9wLW9wYWNpdHk9Ii45NzQzIi8+CiAgICAgIDxzdG9wIG9mZnNldD0iLjM5NTMiIHN0b3AtY29sb3I9IiNmZmYiIHN0b3Atb3BhY2l0eT0iLjkwMjQiLz4KICAgICAgPHN0b3Agb2Zmc2V0PSIuNjY2IiBzdG9wLWNvbG9yPSIjZmZmIiBzdG9wLW9wYWNpdHk9Ii43ODQzIi8+CiAgICAgIDxzdG9wIG9mZnNldD0iLjk2NDciIHN0b3AtY29sb3I9IiNmZmYiIHN0b3Atb3BhY2l0eT0iLjYyMTMiLz4KICAgICAgPHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjZmZmIiBzdG9wLW9wYWNpdHk9Ii42Ii8+CiAgICA8L2xpbmVhckdyYWRpZW50PgogICAgPGxpbmVhckdyYWRpZW50IGlkPSJTZnVtYXR1cmFfc2VuemFfbm9tZV83Ny0yIiBkYXRhLW5hbWU9IlNmdW1hdHVyYSBzZW56YSBub21lIDc3IiB4MT0iMzcuNzUzMyIgeTE9Ijk1LjkzMiIgeDI9Ii01MS40MDQyIiB5Mj0iNzAuNjc5MyIgeGxpbms6aHJlZj0iI1NmdW1hdHVyYV9zZW56YV9ub21lXzc3Ii8+CiAgICA8bGluZWFyR3JhZGllbnQgaWQ9IlNmdW1hdHVyYV9zZW56YV9ub21lXzc3LTMiIGRhdGEtbmFtZT0iU2Z1bWF0dXJhIHNlbnphIG5vbWUgNzciIHgxPSItNjMuNjgwNCIgeTE9IjM1LjE3NiIgeDI9IjU1Ljc4NTgiIHkyPSIzNS4xNzYiIHhsaW5rOmhyZWY9IiNTZnVtYXR1cmFfc2VuemFfbm9tZV83NyIvPgogICAgPGxpbmVhckdyYWRpZW50IGlkPSJTZnVtYXR1cmFfc2VuemFfbm9tZV83Ny00IiBkYXRhLW5hbWU9IlNmdW1hdHVyYSBzZW56YSBub21lIDc3IiB4MT0iLTYwLjk2MjMiIHkxPSIxMDUuNjEzIiB4Mj0iNTguNTA0OCIgeTI9IjEwNS42MTMiIHhsaW5rOmhyZWY9IiNTZnVtYXR1cmFfc2VuemFfbm9tZV83NyIvPgogIDwvZGVmcz4KICA8ZyBpZD0ibG9nb01hcmsiPgogICAgPGEgeGxpbms6aHJlZj0iYWRpZW50Ij4KICAgICAgPHBhdGggaWQ9ImxvZ29NYXJrX19QYXRoSXRlbV8iIGRhdGEtbmFtZT0ibG9nb01hcmsgJmFtcDtsdDtQYXRoSXRlbSZhbXA7Z3Q7IiBkPSJNMTExLjkxODMsNjguNDEyMWMtOS4wNzU2LTkuNDUyNy0yMi45ODk1LTExLjc1NDUtMzcuNzI4OS03LjY1ODFsLTE0LjY0NzMsNC4wNDUyYy02LjYyOCwxLjg0MTYtMTIuMzk5Mi0yLjEzMDktMTIuODY2OS04Ljg1NDctLjQ2NzctNi43MjM3LDQuNTQyNi0xMy42ODk1LDExLjE3MDYtMTUuNTMxMSwwLDAtMTQuNTk1Niw0LjA1NTktMjIuODQxOCw2LjM0NzUtMS42NDQ4LDQuMTcyMi0yLjQ0MjcsOC42MTk5LTIuMTM2NSwxMy4wMjEzLDEuMDA0OSwxNC40NDc1LDEzLjE5MTcsMTkuODY3NCwyNy40MzIzLDE1LjkxMTFsMTAuMDQ0Ni0yLjc2NjFjMzMuNzg5NS05LjM4OTEsNDIuOTM4OCwxOS43NjM3LDM2LjY0NjUsMzYuNDAxOCwxMi4yMTM2LTEwLjE5ODgsMTUuMzA1Ni0yNy44NTc0LDQuOTI3NC00MC45MTY5WiIgc3R5bGU9ImZpbGw6IHVybCgjU2Z1bWF0dXJhX3NlbnphX25vbWVfNzcpOyIvPgogICAgPC9hPgogICAgPGEgeGxpbms6aHJlZj0iYWRpZW50Ij4KICAgICAgPHBhdGggaWQ9ImxvZ29NYXJrX19QYXRoSXRlbV8tMiIgZGF0YS1uYW1lPSJsb2dvTWFyayAmYW1wO2x0O1BhdGhJdGVtJmFtcDtndDsiIGQ9Ik02NS42NTQ4LDg3Ljk5MzlsLTE0LjY0NjksNC4wNDY1Yy0xNS4zOTc0LDQuMjc4MS0zOS43MTM3LTMuMDcxNC0zNy41Mzc2LTMzLjM0MTktOC44MTIyLDEwLjQwMjMtMTAuMTM1NywyNS40OTQyLS45ODQxLDM3LjAwOTUsOS4zNDA4LDguNDU4NCwyMi45OTk5LDExLjc0OTMsMzcuNzQ1NCw3LjY1MjdsMTQuNjQ3MS00LjA0NTRjNi42MjY2LTEuODQxNCwxMi4zOTg5LDIuMTI5NSwxMi44NjY2LDguODUzMiwuNDY3Nyw2LjcyMzctNC41NDM2LDEzLjY5MjktMTEuMTcwMywxNS41MzQzLC4yODE2LS4wNzkzLDE0LjQ2MDktNC4wMTg5LDIyLjY1NDctNi4yOTQ4LDcuMTc3OS0yMi45ODQyLTYuNjg2Ni0zNC4xMDYtMjMuNTc0OS0yOS40MTQxWiIgc3R5bGU9ImZpbGw6IHVybCgjU2Z1bWF0dXJhX3NlbnphX25vbWVfNzctMik7Ii8+CiAgICA8L2E+CiAgICA8cGF0aCBpZD0ibG9nb01hcmtfX0NvbXBvdW5kUGF0aEl0ZW1fIiBkYXRhLW5hbWU9ImxvZ29NYXJrICZhbXA7bHQ7Q29tcG91bmRQYXRoSXRlbSZhbXA7Z3Q7IiBkPSJNNjcuNTg5OSwxLjc1NWwtMjMuOTY0NSw2LjYzNDNDMTcuODEzOCwxNS41NjA0LTEuNzAzNSw0Mi42OTg0LC4xMTc4LDY4Ljg4MjJjLjc4MDgsMTEuMjI1NCw1LjM1ODYsMjAuNDgxLDEyLjM2ODQsMjYuODI1OUMtLjkzODMsNzguODE1MSw4LjE2MTEsNTQuMjE5LDMwLjQwNzQsNDguMDM4MmM0Ljg1NzMtMS4zNTA0LDI3LjQzODUtNy42MjQ5LDI3LjQzODUtNy42MjQ5bC40MzQ3LS4wOTdjNi42MjY3LTEuODQxNCwxMi4zOTk1LDIuMTI5NCwxMi44NjcxLDguODUzbDQ2LjU1Ni0xMi45MzU4QzExNS44ODI0LDEwLjA0OTYsOTMuNDAxNS01LjQxNzgsNjcuNTg5OSwxLjc1NVptMTcuMzIzMiwzNS40MTU0Yy00Ljc4NTctMTIuMDg5My0xOC4zNjM2LTExLjg0MjctMjUuOTMxMS05LjczODhsLTEuNjY2NCwuNDM3Ni0yNy40NDAxLDcuNjI1Yy0zLjQ0MTUsLjk1NTctNi43NDI2LDIuMjgwMi05Ljg1NywzLjkyMTgsNS44MzI0LTguODQ4LDE0LjY2MTItMTUuODUwMywyNC44MDcyLTE4LjY2OTdsMjMuOTY2MS02LjYzNDZjMTIuODQ1Ny0zLjU2OTEsMjguNTMsMi4wNTE5LDMzLjM0NjQsMTguMjczMWwtMTcuMjI1LDQuNzg1NVoiIHN0eWxlPSJmaWxsOiB1cmwoI1NmdW1hdHVyYV9zZW56YV9ub21lXzc3LTMpOyIvPgogICAgPHBhdGggaWQ9ImxvZ29NYXJrX19Db21wb3VuZFBhdGhJdGVtXy0yIiBkYXRhLW5hbWU9ImxvZ29NYXJrICZhbXA7bHQ7Q29tcG91bmRQYXRoSXRlbSZhbXA7Z3Q7IiBkPSJNMTExLjkxODMsNjguNDEyMWMxMy40MjQ0LDE2Ljg5MjksNC4zMjQ1LDQxLjQ4OS0xNy45MjEzLDQ3LjY3LTQuODU3MywxLjM1MDQtMjcuNDM4Niw3LjYyNDktMjcuNDM4Niw3LjYyNDlsLS40MzQ2LC4wOTY4Yy02LjYyNjgsMS44NDE2LTEyLjM5OTQtMi4xMjkyLTEyLjg2NzEtOC44NTI5TDYuNjk5OSwxMjcuODg2OWMxLjgyMTMsMjYuMTgzOCwyNC4zMDMsNDEuNjUxMSw1MC4xMTQ1LDM0LjQ3ODRsMjMuOTY0NC02LjYzNDJjMjUuODExOS03LjE3MTIsNDUuMzI5Mi0zNC4zMDkzLDQzLjUwNzktNjAuNDkzLS43ODA4LTExLjIyNTQtNS4zNTg4LTIwLjQ4MS0xMi4zNjg0LTI2LjgyNlptLTMyLjAwNTYsNzQuODY4NWwtMjMuOTY0NCw2LjYzNDRjLTEyLjg0NTgsMy41NjkxLTI4LjUzMTctMi4wNTItMzMuMzQ4MS0xOC4yNzNsMTcuMjI1Mi00Ljc4NThjNC43ODU3LDEyLjA4OTYsMTguMzYzNiwxMS44NDMsMjUuOTMyNyw5Ljc0MDNsMS42NjYzLS40MzksMjcuNDM4Ni03LjYyNTFjMy40NDE0LS45NTU0LDYuNzQ0Mi0yLjI3ODcsOS44NTY5LTMuOTIxNy01LjgzMDYsOC44NDk2LTE0LjY1OTQsMTUuODUwNS0yNC44MDcyLDE4LjY2OTlaIiBzdHlsZT0iZmlsbDogdXJsKCNTZnVtYXR1cmFfc2VuemFfbm9tZV83Ny00KTsiLz4KICA8L2c+Cjwvc3ZnPg=="),a=r,o=r,h=!1,l="DATA STREAMING STATUS",u="Net<br/>State",c=0,d=1,_=2,p=3,f="left",m=b("no",f,"right"),g="dyna",v="closed",S=b(g,"open",v);function b(){for(var t={},e=0;e<arguments.length;e++)t[arguments[e]]=!0;return t}function y(t,e){for(var i in e)t.style[i]=e[i]}function E(t){var e=document.createElement(t);return y(e,{backgroundColor:"transparent"}),e}function R(){for(var t=["animationName","WebkitAnimationName","MozAnimationName","OAnimationName","msAnimationName"],e=document.createElement("div").style,i=0;i<t.length;i++)if(void 0!==e[t[i]])return!0;return!1}var I=R(),C=function(s,n,r,a){if(!i){if(this.ready=!1,this.readyStatusOpen=!1,this.cachedStatus=null,this.lsClient=null,!m[s=s||f])throw new x(t);if(!S[a=a||v])throw new x(e);this.isLeftBorder=s===f;var o=r?n:"auto",h=r?"auto":n;this.statusWidgetContainer=E("div");var u=E("div");this.statusTextsContainer=E("div"),y(this.statusWidgetContainer,{zIndex:"99999"}),y(u,{width:"42px",height:"42px",opacity:"0.95",filter:"alpha(opacity=95)",backgroundColor:"#003D06",zIndex:"99999",position:"relative"}),y(this.statusTextsContainer,{width:"245px",height:"42px",backgroundColor:"#E2E2E2",fontFamily:"'Open Sans',Arial,sans-serif",fontSize:"11px",color:"#003D06",position:"absolute",zIndex:"99998",visibility:"hidden",opacity:"0",filter:"alpha(opacity=0)",transition:"all 0.5s",MozTransition:"all 0.5s","-webkit-transition":"all 0.5s",OTransition:"all 0.5s","-ms-transition":"all 0.5s"}),"no"==s?(y(this.statusWidgetContainer,{position:"absolute"}),y(u,{borderRadius:"4px",float:"left"}),y(this.statusTextsContainer,{borderTopRightRadius:"4px",borderBottomRightRadius:"4px",left:"38px"})):(y(this.statusWidgetContainer,{position:"fixed",top:o,bottom:h}),s==f?(y(this.statusWidgetContainer,{left:"0px"}),y(u,{borderTopRightRadius:"4px",borderBottomRightRadius:"4px",float:"left"}),y(this.statusTextsContainer,{borderTopRightRadius:"4px",borderBottomRightRadius:"4px",left:"38px"})):(y(this.statusWidgetContainer,{right:"0px"}),y(u,{borderTopLeftRadius:"4px",borderBottomLeftRadius:"4px",float:"right"}),y(this.statusTextsContainer,{borderTopLeftRadius:"4px",borderBottomLeftRadius:"4px",right:"38px"}))),this.statusWidgetContainer.appendChild(u),this.statusWidgetContainer.appendChild(this.statusTextsContainer);var c=E("div");y(c,{position:"absolute",top:"4px",left:"7px",width:"28px",height:"28px"}),u.appendChild(c),this.initImages(c),this.transportLed=new k(u,1),this.streamingLed=new k(u,2),this.dataStreamingServer=E("div"),y(this.dataStreamingServer,{position:"absolute",top:"7px",left:"13px"}),this.statusTextsContainer.appendChild(this.dataStreamingServer),this.statusText=E("div"),y(this.statusText,{position:"absolute",top:"21px",left:"13px"}),this.statusTextsContainer.appendChild(this.statusText),this.updateWidget(O,O,O,"Ready",l,this.greyImg),this.updateWidgetS(this.greyImg),this.activate(),this.displayStatus=_,this.pinned=!1,a!=v&&(this.openDetails(!0),a==g?D.addTimedTask(this.getMouseoutHandler(),1e3):this.pinned=!0);var d=this.getTransitionendHandler();T.addEvent(this.statusTextsContainer,"transitionend",d),T.addEvent(this.statusTextsContainer,"webkitTransitionEnd",d),T.addEvent(this.statusTextsContainer,"MSTransitionEnd",d),T.addEvent(this.statusTextsContainer,"oTransitionEnd",d),T.addEvent(this.statusWidgetContainer,"click",this.getClickHandler()),T.addEvent(this.statusWidgetContainer,"mouseover",this.getMouseoverHandler()),T.addEvent(this.statusWidgetContainer,"mouseout",this.getMouseoutHandler())}};C.prototype={getDomNode:function(){return this.statusWidgetContainer},initImages:function(t){this.greyImg=a.cloneNode(!0),t.appendChild(this.greyImg),!h&&32!=this.greyImg.height&&L.isProbablyIE(7)&&(t.removeChild(this.greyImg),a=r=o=s(),h=!0,this.greyImg=a.cloneNode(!0),t.appendChild(this.greyImg)),this.greenImg=r.cloneNode(!0),t.appendChild(this.greenImg),this.lgreenImg=o.cloneNode(!0),t.appendChild(this.lgreenImg)},activate:function(){if(!this.ready){var t=document.getElementsByTagName("body");if(t&&0!=t.length)t[0].appendChild(this.statusWidgetContainer),this.ready=!0;else{var e=this;T.addEvent(document,"DOMContentLoaded",(function(){document.getElementsByTagName("body")[0].appendChild(e.statusWidgetContainer),e.ready=!0,e.cachedStatus&&e.onStatusChange(e.cachedStatus),e.displayStatus==c?e.openDetails():e.closeDetails()}))}}},onListenStart:function(t){i||(this.onStatusChange(t.getStatus()),this.lsClient=t)},onListenEnd:function(){i||(this.updateWidget(O,O,O,"Ready",l),this.lsClient=null)},updateWidget:function(t,e,i,s,n){this.transportLed.changeColor(t),this.streamingLed.changeColor(e),this.statusText.innerHTML=i,this.dataStreamingServer.innerHTML="<b>"+s+"</b>"},updateWidgetS:function(t,e){e&&this.stopBlinking(),this.widgetImageNode&&(this.widgetImageNode.style.display="none"),t.style.display="",this.widgetImageNode=t},stopBlinking:function(){this.blinkThread&&(this.blinkFlag=!1,D.stopRepetitiveTask(this.blinkThread),this.blinkThread=null)},startBlinking:function(){},doBlinking:function(){this.updateWidgetS(this.blinkFlag?this.greyImg:this.greenImg),this.blinkFlag=!this.blinkFlag},onStatusChange:function(t){if(this.ready&&!i){var e=l;if(t==P.DISCONNECTED)this.updateWidget(O,O,O,"Disconnected",l,this.greyImg);else if(t==P.CONNECTING)this.updateWidget(O,O,"Connecting...",e,this.greyImg),this.startBlinking();else if(0==t.indexOf(P.CONNECTED)){var s="Connected over ",n=this.lsClient&&0==this.lsClient.connectionDetails.getServerAddress().indexOf("https")?"S in ":" in ";t==P.CONNECTED+P.SENSE?(this.updateWidget(N,N,"Stream-sensing...",e,this.greyImg),this.startBlinking()):t==P.CONNECTED+P.WS_STREAMING?this.updateWidget(M,M,s+"WS"+n+"streaming mode",e,this.greenImg):t==P.CONNECTED+P.HTTP_STREAMING?this.updateWidget(N,M,s+"HTTP"+n+"streaming mode",e,this.greenImg):t==P.CONNECTED+P.WS_POLLING?this.updateWidget(M,N,s+"WS"+n+"polling mode",e,this.greenImg):t==P.CONNECTED+P.HTTP_POLLING&&this.updateWidget(N,N,s+"HTTP"+n+"polling mode",e,this.greenImg)}else t==P.STALLED?this.updateWidget(O,O,"Stalled",e,this.lgreenImg):t==P.TRYING_RECOVERY?(this.updateWidget(O,O,"Recovering...",e,this.lgreenImg),this.startBlinking()):this.updateWidget(O,O,"Disconnected (will retry)",e,this.greyImg)}else this.cachedStatus=t},openDetails:function(t){this.displayStatus!=c&&this.displayStatus!=d&&(this.displayStatus=d,y(this.statusTextsContainer,{visibility:"",opacity:"1",filter:"alpha(opacity=100)"}),I&&!t||this.transitionendHandler())},closeDetails:function(t){this.displayStatus!=_&&this.displayStatus!=p&&(this.displayStatus=p,y(this.statusTextsContainer,{visibility:"hidden",opacity:"0",filter:"alpha(opacity=0)"}),this.pinned=!1,I&&!t||this.transitionendHandler())},getMouseoverHandler:function(){var t=this;return function(){t.openDetails()}},getMouseoutHandler:function(){var t=this;return function(){t.pinned||t.closeDetails()}},getClickHandler:function(){var t=this;return function(){t.clickHandler()}},clickHandler:function(){this.pinned?this.closeDetails():(this.pinned=!0,this.openDetails())},getTransitionendHandler:function(){var t=this;return function(){t.transitionendHandler()}},transitionendHandler:function(){"hidden"==this.statusTextsContainer.style.visibility?this.toggleState=_:this.toggleState=c}};var M="#00C922",N="#F4DD80",O="#003D06";function k(t,e){this.led=E("div"),y(this.led,{position:"absolute",bottom:"3px",left:11+11*(e-1)+"px",width:"10px",height:"3px",borderRadius:"2px",backgroundColor:O}),t.appendChild(this.led)}return k.prototype.changeColor=function(t){y(this.led,{backgroundColor:t})},C.prototype.onStatusChange=C.prototype.onStatusChange,C.prototype.onListenStart=C.prototype.onListenStart,C.prototype.onListenEnd=C.prototype.onListenEnd,C.prototype.getDomNode=C.prototype.getDomNode,C}(),nt=function(){};nt.prototype={onNewLine:function(t,e,i,s){},onRemovedLine:function(t,e){},onXOverflow:function(t,e,i,s){},onYOverflow:function(t,e,i,s,n){}};var rt=function(){};rt.prototype={onCurrentPagesChanged:function(t){},onVisualUpdate:function(t,e,i){}};var at=function(){};at.prototype={onVisualUpdate:function(t,e,i){}};var ot=function(t){this.delegate=t};ot.prototype={setContentLength:function(t){this.delegate.setContentLength(t)},getContentLength:function(){return this.delegate.getContentLength()},setIdleTimeout:function(t){this.delegate.setIdleTimeout(t)},getIdleTimeout:function(){return this.delegate.getIdleTimeout()},setKeepaliveInterval:function(t){this.delegate.setKeepaliveInterval(t)},getKeepaliveInterval:function(){return this.delegate.getKeepaliveInterval()},setRequestedMaxBandwidth:function(t){this.delegate.setRequestedMaxBandwidth(t)},getRequestedMaxBandwidth:function(){return this.delegate.getRequestedMaxBandwidth()},getRealMaxBandwidth:function(){return this.delegate.getRealMaxBandwidth()},setPollingInterval:function(t){this.delegate.setPollingInterval(t)},getPollingInterval:function(){return this.delegate.getPollingInterval()},setReconnectTimeout:function(t){this.delegate.setReconnectTimeout(t)},getReconnectTimeout:function(){return this.delegate.getReconnectTimeout()},setStalledTimeout:function(t){this.delegate.setStalledTimeout(t)},getStalledTimeout:function(){return this.delegate.getStalledTimeout()},setRetryDelay:function(t){this.delegate.setRetryDelay(t)},getRetryDelay:function(){return this.delegate.getRetryDelay()},setFirstRetryMaxDelay:function(t){this.delegate.setFirstRetryMaxDelay(t)},getFirstRetryMaxDelay:function(){return this.delegate.getFirstRetryMaxDelay()},setSlowingEnabled:function(t){this.delegate.setSlowingEnabled(t)},isSlowingEnabled:function(){return this.delegate.isSlowingEnabled()},setForcedTransport:function(t){this.delegate.setForcedTransport(t)},getForcedTransport:function(){return this.delegate.getForcedTransport()},setServerInstanceAddressIgnored:function(t){this.delegate.setServerInstanceAddressIgnored(t)},isServerInstanceAddressIgnored:function(){return this.delegate.isServerInstanceAddressIgnored()},setCookieHandlingRequired:function(t){this.delegate.setCookieHandlingRequired(t)},isCookieHandlingRequired:function(){return this.delegate.isCookieHandlingRequired()},setReverseHeartbeatInterval:function(t){this.delegate.setReverseHeartbeatInterval(t)},getReverseHeartbeatInterval:function(){return this.delegate.getReverseHeartbeatInterval()},setHttpExtraHeaders:function(t){this.delegate.setHttpExtraHeaders(t)},getHttpExtraHeaders:function(){return this.delegate.getHttpExtraHeaders()},setHttpExtraHeadersOnSessionCreationOnly:function(t){this.delegate.setHttpExtraHeadersOnSessionCreationOnly(t)},isHttpExtraHeadersOnSessionCreationOnly:function(){return this.delegate.isHttpExtraHeadersOnSessionCreationOnly()},setSessionRecoveryTimeout:function(t){this.delegate.setSessionRecoveryTimeout(t)},getSessionRecoveryTimeout:function(){return this.delegate.getSessionRecoveryTimeout()}};var ht=function(t){this.delegate=t};ht.prototype={setServerAddress:function(t){this.delegate.setServerAddress(t)},getServerAddress:function(){return this.delegate.getServerAddress()},setAdapterSet:function(t){this.delegate.setAdapterSet(t)},getAdapterSet:function(){return this.delegate.getAdapterSet()},setUser:function(t){this.delegate.setUser(t)},getUser:function(){return this.delegate.getUser()},setPassword:function(t){this.delegate.setPassword(t)},getServerInstanceAddress:function(){return this.delegate.getServerInstanceAddress()},getServerSocketName:function(){return this.delegate.getServerSocketName()},getSessionId:function(){return this.delegate.getSessionId()},getClientIp:function(){return this.delegate.getClientIp()}};var lt=function(t,e){this.delegate=new d(t,e),this.connectionOptions=new ot(this.delegate.connectionOptions),this.connectionDetails=new ht(this.delegate.connectionDetails)};lt.setLoggerProvider=function(t){d.setLoggerProvider(t)},lt.LIB_NAME=d.LIB_NAME,lt.LIB_VERSION=d.LIB_VERSION,lt.prototype={connect:function(){this.delegate.connect()},disconnect:function(){this.delegate.disconnect()},getStatus:function(){return this.delegate.getStatus()},sendMessage:function(t,e,i,s,n){this.delegate.sendMessage(t,e,i,s,n)},getSubscriptions:function(){return this.delegate.getSubscriptionWrappers()},subscribe:function(t){this.delegate.subscribe(t.delegate)},unsubscribe:function(t){this.delegate.unsubscribe(t.delegate)},addListener:function(t){this.delegate.addListener(t)},removeListener:function(t){this.delegate.removeListener(t)},getListeners:function(){return this.delegate.getListeners()},registerForMpn:function(t){this.delegate.registerForMpn(t.delegate)},subscribeMpn:function(t,e){this.delegate.subscribeMpn(t.delegate,e)},unsubscribeMpn:function(t){this.delegate.unsubscribeMpn(t.delegate)},unsubscribeMpnSubscriptions:function(t){this.delegate.unsubscribeMpnSubscriptions(t)},getMpnSubscriptions:function(t){return this.delegate.getMpnSubscriptionWrappers(t)},findMpnSubscription:function(t){return this.delegate.findMpnSubscriptionWrapper(t)}};var ut=function(t,e,i){this.delegate=new _(t,e,i,this)};ut.prototype={isActive:function(){return this.delegate.isActive()},isSubscribed:function(){return this.delegate.isSubscribed()},setItems:function(t){this.delegate.setItems(t)},getItems:function(){return this.delegate.getItems()},setItemGroup:function(t){this.delegate.setItemGroup(t)},getItemGroup:function(){return this.delegate.getItemGroup()},setFields:function(t){this.delegate.setFields(t)},getFields:function(){return this.delegate.getFields()},setFieldSchema:function(t){this.delegate.setFieldSchema(t)},getFieldSchema:function(){return this.delegate.getFieldSchema()},getMode:function(){return this.delegate.getMode()},setDataAdapter:function(t){this.delegate.setDataAdapter(t)},getDataAdapter:function(){return this.delegate.getDataAdapter()},setSelector:function(t){this.delegate.setSelector(t)},getSelector:function(){return this.delegate.getSelector()},setRequestedMaxFrequency:function(t){this.delegate.setRequestedMaxFrequency(t)},getRequestedMaxFrequency:function(){return this.delegate.getRequestedMaxFrequency()},setRequestedBufferSize:function(t){this.delegate.setRequestedBufferSize(t)},getRequestedBufferSize:function(){return this.delegate.getRequestedBufferSize()},setRequestedSnapshot:function(t){this.delegate.setRequestedSnapshot(t)},getRequestedSnapshot:function(){return this.delegate.getRequestedSnapshot()},setCommandSecondLevelFields:function(t){this.delegate.setCommandSecondLevelFields(t)},getCommandSecondLevelFields:function(){return this.delegate.getCommandSecondLevelFields()},setCommandSecondLevelFieldSchema:function(t){this.delegate.setCommandSecondLevelFieldSchema(t)},getCommandSecondLevelFieldSchema:function(){return this.delegate.getCommandSecondLevelFieldSchema()},setCommandSecondLevelDataAdapter:function(t){this.delegate.setCommandSecondLevelDataAdapter(t)},getCommandSecondLevelDataAdapter:function(){return this.delegate.getCommandSecondLevelDataAdapter()},getValue:function(t,e){return this.delegate.getValue(t,e)},getCommandValue:function(t,e,i){return this.delegate.getCommandValue(t,e,i)},getKeyPosition:function(){return this.delegate.getKeyPosition()},getCommandPosition:function(){return this.delegate.getCommandPosition()},addListener:function(t){this.delegate.addListener(t)},removeListener:function(t){this.delegate.removeListener(t)},getListeners:function(){return this.delegate.getListeners()}};var ct=function(){};ct.TRACE=v.TRACE,ct.DEBUG=v.DEBUG,ct.INFO=v.INFO,ct.WARN=v.WARN,ct.ERROR=v.ERROR,ct.FATAL=v.FATAL;var dt=function(t){this.delegate=new S(t)};dt.prototype.getLogger=function(t){return this.delegate.getLogger(t)};var _t=function(t,e,i){this.delegate=new f(t,e,i)};_t.prototype={addListener:function(t){this.delegate.addListener(t)},removeListener:function(t){this.delegate.removeListener(t)},getListeners:function(){return this.delegate.getListeners()},getPlatform:function(){return this.delegate.getPlatform()},getApplicationId:function(){return this.delegate.getApplicationId()},getDeviceToken:function(){return this.delegate.getDeviceToken()},getPreviousDeviceToken:function(){return this.delegate.getPreviousDeviceToken()},isRegistered:function(){return this.delegate.isRegistered()},isSuspended:function(){return this.delegate.isSuspended()},getStatus:function(){return this.delegate.getStatus()},getStatusTimestamp:function(){return this.delegate.getStatusTimestamp()},getDeviceId:function(){return this.delegate.getDeviceId()}};var pt=function(){var t=arguments[0],e=arguments[1],i=arguments[2];this.delegate=new m(t,e,i,this)};pt.prototype={addListener:function(t){this.delegate.addListener(t)},removeListener:function(t){this.delegate.removeListener(t)},getListeners:function(){return this.delegate.getListeners()},getNotificationFormat:function(){return this.delegate.getNotificationFormat()},getActualNotificationFormat:function(){return this.delegate.getActualNotificationFormat()},setNotificationFormat:function(t){this.delegate.setNotificationFormat(t)},getTriggerExpression:function(){return this.delegate.getTriggerExpression()},getActualTriggerExpression:function(){return this.delegate.getActualTriggerExpression()},setTriggerExpression:function(t){this.delegate.setTriggerExpression(t)},isActive:function(){return this.delegate.isActive()},isSubscribed:function(){return this.delegate.isSubscribed()},isTriggered:function(){return this.delegate.isTriggered()},getStatus:function(){return this.delegate.getStatus()},getStatusTimestamp:function(){return this.delegate.getStatusTimestamp()},setItems:function(t){this.delegate.setItems(t)},getItems:function(){return this.delegate.getItems()},setItemGroup:function(t){this.delegate.setItemGroup(t)},getItemGroup:function(){return this.delegate.getItemGroup()},setFields:function(t){this.delegate.setFields(t)},getFields:function(){return this.delegate.getFields()},setFieldSchema:function(t){this.delegate.setFieldSchema(t)},getFieldSchema:function(){return this.delegate.getFieldSchema()},setDataAdapter:function(t){this.delegate.setDataAdapter(t)},getDataAdapter:function(){return this.delegate.getDataAdapter()},setRequestedBufferSize:function(t){this.delegate.setRequestedBufferSize(t)},getRequestedBufferSize:function(){return this.delegate.getRequestedBufferSize()},setRequestedMaxFrequency:function(t){this.delegate.setRequestedMaxFrequency(t)},getRequestedMaxFrequency:function(){return this.delegate.getRequestedMaxFrequency()},getMode:function(){return this.delegate.getMode()},getSubscriptionId:function(){return this.delegate.getSubscriptionId()}};var ft=function(t){this.delegate=new g(t)};ft.prototype={build:function(){return this.delegate.build()},getTitle:function(){return this.delegate.getTitle()},setTitle:function(t){return this.delegate.setTitle(t),this},getBody:function(){return this.delegate.getBody()},setBody:function(t){return this.delegate.setBody(t),this},getAction:function(){return this.delegate.getAction()},setAction:function(t){return this.delegate.setAction(t),this},getUrlArguments:function(){return this.delegate.getUrlArguments()},setUrlArguments:function(t){return this.delegate.setUrlArguments(t),this}};var mt=function(t){this.delegate=new p(t)};return mt.prototype={build:function(){return this.delegate.build()},getHeaders:function(){return this.delegate.getHeaders()},setHeaders:function(t){return this.delegate.setHeaders(t),this},getTitle:function(){return this.delegate.getTitle()},setTitle:function(t){return this.delegate.setTitle(t),this},getBody:function(){return this.delegate.getBody()},setBody:function(t){return this.delegate.setBody(t),this},getIcon:function(){return this.delegate.getIcon()},setIcon:function(t){return this.delegate.setIcon(t),this},getData:function(){return this.delegate.getData()},setData:function(t){return this.delegate.setData(t),this}},t.Chart=U,t.ChartListener=nt,t.ClientListener=r,t.ClientMessageListener=a,t.ConsoleLogLevel=ct,t.ConsoleLoggerProvider=dt,t.DynaGrid=J,t.DynaGridListener=rt,t.FirebaseMpnBuilder=mt,t.ItemUpdate=o,t.LightstreamerClient=lt,t.Logger=s,t.LoggerProvider=n,t.MpnDevice=_t,t.MpnDeviceListener=l,t.MpnSubscription=pt,t.MpnSubscriptionListener=u,t.SafariMpnBuilder=ft,t.SimpleChartListener=$,t.StaticGrid=it,t.StaticGridListener=at,t.StatusWidget=st,t.Subscription=ut,t.SubscriptionListener=h,Object.defineProperty(t,"__esModule",{value:!0}),t}({}),i);if("function"==typeof define&&define.amd)define("lightstreamer",["module"],(function(t){var e=t.config().ns?t.config().ns+"/":"";define(e+"LightstreamerClient",(function(){return s.LightstreamerClient})),define(e+"Subscription",(function(){return s.Subscription})),define(e+"ConsoleLogLevel",(function(){return s.ConsoleLogLevel})),define(e+"ConsoleLoggerProvider",(function(){return s.ConsoleLoggerProvider})),define(e+"MpnDevice",(function(){return s.MpnDevice})),define(e+"MpnSubscription",(function(){return s.MpnSubscription})),define(e+"SafariMpnBuilder",(function(){return s.SafariMpnBuilder})),define(e+"FirebaseMpnBuilder",(function(){return s.FirebaseMpnBuilder})),define(e+"Chart",(function(){return s.Chart})),define(e+"DynaGrid",(function(){return s.DynaGrid})),define(e+"SimpleChartListener",(function(){return s.SimpleChartListener})),define(e+"StaticGrid",(function(){return s.StaticGrid})),define(e+"StatusWidget",(function(){return s.StatusWidget})),define(e+"Logger",(function(){return s.Logger})),define(e+"LoggerProvider",(function(){return s.LoggerProvider})),define(e+"ClientListener",(function(){return s.ClientListener})),define(e+"ClientMessageListener",(function(){return s.ClientMessageListener})),define(e+"ItemUpdate",(function(){return s.ItemUpdate})),define(e+"SubscriptionListener",(function(){return s.SubscriptionListener})),define(e+"MpnDeviceListener",(function(){return s.MpnDeviceListener})),define(e+"MpnSubscriptionListener",(function(){return s.MpnSubscriptionListener})),define(e+"ChartListener",(function(){return s.ChartListener})),define(e+"DynaGridListener",(function(){return s.DynaGridListener})),define(e+"StaticGridListener",(function(){return s.StaticGridListener}))})),require(["lightstreamer"]);else{var n=function(t,e){if(!t)return e;for(var i=t.split("."),s=e||window,n=0;n<i.length;n++){var r=i[n],a=s[r];a&&"object"==typeof a||(a=s[r]={}),s=a}return s}(function(){if("undefined"==typeof window||void 0===window.document)return null;for(var t=window.document.getElementsByTagName("script"),e=0,i=t.length;e<i;e++)if("data-lightstreamer-ns"in t[e].attributes)return t[e].attributes["data-lightstreamer-ns"].value;return null}(),t);n.LightstreamerClient=s.LightstreamerClient,n.Subscription=s.Subscription,n.ConsoleLogLevel=s.ConsoleLogLevel,n.ConsoleLoggerProvider=s.ConsoleLoggerProvider,n.MpnDevice=s.MpnDevice,n.MpnSubscription=s.MpnSubscription,n.SafariMpnBuilder=s.SafariMpnBuilder,n.FirebaseMpnBuilder=s.FirebaseMpnBuilder,n.Chart=s.Chart,n.DynaGrid=s.DynaGrid,n.SimpleChartListener=s.SimpleChartListener,n.StaticGrid=s.StaticGrid,n.StatusWidget=s.StatusWidget,n.Logger=s.Logger,n.LoggerProvider=s.LoggerProvider,n.ClientListener=s.ClientListener,n.ClientMessageListener=s.ClientMessageListener,n.ItemUpdate=s.ItemUpdate,n.SubscriptionListener=s.SubscriptionListener,n.MpnDeviceListener=s.MpnDeviceListener,n.MpnSubscriptionListener=s.MpnSubscriptionListener,n.ChartListener=s.ChartListener,n.DynaGridListener=s.DynaGridListener,n.StaticGridListener=s.StaticGridListener}}("undefined"!=typeof self?self:this);
//# sourceMappingURL=lightstreamer.min.js.map
